var Bs=Object.defineProperty;var Ls=(e,t,n)=>t in e?Bs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Oe=(e,t,n)=>(Ls(e,typeof t!="symbol"?t+"":t,n),n);import{r as a,R as vt}from"./index-BMVQvedj.js";import{_ as Sl}from"./iframe-0-Di66Z3.js";import{h as Ps,d as Ml,j as Ws,v as $s,_ as Os,g as Ns,c as sn,r as io,t as Xs}from"./throttle-7EuXLZa7.js";import{u as Ys,f as qi}from"./flatten-qRvRBp6y.js";import{s as tn,b as Gs}from"./marked.esm-dbrxtycE.js";function Rl(e="This should not happen"){throw new Error(e)}function Qt(e,t="Assertion failed"){if(!e)return Rl(t)}function or(e,t){return Rl(t??"Hell froze over")}function Ks(e,t){try{return e()}catch{return t}}const ji=Object.prototype.hasOwnProperty;function Ho(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Ho(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(ji.call(e,n)&&++o&&!ji.call(t,n)||!(n in t)||!Ho(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Br=null,xi=void 0;var j;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(j||(j={}));var Zi;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(Zi||(Zi={}));var Lr;(function(e){e.Triangle="triangle",e.Dots="dots"})(Lr||(Lr={}));function Dr(e){return"width"in e&&typeof e.width=="number"}async function Ji(e){return typeof e=="object"?e:await e()}function Io(e){return!(e.kind===j.Loading||e.kind===j.Bubble||e.kind===j.RowID||e.kind===j.Protected||e.kind===j.Drilldown)}function ku(e){return!(e.kind===j.Loading||e.kind===j.Bubble||e.kind===j.RowID||e.kind===j.Protected||e.kind===j.Drilldown||e.kind===j.Boolean||e.kind===j.Image||e.kind===j.Custom)}function Do(e){return e.kind===cn.Marker||e.kind===cn.NewRow}function Qo(e){if(!Io(e)||e.kind===j.Image)return!1;if(e.kind===j.Text||e.kind===j.Number||e.kind===j.Markdown||e.kind===j.Uri||e.kind===j.Custom||e.kind===j.Boolean)return e.readonly!==!0;or(e,"A cell was passed with an invalid kind")}function Us(e){return Ps(e,"editor")}function wi(e){return!(e.readonly??!1)}var cn;(function(e){e.NewRow="new-row",e.Marker="marker"})(cn||(cn={}));function Vs(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let Qi;const Hn=class Hn{constructor(t){Oe(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Hn(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Vs([...this.items,n]);return new Hn(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,l]of n.entries()){const[s,c]=l;if(s<=r&&o<=c){const u=[];s<o&&u.push([s,o]),r<c&&u.push([r,c]),n.splice(i,1,...u)}}return new Hn(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Oe(Hn,"empty",()=>Qi??(Qi=new Hn([]))),Oe(Hn,"fromSingleSelection",t=>Hn.empty().add(t));let st=Hn;const _s=tn("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Lt(e,t,n,o,r=!1){const i=a.useRef();i.current=t,a.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=c=>{var u;(u=i.current)==null||u.call(l,c)};return l.addEventListener(e,s,{passive:o,capture:r}),()=>{l.removeEventListener(e,s,{capture:r})}},[e,n,o,r])}function ro(e,t){return e===void 0?void 0:t}const qs=Math.PI;function el(e){return e*qs/180}const El=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Il=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Dl=(e,t,n)=>Math.min(e,t-n*2),Fl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,ki=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),a.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},js=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function Zs(e,t,n){const[o,r]=a.useState(e),i=a.useRef(!0);a.useEffect(()=>()=>{i.current=!1},[]);const l=a.useRef(Ml(s=>{i.current&&r(s)},n));return a.useLayoutEffect(()=>{i.current&&l.current(()=>e())},t),o}const Js="֑-߿יִ-﷽ﹰ-ﻼ",Qs="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",ea=new RegExp("^[^"+Qs+"]*["+Js+"]");function Si(e){return ea.test(e)?"rtl":"not-rtl"}let Fr;function yi(){if(typeof document>"u")return 0;if(Fr!==void 0)return Fr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Fr=n-o,Fr}const oo=Symbol();function ta(e){const t=a.useRef([oo,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=a.useState(e),[,r]=a.useState(),i=a.useCallback(s=>{const c=t.current[0];c!==oo&&(s=typeof s=="function"?s(c):s,s===c)||(c!==oo&&r({}),o(u=>typeof s=="function"?s(c===oo?u:c):s),t.current[0]=oo)},[]),l=a.useCallback(()=>{t.current[0]=oo,r({})},[]);return[t.current[0]===oo?n:t.current[0],i,l]}function Hl(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function na(e){const t=a.useRef(e);return Ho(e,t.current)||(t.current=e),t.current}const oa=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(s=>s!=="");if(i.length===0)return null;const l=i.length>1;return a.createElement(_s,{"data-testid":"GDG-default-image-overlay-editor"},a.createElement(Ws.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},i.map(s=>{const c=(r==null?void 0:r(s))??a.createElement("img",{draggable:!1,src:s});return a.createElement("div",{className:"gdg-centering-container",key:s},c)})),n&&o&&a.createElement("button",{className:"gdg-edit-icon",onClick:o},a.createElement(ki,null)))},ra=tn("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class ia extends vt.PureComponent{constructor(){super(...arguments);Oe(this,"targetElement",null);Oe(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,l=Gs(r),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let c=i==null?void 0:i(l);if(c===void 0){const f=document.createElement("template");f.innerHTML=l,c=f.content}n.append(c);const u=n.getElementsByTagName("a");for(const f of u)f.target="_blank",f.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),vt.createElement(ra,{ref:this.containerRefHook})}}const la=tn("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),sa=tn("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),aa=tn("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let tl=0;const Nr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:l,...s}=e,{onChange:c,className:u}=s,f=a.useRef(null),m=n??"";Qt(c!==void 0,"GrowingEntry must be a controlled input area");const[g]=a.useState(()=>"input-box-"+(tl=(tl+1)%1e7));a.useEffect(()=>{const h=f.current;if(h===null||h.disabled)return;const y=m.toString().length;h.focus(),h.setSelectionRange(r?0:y,y)},[]),a.useLayoutEffect(()=>{var h;if(l!==void 0){const y=typeof l=="number"?[l,null]:l;(h=f.current)==null||h.setSelectionRange(y[0],y[1])}},[l]);const w=a.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return a.createElement(aa,{className:"gdg-growing-entry"},a.createElement(sa,{className:u},m+`
`),a.createElement(la,{...s,className:(u??"")+" gdg-input",id:g,ref:f,onKeyDown:w,value:m,placeholder:t,dir:"auto"}))},ci={};let Yn=null;function ca(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function To(e){const t=e.toLowerCase().trim();if(ci[t]!==void 0)return ci[t];Yn=Yn||ca(),Yn.style.color="#000",Yn.style.color=t;const n=getComputedStyle(Yn).color;Yn.style.color="#fff",Yn.style.color=t;const o=getComputedStyle(Yn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),ci[t]=r,r}function so(e,t){const[n,o,r]=To(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const nl=new Map;function ol(e,t){const n=`${e}-${t}`,o=nl.get(n);if(o!==void 0)return o;const r=en(e,t);return nl.set(n,r),r}function en(e,t){if(t===void 0)return e;const[n,o,r,i]=To(e);if(i===1)return e;const[l,s,c,u]=To(t),f=i+u*(1-i),m=(i*n+u*l*(1-i))/f,g=(i*o+u*s*(1-i))/f,w=(i*r+u*c*(1-i))/f;return`rgba(${m}, ${g}, ${w}, ${f})`}function Su(e,t,n){if(n<=0)return e;if(n>=1)return t;const o=[...To(e)];o[0]=o[0]*o[3],o[1]=o[1]*o[3],o[2]=o[2]*o[3];const r=[...To(t)];r[0]=r[0]*r[3],r[1]=r[1]*r[3],r[2]=r[2]*r[3];const i=n,l=1-n,s=o[3]*l+r[3]*i,c=Math.floor((o[0]*l+r[0]*i)/s),u=Math.floor((o[1]*l+r[1]*i)/s),f=Math.floor((o[2]*l+r[2]*i)/s);return`rgba(${c}, ${u}, ${f}, ${s})`}function Mu(e){if(e==="transparent")return 0;function t(i){const l=i/255;return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}const[n,o,r]=To(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function da(e,t){return vt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible})),[e,t])}function ua(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(er(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function rr(e,t){return(e??"")===(t??"")}function fa(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function Tl(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function er(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Al(e){return[e.x+e.width-1,e.y+e.height-1]}function rl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,l=n.y+n.height-1,[s,c]=e;if(c<i||c>l)return!1;if(t.span===void 0)return s>=o&&s<=r;const[u,f]=t.span;return u>=o&&u<=r||f>=o&&u<=r||u<o&&f>r}function ha(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&rl(e,t,i)&&r++;for(const l of n.current.rangeStack)rl(e,t,l)&&r++;return r}function zl(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,l)=>({...i,sticky:e[l].sticky})),n=o}return n}function Ao(e,t){let n=0;const o=zl(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function ao(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function bi(e,t,n,o,r){const i=zl(e,o),l=[];for(const u of i)if(u.sticky)l.push(u);else break;if(l.length>0)for(const u of l)n-=u.width;let s=t,c=r??0;for(;c<=n&&s<i.length;)c+=i[s].width,s++;for(let u=t;u<s;u++){const f=i[u];f.sticky||l.push(f)}return l}function ga(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function ma(e,t,n,o,r,i,l,s,c,u){const f=o+r;if(n&&e<=r)return-2;if(e<=f)return-1;let m=t;for(let h=0;h<u;h++){const y=i-1-h,C=typeof l=="number"?l:l(y);if(m-=C,e>=m)return y}const g=i-u,w=e-(c??0);if(typeof l=="number"){const h=Math.floor((w-f)/l)+s;return h>=g?void 0:h}else{let h=f;for(let y=s;y<g;y++){const C=l(y);if(w<=h+C)return y;h+=C}return}}let zr=0,tr={};const wa=typeof window>"u";async function ya(){var e;wa||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,zr=0,tr={},$s())}ya();function Bl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function zo(e,t,n,o="middle"){const r=Bl(e,t,o,n);let i=tr[r];return i===void 0&&(i=t.measureText(e),tr[r]=i,zr++),zr>1e4&&(tr={},zr=0),i}function Ll(e,t){const n=Bl(e,void 0,"middle",t);return tr[n]}function Un(e,t){return typeof t!="string"&&(t=t.baseFontFull),ba(e,t)}function il(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const ll=[];function ba(e,t){for(const i of ll)if(i.key===t)return i.val;const n=il(e,"alphabetic"),r=-(il(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return ll.push({key:t,val:r}),r}function pa(e,t,n,o,r,i){const{ctx:l,rect:s,theme:c}=e;let u=Number.MAX_SAFE_INTEGER;const f=500;if(t!==void 0&&(u=n-t,u<f)){const m=1-u/f;l.globalAlpha=m,l.fillStyle=c.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(r?2:1),s.height-(i?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return u<f}function lr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},l=n??r.textDark;return l!==i.fillStyle&&(o.fillStyle=l,i.fillStyle=l),i}function Ru(e,t,n){const{rect:o,ctx:r,theme:i}=e;r.fillStyle=i.textDark,Sn({ctx:r,rect:o,theme:i},t,n)}function Pl(e,t,n,o,r,i,l,s,c){c==="right"?e.fillText(t,n+r-(s.cellHorizontalPadding+.5),o+i/2+l):c==="center"?e.fillText(t,n+r/2,o+i/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+i/2+l)}function Wl(e,t){const n=zo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function va(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Ca(e,t,n,o,r,i,l,s,c,u){const f=s.baseFontFull,m=Os(e,t,f,r-s.cellHorizontalPadding*2,u??!1),g=Wl(e,f),w=s.lineHeight*g,h=g+w*(m.length-1),y=h+s.cellVerticalPadding>i;y&&(e.save(),e.rect(n,o,r,i),e.clip());const C=o+i/2-h/2;let x=Math.max(o+s.cellVerticalPadding,C);for(const v of m)if(Pl(e,v,n,x,r,g,l,s,c),x+=w,x>o+i)break;y&&e.restore()}function Sn(e,t,n,o,r){const{ctx:i,rect:l,theme:s}=e,{x:c,y:u,width:f,height:m}=l;o=o??!1,o||(t=va(t,f));const g=Un(i,s),w=Si(t)==="rtl";if(n===void 0&&w&&(n="right"),w&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Ca(i,t,c,u,f,m,g,s,n,r):Pl(i,t,c,u,f,m,g,s,n),h&&(i.textAlign="start"),w&&(i.direction="inherit")}}function Mn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function xa(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function ka(e,t,n){const o=function(s,c){const u=c.x-s.x,f=c.y-s.y,m=Math.sqrt(u*u+f*f),g=u/m,w=f/m;return{x:u,y:c.y-s.y,len:m,nx:g,ny:w,ang:Math.atan2(w,g)}};let r;const i=t.length;let l=t[i-1];for(let s=0;s<i;s++){let c=t[s%i];const u=t[(s+1)%i],f=o(c,l),m=o(c,u),g=f.nx*m.ny-f.ny*m.nx,w=f.nx*m.nx-f.ny*-m.ny;let h=Math.asin(g<-1?-1:g>1?1:g),y=1,C=!1;w<0?h<0?h=Math.PI+h:(h=Math.PI-h,y=-1,C=!0):h>0&&(y=-1,C=!0),r=c.radius!==void 0?c.radius:n;const x=h/2;let v=Math.abs(Math.cos(x)*r/Math.sin(x)),I;v>Math.min(f.len/2,m.len/2)?(v=Math.min(f.len/2,m.len/2),I=Math.abs(v*Math.sin(x)/Math.cos(x))):I=r;let X=c.x+m.nx*v,N=c.y+m.ny*v;X+=-m.ny*I*y,N+=m.nx*I*y,e.arc(X,N,I,f.ang+Math.PI/2*y,m.ang-Math.PI/2*y,C),l=c,c=u}e.closePath()}function pi(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h){const y={x:0,y:i+u,width:0,height:0};if(e>=w.length||t>=f||t<-2||e<0)return y;const C=i-r;if(e>=m){const x=l>e?-1:1,v=Ao(w);y.x+=v+c;for(let I=l;I!==e;I+=x)y.x+=w[x===1?I:I-1].width*x}else for(let x=0;x<e;x++)y.x+=w[x].width;if(y.width=w[e].width+1,t===-1)y.y=r,y.height=C;else if(t===-2){y.y=0,y.height=r;let x=e;const v=w[e].group,I=w[e].sticky;for(;x>0&&rr(w[x-1].group,v)&&w[x-1].sticky===I;){const N=w[x-1];y.x-=N.width,y.width+=N.width,x--}let X=e;for(;X+1<w.length&&rr(w[X+1].group,v)&&w[X+1].sticky===I;){const N=w[X+1];y.width+=N.width,X++}if(!I){const N=Ao(w),A=y.x-N;A<0&&(y.x-=A,y.width+=A),y.x+y.width>n&&(y.width=n-y.x)}}else if(t>=f-g){let x=f-t;for(y.y=o;x>0;){const v=t+x-1;y.height=typeof h=="number"?h:h(v),y.y-=y.height,x--}y.height+=1}else{const x=s>t?-1:1;if(typeof h=="number"){const v=t-s;y.y+=v*h}else for(let v=s;v!==t;v+=x)y.y+=h(v)*x;y.height=(typeof h=="number"?h:h(t))+1}return y}const Mi=1<<21;function bn(e,t){return(t+2)*Mi+e}function $l(e){return e%Mi}function Ri(e){return Math.floor(e/Mi)-2}function Ei(e){const t=$l(e),n=Ri(e);return[t,n]}class Ol{constructor(){Oe(this,"visibleWindow",{x:0,y:0,width:0,height:0});Oe(this,"freezeCols",0);Oe(this,"freezeRows",[]);Oe(this,"isInWindow",t=>{const n=$l(t),o=Ri(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,l=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Ho(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Sa extends Ol{constructor(){super(...arguments);Oe(this,"cache",new Map);Oe(this,"setValue",(n,o)=>{this.cache.set(bn(n[0],n[1]),o)});Oe(this,"getValue",n=>this.cache.get(bn(n[0],n[1])));Oe(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class nr{constructor(t=[]){Oe(this,"cells");this.cells=new Set(t.map(n=>bn(n[0],n[1])))}add(t){this.cells.add(bn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(bn(t[0],t[1]))}remove(t){this.cells.delete(bn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Ri(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(bn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Ei(t)}}function Ma(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const Nl={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4};function Xl(){return Nl}const Yl=vt.createContext(Nl);function Eu(){return vt.useContext(Yl)}function Tn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=en(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const vi=150;function Ra(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??vi}function Gl(e,t,n,o,r,i,l,s,c){let u=0;const f=r===void 0?[]:r.map(g=>{const w=Ra(e,g[o],t,c);return u=Math.max(u,w),w});if(f.length>5&&s){u=0;let g=0;for(const h of f)g+=h;const w=g/f.length;for(let h=0;h<f.length;h++)f[h]>=w*2?f[h]=0:u=Math.max(u,f[h])}u=Math.max(u,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28));const m=Math.max(Math.ceil(i),Math.min(Math.floor(l),Math.ceil(u)));return{...n,width:m}}function Ea(e,t,n,o,r,i,l,s,c){const u=a.useRef(t),f=a.useRef(n),m=a.useRef(l);u.current=t,f.current=n,m.current=l;const[g,w]=a.useMemo(()=>{if(typeof window>"u")return[null,null];const v=document.createElement("canvas");return v.style.display="none",v.style.opacity="0",v.style.position="fixed",[v,v.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>(g&&document.documentElement.append(g),()=>{g==null||g.remove()}),[g]);const h=a.useRef({}),y=a.useRef(),[C,x]=a.useState();return a.useLayoutEffect(()=>{const v=f.current;if(v===void 0||e.every(Dr))return;let I=Math.max(1,10-Math.floor(e.length/1e4)),X=0;I<u.current&&I>1&&(I--,X=1);const N={x:0,y:0,width:e.length,height:Math.min(u.current,I)},A={x:0,y:u.current-1,width:e.length,height:1};(async()=>{const K=v(N,c.signal),S=X>0?v(A,c.signal):void 0;let $;typeof K=="object"?$=K:$=await Ji(K),S!==void 0&&(typeof S=="object"?$=[...$,...S]:$=[...$,...await Ji(S)]),y.current=e,x($)})()},[c.signal,e]),a.useMemo(()=>{let I=e.every(Dr)?e:w===null?e.map(z=>Dr(z)?z:{...z,width:vi}):(w.font=m.current.baseFontFull,e.map((z,K)=>{if(Dr(z))return z;if(h.current[z.id]!==void 0)return{...z,width:h.current[z.id]};if(C===void 0||y.current!==e||z.id===void 0)return{...z,width:vi};const S=Gl(w,l,z,K,C,r,i,!0,s);return h.current[z.id]=S.width,S})),X=0,N=0;const A=[];for(const[z,K]of I.entries())X+=K.width,K.grow!==void 0&&K.grow>0&&(N+=K.grow,A.push(z));if(X<o&&A.length>0){const z=[...I],K=o-X;let S=K;for(let $=0;$<A.length;$++){const W=A[$],D=(I[W].grow??0)/N,R=$===A.length-1?S:Math.min(S,Math.floor(K*D));z[W]={...I[W],growOffset:R,width:I[W].width+R},S-=R}I=z}return{sizedColumns:I,nonGrowWidth:X}},[o,e,w,C,l,r,i,s])}const dt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Ia=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Da=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Fa=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Ha=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ta=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Kl=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Aa=e=>{const t=e.bgColor;return`${dt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},za=Kl,Ba=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},La=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Pa=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},Wa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},$a=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Oa=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Na=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},Ya=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},Ga=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},Ka=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},Ua=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},Va=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},_a=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${dt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`${dt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},ec=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},tc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},nc={headerRowID:Ia,headerNumber:Fa,headerCode:Da,headerString:Ha,headerBoolean:Ta,headerAudioUri:za,headerVideoUri:Ba,headerEmoji:La,headerImage:Pa,headerUri:Kl,headerPhone:Wa,headerMarkdown:$a,headerDate:Oa,headerTime:Na,headerEmail:Xa,headerReference:Ya,headerIfThenElse:Ga,headerSingleValue:Ka,headerLookup:Ua,headerTextTemplate:Va,headerMath:_a,headerRollup:qa,headerJoinStrings:ja,headerSplitString:Za,headerGeoDistance:Ja,headerArray:Qa,rowOwnerOverlay:ec,protectedColumnOverlay:tc,renameIcon:Aa};function oc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class rc{constructor(t,n){Oe(this,"onSettled");Oe(this,"spriteMap",new Map);Oe(this,"headerIcons");Oe(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,l,s,c=1){const[u,f]=oc(n,s),m=l*Math.ceil(window.devicePixelRatio),g=`${u}_${f}_${m}_${t}`;let w=this.spriteMap.get(g);if(w===void 0){const h=this.headerIcons[t];if(h===void 0)return;w=document.createElement("canvas");const y=w.getContext("2d");if(y===null)return;const C=new Image;C.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:f,bgColor:u}))}`,this.spriteMap.set(g,w);const x=C.decode();if(x===void 0)return;this.inFlight++,x.then(()=>{y.drawImage(C,0,0,m,m)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(w,0,0,m,m,r,i,l,l),c<1&&(o.globalAlpha=1)}}function Ul(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y)}function Xr(e,t,n,o,r,i,l,s,c){s=s??t;let u=t,f=e;const m=o-i;let g=!1;for(;u<n&&f<m;){const w=r(f);if(u+w>s&&c(u,f,w,!1,l&&f===o-1)===!0){g=!0;break}u+=w,f++}if(!g){u=n;for(let w=0;w<i;w++){f=o-1-w;const h=r(f);u-=h,c(u,f,h,!0,l&&f===o-1)}}}function Vn(e,t,n,o,r,i){let l=0,s=0;const c=r+o;for(const u of e){const f=u.sticky?s:l+n;if(i(u,f,c,u.sticky?0:s,t)===!0)break;l+=u.width,s+=u.sticky?u.width:0}}function Vl(e,t,n,o,r){let i=0,l=0;for(let s=0;s<e.length;s++){const c=e[s];let u=s+1,f=c.width;for(c.sticky&&(l+=f);u<e.length&&rr(e[u].group,c.group)&&e[u].sticky===e[s].sticky;){const y=e[u];f+=y.width,u++,s++,y.sticky&&(l+=y.width)}const m=c.sticky?0:n,g=i+m,w=c.sticky?0:Math.max(0,l-g),h=Math.min(f-w,t-(g+w));r([c.sourceIndex,e[u-1].sourceIndex],c.group??"",g+w,0,h,o),i+=f}}function _l(e,t,n,o,r,i,l){var g;const[s,c]=e;let u,f;const m=((g=l.find(w=>!w.sticky))==null?void 0:g.sourceIndex)??0;if(c>m){const w=Math.max(s,m);let h=t,y=o;for(let C=i.sourceIndex-1;C>=w;C--)h-=l[C].width,y+=l[C].width;for(let C=i.sourceIndex+1;C<=c;C++)y+=l[C].width;f={x:h,y:n,width:y,height:r}}if(m>s){const w=Math.min(c,m-1);let h=t,y=o;for(let C=i.sourceIndex-1;C>=s;C--)h-=l[C].width,y+=l[C].width;for(let C=i.sourceIndex+1;C<=w;C++)y+=l[C].width;u={x:h,y:n,width:y,height:r}}return[u,f]}function ic(e,t,n,o){if(o==="any")return ql(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),Tl([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return c===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===l?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function ir(e,t,n,o,r,i,l,s){return e<=r+l&&r<=e+n&&t<=i+s&&i<=t+o}function lo(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function ql(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function lc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function sc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,l=t+4,s=n+4,c=r-e.x,u=e.x+e.width-l,f=i-e.y,m=e.y+e.height-s,g=c>0?e.x+Math.floor(c/o)*o:e.x,w=u>0?e.x+e.width-Math.floor(u/o)*o:e.x+e.width,h=f>0?e.y+Math.floor(f/o)*o:e.y,y=m>0?e.y+e.height-Math.floor(m/o)*o:e.y+e.height;return{x:g,y:h,width:w-g,height:y-h}}function ac(e,t,n,o,r){const[i,l,s,c]=t,[u,f,m,g]=r,{x:w,y:h,width:y,height:C}=e,x=[];if(y<=0||C<=0)return x;const v=w+y,I=h+C,X=w<i,N=h<l,A=w+y>s,z=h+C>c,K=w>=i&&w<s||v>i&&v<=s||w<i&&v>s,S=h>=l&&h<c||I>l&&I<=c||h<l&&I>c;if(K&&S){const W=Math.max(w,i),D=Math.max(h,l),R=Math.min(v,s),M=Math.min(I,c);x.push({rect:{x:W,y:D,width:R-W,height:M-D},clip:{x:u,y:f,width:m-u+1,height:g-f+1}})}if(X&&N){const W=w,D=h,R=Math.min(v,i),M=Math.min(I,l);x.push({rect:{x:W,y:D,width:R-W,height:M-D},clip:{x:0,y:0,width:u+1,height:f+1}})}if(N&&K){const W=Math.max(w,i),D=h,R=Math.min(v,s),M=Math.min(I,l);x.push({rect:{x:W,y:D,width:R-W,height:M-D},clip:{x:u,y:0,width:m-u+1,height:f+1}})}if(N&&A){const W=Math.max(w,s),D=h,R=v,M=Math.min(I,l);x.push({rect:{x:W,y:D,width:R-W,height:M-D},clip:{x:m,y:0,width:n-m+1,height:f+1}})}if(X&&S){const W=w,D=Math.max(h,l),R=Math.min(v,i),M=Math.min(I,c);x.push({rect:{x:W,y:D,width:R-W,height:M-D},clip:{x:0,y:f,width:u+1,height:g-f+1}})}if(A&&S){const W=Math.max(w,s),D=Math.max(h,l),R=v,M=Math.min(I,c);x.push({rect:{x:W,y:D,width:R-W,height:M-D},clip:{x:m,y:f,width:n-m+1,height:g-f+1}})}if(X&&z){const W=w,D=Math.max(h,c),R=Math.min(v,i),M=I;x.push({rect:{x:W,y:D,width:R-W,height:M-D},clip:{x:0,y:g,width:u+1,height:o-g+1}})}if(z&&K){const W=Math.max(w,i),D=Math.max(h,c),R=Math.min(v,s),M=I;x.push({rect:{x:W,y:D,width:R-W,height:M-D},clip:{x:u,y:g,width:m-u+1,height:o-g+1}})}if(A&&z){const W=Math.max(w,s),D=Math.max(h,c),R=v,M=I;x.push({rect:{x:W,y:D,width:R-W,height:M-D},clip:{x:m,y:g,width:n-m+1,height:o-g+1}})}return x}const cc={kind:j.Loading,allowOverlay:!1};function sl(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h,y,C,x,v,I,X,N,A,z,K,S,$,W,D,R,M,re,te,ce,Ce){let Fe=(I==null?void 0:I.size)??Number.MAX_SAFE_INTEGER;const _=performance.now();let V=R.baseFontFull;e.font=V;const xe={ctx:e},ne=[0,0],be=C>0?ao(c,C,u):0;let pe,U;const ke=Ul(v);return Vn(t,s,i,l,r,(ve,je,nt,mt,et)=>{const Ae=Math.max(0,mt-je),Ve=je+Ae,Re=r+1,ut=ve.width-Ae,rt=o-r-1;if(v.length>0){let Ne=!1;for(let Te=0;Te<v.length;Te++){const _e=v[Te];if(ir(Ve,Re,ut,rt,_e.x,_e.y,_e.width,_e.height)){Ne=!0;break}}if(!Ne)return}const it=()=>{e.save(),e.beginPath(),e.rect(Ve,Re,ut,rt),e.clip()},ie=X.columns.hasIndex(ve.sourceIndex),We=m(ve.group??"").overrideTheme,De=ve.themeOverride===void 0&&We===void 0?R:Tn(R,We,ve.themeOverride),Ie=De.baseFontFull;Ie!==V&&(V=Ie,e.font=Ie),it();let fe;return Xr(et,nt,o,c,u,C,x,ke,(Ne,Te,_e,oe,He)=>{var En,nn,Bt;if(Te<0||(ne[0]=ve.sourceIndex,ne[1]=Te,I!==void 0&&!I.has(ne)))return;if(v.length>0){let Ue=!1;for(let Mt=0;Mt<v.length;Mt++){const at=v[Mt];if(ir(je,Ne,ve.width,_e,at.x,at.y,at.width,at.height)){Ue=!0;break}}if(!Ue)return}const tt=X.rows.hasIndex(Te),$e=w.hasIndex(Te),Ke=Te<c?f(ne):cc;let ft=je,Xe=ve.width,ze=!1,Ct=!1;if(Ke.span!==void 0){const[Ue,Mt]=Ke.span,at=`${Te},${Ue},${Mt},${ve.sticky}`;if(U===void 0&&(U=new Set),U.has(at)){Fe--;return}else{const Pt=_l(Ke.span,je,Ne,ve.width,_e,ve,n),Tt=ve.sticky?Pt[0]:Pt[1];if(!ve.sticky&&Pt[0]!==void 0&&(Ct=!0),Tt!==void 0){ft=Tt.x,Xe=Tt.width,U.add(at),e.restore(),fe=void 0,e.save(),e.beginPath();const jt=Math.max(0,mt-Tt.x);e.rect(Tt.x+jt,Ne,Tt.width-jt,_e),pe===void 0&&(pe=[]),pe.push({x:Tt.x+jt,y:Ne,width:Tt.width-jt,height:_e}),e.clip(),ze=!0}}}const xt=g==null?void 0:g(Te),Xt=He&&((En=ve.trailingRowOptions)==null?void 0:En.themeOverride)!==void 0?(nn=ve.trailingRowOptions)==null?void 0:nn.themeOverride:void 0,wt=Ke.themeOverride===void 0&&xt===void 0&&Xt===void 0?De:Tn(De,xt,Xt,Ke.themeOverride);e.beginPath();const It=fa(ne,Ke,X);let Dt=ha(ne,Ke,X,y);const An=Ke.span!==void 0&&X.columns.some(Ue=>Ke.span!==void 0&&Ue>=Ke.span[0]&&Ue<=Ke.span[1]);It&&!h&&y?Dt=0:It&&y&&(Dt=Math.max(Dt,1)),An&&Dt++,It||(tt&&Dt++,ie&&!He&&Dt++);const zn=Ke.kind===j.Protected?wt.bgCellMedium:wt.bgCell;let ct;if((oe||zn!==R.bgCell)&&(ct=en(zn,ct)),Dt>0||$e){$e&&(ct=en(wt.bgHeader,ct));for(let Ue=0;Ue<Dt;Ue++)ct=en(wt.accentLight,ct)}else if(N!==void 0){for(const Ue of N)if(Ue[0]===ve.sourceIndex&&Ue[1]===Te){ct=en(wt.bgSearchResult,ct);break}}if(A!==void 0)for(let Ue=0;Ue<A.length;Ue++){const Mt=A[Ue],at=Mt.range;Mt.style!=="solid-outline"&&at.x<=ve.sourceIndex&&ve.sourceIndex<at.x+at.width&&at.y<=Te&&Te<at.y+at.height&&(ct=en(Mt.color,ct))}let Rn=!1;if(I!==void 0){const Ue=Ne+1,at=(oe?Ue+_e-1:Math.min(Ue+_e-1,o-be))-Ue;(at!==_e-1||ft+1<=mt)&&(Rn=!0,e.save(),e.beginPath(),e.rect(ft+1,Ue,Xe-1,at),e.clip()),ct=ct===void 0?wt.bgCell:en(ct,wt.bgCell)}const Pe=ve.sourceIndex===n.length-1,Ze=Te===c-1;ct!==void 0&&(e.fillStyle=ct,fe!==void 0&&(fe.fillStyle=ct),I!==void 0?e.fillRect(ft+1,Ne+1,Xe-(Pe?2:1),_e-(Ze?2:1)):e.fillRect(ft,Ne,Xe,_e)),Ke.style==="faded"&&(e.globalAlpha=.6);let zt;for(let Ue=0;Ue<S.length;Ue++){const Mt=S[Ue];if(Mt.item[0]===ve.sourceIndex&&Mt.item[1]===Te){zt=Mt;break}}if(Xe>Ce&&!Ct){const Ue=wt.baseFontFull;Ue!==V&&(e.font=Ue,V=Ue),fe=jl(e,Ke,ve.sourceIndex,Te,Pe,Ze,ft,Ne,Xe,_e,Dt>0,wt,ct??wt.bgCell,z,K,(zt==null?void 0:zt.hoverAmount)??0,$,D,_,W,fe,M,re,te,ce)}return Rn&&e.restore(),Ke.style==="faded"&&(e.globalAlpha=1),Fe--,ze&&(e.restore(),(Bt=fe==null?void 0:fe.deprep)==null||Bt.call(fe,xe),fe=void 0,it(),V=Ie,e.font=Ie),Fe<=0}),e.restore(),Fe<=0}),pe}const qo=[0,0],jo={x:0,y:0,width:0,height:0},di=[void 0,()=>{}];let Ci=!1;function dc(){Ci=!0}function jl(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h,y,C,x,v,I,X,N,A,z,K){var re,te;let S,$;C!==void 0&&C[0][0]===n&&C[0][1]===o&&(S=C[1][0],$=C[1][1]);let W;qo[0]=n,qo[1]=o,jo.x=l,jo.y=s,jo.width=c,jo.height=u,di[0]=A.getValue(qo),di[1]=ce=>A.setValue(qo,ce),Ci=!1;const D={ctx:e,theme:m,col:n,row:o,cell:t,rect:jo,highlighted:f,cellFillColor:g,hoverAmount:y,frameTime:v,hoverX:S,drawState:di,hoverY:$,imageLoader:w,spriteManager:h,hyperWrapping:x,overrideCursor:S!==void 0?K:void 0,requestAnimationFrame:dc},R=pa(D,t.lastUpdated,v,X,r,i),M=z(t);if(M!==void 0){(X==null?void 0:X.renderer)!==M&&((re=X==null?void 0:X.deprep)==null||re.call(X,D),X=void 0);const ce=(te=M.drawPrep)==null?void 0:te.call(M,D,X);I!==void 0&&!Do(D.cell)?I(D,()=>M.draw(D,t)):M.draw(D,t),W=ce===void 0?void 0:{deprep:ce==null?void 0:ce.deprep,fillStyle:ce==null?void 0:ce.fillStyle,font:ce==null?void 0:ce.font,renderer:M}}return(R||Ci)&&(N==null||N(qo)),W}function Ii(e,t,n,o,r,i,l,s,c=-20,u=-20,f=32,m="center",g="square"){const w=Math.floor(r+l/2),h=g==="circle"?1e4:t.roundingRadius??4;let y=Dl(f,l,t.cellVerticalPadding),C=y/2;const x=Il(m,o,i,t.cellHorizontalPadding,y),v=El(x,w,y),I=Fl(o+c,r+u,v);switch(n){case!0:{e.beginPath(),Mn(e,x-y/2,w-y/2,y,y,h),g==="circle"&&(C*=.8,y*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(x-C+y/4.23,w-C+y/1.97),e.lineTo(x-C+y/2.42,w-C+y/1.44),e.lineTo(x-C+y/1.29,w-C+y/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Br:case!1:{e.beginPath(),Mn(e,x-y/2+.5,w-y/2+.5,y-1,y-1,h),e.lineWidth=1,e.strokeStyle=I?t.textDark:t.textMedium,e.stroke();break}case xi:{e.beginPath(),Mn(e,x-y/2,w-y/2,y,y,h),e.fillStyle=I?t.textMedium:t.textLight,e.fill(),g==="circle"&&(C*=.8,y*=.8),e.beginPath(),e.moveTo(x-y/3,w),e.lineTo(x+y/3,w),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:or()}}function uc(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h,y,C,x,v){var S,$,W,D;const I=l+s;if(I<=0)return;e.fillStyle=m.bgHeader,e.fillRect(0,0,r,I);const X=(S=o==null?void 0:o[0])==null?void 0:S[0],N=($=o==null?void 0:o[0])==null?void 0:$[1],A=(W=o==null?void 0:o[1])==null?void 0:W[0],z=(D=o==null?void 0:o[1])==null?void 0:D[1],K=m.headerFontFull;e.font=K,Vn(t,0,i,0,I,(R,M,re,te)=>{var ve;if(C!==void 0&&!C.has([R.sourceIndex,-1]))return;const ce=Math.max(0,te-M);e.save(),e.beginPath(),e.rect(M+ce,s,R.width-ce,l),e.clip();const Ce=y(R.group??"").overrideTheme,Fe=R.themeOverride===void 0&&Ce===void 0?m:Tn(m,Ce,R.themeOverride);Fe.bgHeader!==m.bgHeader&&(e.fillStyle=Fe.bgHeader,e.fill()),Fe!==m&&(e.font=Fe.baseFontFull);const _=f.columns.hasIndex(R.sourceIndex),V=c!==void 0||u,xe=!V&&N===-1&&X===R.sourceIndex,ne=V?0:((ve=w.find(je=>je.item[0]===R.sourceIndex&&je.item[1]===-1))==null?void 0:ve.hoverAmount)??0,be=(f==null?void 0:f.current)!==void 0&&f.current.cell[0]===R.sourceIndex,pe=_?Fe.accentColor:be?Fe.bgHeaderHasFocus:Fe.bgHeader,U=n?s:0,ke=R.sourceIndex===0?0:1;_?(e.fillStyle=pe,e.fillRect(M+ke,U,R.width-ke,l)):(be||ne>0)&&(e.beginPath(),e.rect(M+ke,U,R.width-ke,l),be&&(e.fillStyle=Fe.bgHeaderHasFocus,e.fill()),ne>0&&(e.globalAlpha=ne,e.fillStyle=Fe.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Ql(e,M,U,R.width,l,R,_,Fe,xe,xe?A:void 0,xe?z:void 0,be,ne,g,x,v),e.restore()}),n&&fc(e,t,r,i,s,o,m,g,w,h,y,C)}function fc(e,t,n,o,r,i,l,s,c,u,f,m){const[w,h]=(i==null?void 0:i[0])??[];let y=0;Vl(t,n,o,r,(C,x,v,I,X,N)=>{if(m!==void 0&&!m.hasItemInRectangle({x:C[0],y:-2,width:C[1]-C[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(v,I,X,N),e.clip();const A=f(x),z=(A==null?void 0:A.overrideTheme)===void 0?l:Tn(l,A.overrideTheme),K=h===-2&&w!==void 0&&w>=C[0]&&w<=C[1],S=K?z.bgHeaderHovered:z.bgHeader;if(S!==l.bgHeader&&(e.fillStyle=S,e.fill()),e.fillStyle=z.textGroupHeader??z.textHeader,A!==void 0){let $=v;if(A.icon!==void 0&&(s.drawSprite(A.icon,"normal",e,$+8,(r-20)/2,20,z),$+=26),e.fillText(A.name,$+8,r/2+Un(e,l.headerFontFull)),A.actions!==void 0&&K){const W=Zl({x:v,y:I,width:X,height:N},A.actions);e.beginPath();const D=W[0].x-10,R=v+X-D;e.rect(D,0,R,r);const M=e.createLinearGradient(D,0,D+R,0),re=so(S,0);M.addColorStop(0,re),M.addColorStop(10/R,S),M.addColorStop(1,S),e.fillStyle=M,e.fill(),e.globalAlpha=.6;const[te,ce]=(i==null?void 0:i[1])??[-1,-1];for(let Ce=0;Ce<A.actions.length;Ce++){const Fe=A.actions[Ce],_=W[Ce],V=lo(_,te+v,ce);V&&(e.globalAlpha=1),s.drawSprite(Fe.icon,"normal",e,_.x+_.width/2-10,_.y+_.height/2-10,20,z),V&&(e.globalAlpha=.6)}e.globalAlpha=1}}v!==0&&u(C[0])&&(e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,r),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),y=v+X}),e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}const Eo=30;function hc(e,t,n,o,r){return r?{x:e,y:t,width:Eo,height:Math.min(Eo,o)}:{x:e+n-Eo,y:Math.max(t,t+o/2-Eo/2),width:Eo,height:Math.min(Eo,o)}}function Zl(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:r,width:l,height:i}),o+=26;return n}function Zo(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function Jl(e,t,n,o,r,i,l,s){var x;const c=l.cellHorizontalPadding,u=l.headerIconSize,f=hc(n,o,r,i,!1);let m=n+c;const g=t.icon===void 0?void 0:{x:m,y:o+(i-u)/2,width:u,height:u},w=g===void 0||t.overlayIcon===void 0?void 0:{x:g.x+9,y:g.y+6,width:18,height:18};g!==void 0&&(m+=Math.ceil(u*1.3));const h={x:m,y:o,width:r-m,height:i};let y;if(t.indicatorIcon!==void 0){const v=e===void 0?((x=Ll(t.title,l.headerFontFull))==null?void 0:x.width)??0:zo(t.title,e,l.headerFontFull).width;h.width=v,m+=v+c,y={x:m,y:o+(i-u)/2,width:u,height:u}}const C=n+r/2;return{menuBounds:Zo(f,C,s),iconBounds:Zo(g,C,s),iconOverlayBounds:Zo(w,C,s),textBounds:Zo(h,C,s),indicatorIconBounds:Zo(y,C,s)}}function al(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h,y){if(i.rowMarker!==void 0){const v=i.rowMarkerChecked;v!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=m);const I=i.headerRowMarkerTheme!==void 0?Tn(s,i.headerRowMarkerTheme):s;Ii(e,I,v,t,n,o,r,!1,void 0,void 0,18,"center",i.rowMarker),v!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const C=l?s.textHeaderSelected:s.textHeader,x=i.hasMenu===!0&&(c||w&&l)&&y.menuBounds!==void 0;if(i.icon!==void 0&&y.iconBounds!==void 0){let v=l?"selected":"normal";i.style==="highlight"&&(v=l?"selected":"special"),g.drawSprite(i.icon,v,e,y.iconBounds.x,y.iconBounds.y,y.iconBounds.width,s),i.overlayIcon!==void 0&&y.iconOverlayBounds!==void 0&&g.drawSprite(i.overlayIcon,l?"selected":"special",e,y.iconOverlayBounds.x,y.iconOverlayBounds.y,y.iconOverlayBounds.width,s)}if(x&&o>35){const I=h?35:o-35,X=h?35*.7:o-35*.7,N=I/o,A=X/o,z=e.createLinearGradient(t,0,t+o,0),K=so(C,0);z.addColorStop(h?1:0,C),z.addColorStop(N,C),z.addColorStop(A,K),z.addColorStop(h?0:1,K),e.fillStyle=z}else e.fillStyle=C;if(h&&(e.textAlign="right"),y.textBounds!==void 0&&e.fillText(i.title,h?y.textBounds.x+y.textBounds.width:y.textBounds.x,n+r/2+Un(e,s.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&y.indicatorIconBounds!==void 0&&(!x||!ir(y.menuBounds.x,y.menuBounds.y,y.menuBounds.width,y.menuBounds.height,y.indicatorIconBounds.x,y.indicatorIconBounds.y,y.indicatorIconBounds.width,y.indicatorIconBounds.height))){let v=l?"selected":"normal";i.style==="highlight"&&(v=l?"selected":"special"),g.drawSprite(i.indicatorIcon,v,e,y.indicatorIconBounds.x,y.indicatorIconBounds.y,y.indicatorIconBounds.width,s)}if(x&&y.menuBounds!==void 0){const v=y.menuBounds,I=u!==void 0&&f!==void 0&&lo(v,u+t,f+n);if(I||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Lr.Triangle){e.beginPath();const X=v.x+v.width/2-5.5,N=v.y+v.height/2-3;ka(e,[{x:X,y:N},{x:X+11,y:N},{x:X+5.5,y:N+6}],1),e.fillStyle=C,e.fill()}else if(i.menuIcon===Lr.Dots){e.beginPath();const X=v.x+v.width/2,N=v.y+v.height/2;xa(e,X,N),e.fillStyle=C,e.fill()}else{const X=v.x+(v.width-s.headerIconSize)/2,N=v.y+(v.height-s.headerIconSize)/2;g.drawSprite(i.menuIcon,"normal",e,X,N,s.headerIconSize,s)}I||(e.globalAlpha=1)}}function Ql(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h,y){const C=Si(i.title)==="rtl",x=Jl(e,i,t,n,o,r,s,C);h!==void 0?h({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:l,hoverAmount:g,isHovered:c,hasSelectedCell:m,spriteManager:w,menuBounds:(x==null?void 0:x.menuBounds)??{x:0,y:0,height:0,width:0}},()=>al(e,t,n,o,r,i,l,s,c,u,f,g,w,y,C,x)):al(e,t,n,o,r,i,l,s,c,u,f,g,w,y,C,x)}function gc(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h,y,C,x,v){if(x!==void 0||t[t.length-1]!==n[t.length-1])return;const I=Ul(C);Vn(t,c,l,s,i,(X,N,A,z,K)=>{if(X!==t[t.length-1])return;N+=X.width;const S=Math.max(N,z);S>o||(e.save(),e.beginPath(),e.rect(S,i+1,1e4,r-i-1),e.clip(),Xr(K,A,r,u,f,h,y,I,($,W,D,R)=>{if(!R&&C.length>0&&!C.some(Ce=>ir(N,$,1e4,D,Ce.x,Ce.y,Ce.width,Ce.height)))return;const M=g.hasIndex(W),re=w.hasIndex(W);e.beginPath();const te=m==null?void 0:m(W),ce=te===void 0?v:Tn(v,te);ce.bgCell!==v.bgCell&&(e.fillStyle=ce.bgCell,e.fillRect(N,$,1e4,D)),re&&(e.fillStyle=ce.bgHeader,e.fillRect(N,$,1e4,D)),M&&(e.fillStyle=ce.accentLight,e.fillRect(N,$,1e4,D))}),e.restore())})}function mc(e,t,n,o,r,i,l,s,c){let u=!1;for(const h of t)if(!h.sticky){u=l(h.sourceIndex);break}const f=c.horizontalBorderColor??c.borderColor,m=c.borderColor,g=u?Ao(t):0;let w;if(g!==0&&(w=ol(m,c.bgCell),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,o),e.strokeStyle=w,e.stroke()),r>0){const h=m===f&&w!==void 0?w:ol(f,c.bgCell),y=ao(i,r,s);e.beginPath(),e.moveTo(0,o-y+.5),e.lineTo(n,o-y+.5),e.strokeStyle=h,e.stroke()}}const es=(e,t,n)=>{let o=0,r=t,i=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),r=Math.max(r,s.x+s.width+1),i=Math.min(i,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:r,minY:i,maxY:l}};function wc(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h){var D;const y=h.bgCell,{minX:C,maxX:x,minY:v,maxY:I}=es(s,i,l),X=[],N=l-ao(w,g,u);let A=c,z=n,K=0;for(;A+r<N;){const R=A+r,M=u(z);if(R>=v&&R<=I-1){const re=f==null?void 0:f(z),te=re==null?void 0:re.bgCell;te!==void 0&&te!==y&&z>=w-g&&X.push({x:C,y:R,w:x-C,h:M,color:te})}A+=M,z<w-g&&(K=A),z++}let S=0;const $=Math.min(N,I)-K;if($>0)for(let R=0;R<t.length;R++){const M=t[R];if(M.width===0)continue;const re=M.sticky?S:S+o,te=(D=M.themeOverride)==null?void 0:D.bgCell;te!==void 0&&te!==y&&re>=C&&re<=x&&m(R+1)&&X.push({x:re,y:K,w:M.width,h:$,color:te}),S+=M.width}if(X.length===0)return;let W;e.beginPath();for(let R=X.length-1;R>=0;R--){const M=X[R];W===void 0?W=M.color:M.color!==W&&(e.fillStyle=W,e.fill(),e.beginPath(),W=M.color),e.rect(M.x,M.y,M.w,M.h)}W!==void 0&&(e.fillStyle=W,e.fill()),e.beginPath()}function cl(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h,y,C,x=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,l);for(const D of c)e.rect(D.x+1,D.y+1,D.width-1,D.height-1);e.clip("evenodd")}const v=C.horizontalBorderColor??C.borderColor,I=C.borderColor,{minX:X,maxX:N,minY:A,maxY:z}=es(s,i,l),K=[];e.beginPath();let S=.5;for(let D=0;D<t.length;D++){const R=t[D];if(R.width===0)continue;S+=R.width;const M=R.sticky?S:S+o;M>=X&&M<=N&&w(D+1)&&K.push({x1:M,y1:Math.max(u,A),x2:M,y2:Math.min(l,z),color:I})}let $=l+.5;for(let D=y-h;D<y;D++){const R=m(D);$-=R,K.push({x1:X,y1:$,x2:N,y2:$,color:v})}if(x!==!0){let D=f+.5,R=n;const M=$;for(;D+r<M;){const re=D+r;if(re>=A&&re<=z-1){const te=g==null?void 0:g(R);K.push({x1:X,y1:re,x2:N,y2:re,color:(te==null?void 0:te.horizontalBorderColor)??(te==null?void 0:te.borderColor)??v})}D+=m(R),R++}}const W=Ns(K,D=>D.color);for(const D of Object.keys(W)){e.strokeStyle=D;for(const R of W[D])e.moveTo(R.x1,R.y1),e.lineTo(R.x2,R.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function yc(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h,y,C,x,v){const I=[];e.imageSmoothingEnabled=!1;const X=Math.min(r.cellYOffset,l),N=Math.max(r.cellYOffset,l);let A=0;if(typeof x=="number")A+=(N-X)*x;else for(let M=X;M<N;M++)A+=x(M);l>r.cellYOffset&&(A=-A),A+=c-r.translateY;const z=Math.min(r.cellXOffset,i),K=Math.max(r.cellXOffset,i);let S=0;for(let M=z;M<K;M++)S+=y[M].width;i>r.cellXOffset&&(S=-S),S+=s-r.translateX;const $=Ao(C);if(S!==0&&A!==0)return{regions:[]};const W=u>0?ao(g,u,x):0,D=f-$-Math.abs(S),R=m-w-W-Math.abs(A)-1;if(D>150&&R>150){const M={sx:0,sy:0,sw:f*h,sh:m*h,dx:0,dy:0,dw:f*h,dh:m*h};if(A>0?(M.sy=(w+1)*h,M.sh=R*h,M.dy=(A+w+1)*h,M.dh=R*h,I.push({x:0,y:w,width:f,height:A+1})):A<0&&(M.sy=(-A+w+1)*h,M.sh=R*h,M.dy=(w+1)*h,M.dh=R*h,I.push({x:0,y:m+A-W,width:f,height:-A+W})),S>0?(M.sx=$*h,M.sw=D*h,M.dx=(S+$)*h,M.dw=D*h,I.push({x:$-1,y:0,width:S+2,height:m})):S<0&&(M.sx=($-S)*h,M.sw=D*h,M.dx=$*h,M.dw=D*h,I.push({x:f+S,y:0,width:-S,height:m})),e.setTransform(1,0,0,1,0,0),v){if($>0&&S!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const re=$*h,te=m*h;e.drawImage(t,0,0,re,te,0,0,re,te)}if(W>0&&S===0&&A!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const re=(m-W)*h,te=f*h,ce=W*h;e.drawImage(t,0,re,te,ce,0,re,te,ce)}}e.drawImage(t,M.sx,M.sy,M.sw,M.sh,M.dx,M.dy,M.dw,M.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:I}}function bc(e,t,n,o,r,i,l,s,c,u){const f=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||Vn(c,n,o,r,s,(m,g,w,h)=>{if(m.sourceIndex===u){const y=Math.max(g,h)+1;return f.push({x:y,y:0,width:i-y,height:l}),!0}}),f}function pc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Ho(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:l,...s}=r,{width:c,...u}=i;if(!Ho(s,u))return!1;n=o}return n===void 0?!0:n}return!0}function dl(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h,y){const C=h==null?void 0:h.filter(z=>z.style!=="no-outline");if(C===void 0||C.length===0)return;const x=Ao(s),v=ao(w,g,m),I=[c,0,s.length,w-g],X=[x,0,t,n-v],N=C.map(z=>{const K=z.range,S=z.style??"dashed";return ac(K,I,t,n,X).map($=>{const W=$.rect,D=pi(W.x,W.y,t,n,f,u+f,o,r,i,l,w,c,g,s,m),R=W.width===1&&W.height===1?D:pi(W.x+W.width-1,W.y+W.height-1,t,n,f,u+f,o,r,i,l,w,c,g,s,m);return W.x+W.width>=s.length&&(R.width-=1),W.y+W.height>=w&&(R.height-=1),{color:z.color,style:S,clip:$.clip,rect:sc({x:D.x,y:D.y,width:R.x+R.width-D.x,height:R.y+R.height-D.y},t,n,8)}})}),A=()=>{e.lineWidth=1;let z=!1;for(const K of N)for(const S of K)if((S==null?void 0:S.rect)!==void 0&&ir(0,0,t,n,S.rect.x,S.rect.y,S.rect.width,S.rect.height)){const $=z,W=!lc(S.clip,S.rect);W&&(e.save(),e.rect(S.clip.x,S.clip.y,S.clip.width,S.clip.height),e.clip()),S.style==="dashed"&&!z?(e.setLineDash([5,3]),z=!0):(S.style==="solid"||S.style==="solid-outline")&&z&&(e.setLineDash([]),z=!1),e.strokeStyle=S.style==="solid-outline"?en(en(S.color,y.borderColor),y.bgCell):so(S.color,1),e.strokeRect(S.rect.x+.5,S.rect.y+.5,S.rect.width-1,S.rect.height-1),W&&(e.restore(),z=$)}z&&e.setLineDash([])};return A(),A}function ul(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function ui(e,t,n,o,r,i,l,s,c,u,f,m,g,w,h,y,C){if(f.current===void 0)return;const x=f.current.range,v=f.current.cell,I=[x.x+x.width-1,x.y+x.height-1];if(v[1]>=C&&I[1]>=C||!l.some(M=>M.sourceIndex===v[0]||M.sourceIndex===I[0]))return;const[N,A]=f.current.cell,z=g(f.current.cell),K=z.span??[N,N],S=A>=C-w,$=w>0&&!S?ao(C,w,m)-1:0,W=I[1];let D;if(Vn(l,o,r,i,u,(M,re,te,ce,Ce)=>{if(M.sticky&&N>M.sourceIndex)return;const Fe=M.sourceIndex<K[0],_=M.sourceIndex>K[1],V=M.sourceIndex===I[0];if(!(!V&&(Fe||_)))return Xr(Ce,te,n,C,m,w,h,void 0,(xe,ne,be)=>{if(ne!==A&&ne!==W)return;let pe=re,U=M.width;if(z.span!==void 0){const ve=_l(z.span,re,xe,M.width,be,M,s),je=M.sticky?ve[0]:ve[1];je!==void 0&&(pe=je.x,U=je.width)}return ne===W&&V&&y&&(D=()=>{var ve;ce>pe&&!M.sticky&&(e.beginPath(),e.rect(ce,0,t-ce,n),e.clip()),e.beginPath(),e.rect(pe+U-4,xe+be-4,4,4),e.fillStyle=((ve=M.themeOverride)==null?void 0:ve.accentColor)??c.accentColor,e.fill()}),D!==void 0}),D!==void 0}),D===void 0)return;const R=()=>{e.save(),e.beginPath(),e.rect(0,u,t,n-u-$),e.clip(),D==null||D(),e.restore()};return R(),R}function vc(e,t,n,o,r,i,l,s,c){c===void 0||c.size===0||(e.beginPath(),Vl(t,n,i,o,(u,f,m,g,w,h)=>{c.hasItemInRectangle({x:u[0],y:-2,width:u[1]-u[0]+1,height:1})&&e.rect(m,g,w,h)}),Vn(t,s,i,l,r,(u,f,m,g)=>{const w=Math.max(0,g-f),h=f+w+1,y=u.width-w-1;c.has([u.sourceIndex,-1])&&e.rect(h,o,y,r-o)}),e.clip())}function Cc(e,t,n,o,r,i,l,s,c,u){let f=0;return Vn(e,i,o,r,n,(m,g,w,h,y)=>(Xr(y,w,t,l,s,c,u,void 0,(C,x,v,I)=>{I||(f=Math.max(x,f))}),!0)),f}function fl(e,t){var Pe;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:l,cellYOffset:s,translateX:c,translateY:u,mappedColumns:f,enableGroups:m,freezeColumns:g,dragAndDropState:w,theme:h,drawFocus:y,headerHeight:C,groupHeaderHeight:x,disabledRows:v,rowHeight:I,verticalBorder:X,overrideCursor:N,isResizing:A,selection:z,fillHandle:K,freezeTrailingRows:S,rows:$,getCellContent:W,getGroupDetails:D,getRowThemeOverride:R,isFocused:M,drawHeaderCallback:re,prelightCells:te,drawCellCallback:ce,highlightRegions:Ce,resizeCol:Fe,imageLoader:_,lastBlitData:V,hoverValues:xe,hyperWrapping:ne,hoverInfo:be,spriteManager:pe,maxScaleFactor:U,hasAppendRow:ke,touchMode:ve,enqueue:je,renderStateProvider:nt,getCellRenderer:mt,renderStrategy:et,bufferACtx:Ae,bufferBCtx:Ve,damage:Re,minimumCellWidth:ut,resizeIndicator:rt}=e;if(r===0||i===0)return;const it=et==="double-buffer",ie=Math.min(U,Math.ceil(window.devicePixelRatio??1)),We=et!=="direct"&&pc(e,t),De=n.canvas;(De.width!==r*ie||De.height!==i*ie)&&(De.width=r*ie,De.height=i*ie,De.style.width=r+"px",De.style.height=i+"px");const Ie=o.canvas,fe=m?x+C:C,Ne=fe+1;(Ie.width!==r*ie||Ie.height!==Ne*ie)&&(Ie.width=r*ie,Ie.height=Ne*ie,Ie.style.width=r+"px",Ie.style.height=Ne+"px");const Te=Ae.canvas,_e=Ve.canvas;it&&(Te.width!==r*ie||Te.height!==i*ie)&&(Te.width=r*ie,Te.height=i*ie,V.current!==void 0&&(V.current.aBufferScroll=void 0)),it&&(_e.width!==r*ie||_e.height!==i*ie)&&(_e.width=r*ie,_e.height=i*ie,V.current!==void 0&&(V.current.bBufferScroll=void 0));const oe=V.current;if(We===!0&&l===(oe==null?void 0:oe.cellXOffset)&&s===(oe==null?void 0:oe.cellYOffset)&&c===(oe==null?void 0:oe.translateX)&&u===(oe==null?void 0:oe.translateY))return;let He=null;it&&(He=n);const tt=o;let $e;it?Re!==void 0?$e=(oe==null?void 0:oe.lastBuffer)==="b"?Ve:Ae:$e=(oe==null?void 0:oe.lastBuffer)==="b"?Ae:Ve:$e=n;const Ke=$e.canvas,ft=it?Ke===Te?_e:Te:De,Xe=typeof I=="number"?()=>I:I;tt.save(),$e.save(),tt.beginPath(),$e.beginPath(),tt.textBaseline="middle",$e.textBaseline="middle",ie!==1&&(tt.scale(ie,ie),$e.scale(ie,ie));const ze=bi(f,l,r,w,c);let Ct=[];const xt=y&&((Pe=z.current)==null?void 0:Pe.cell[1])===s&&u===0;let Xt=!1;if(Ce!==void 0){for(const Ze of Ce)if(Ze.style!=="no-outline"&&Ze.range.y===s&&u===0){Xt=!0;break}}const wt=()=>{uc(tt,ze,m,be,r,c,C,x,w,A,z,h,pe,xe,X,D,Re,re,ve),cl(tt,ze,s,c,u,r,i,void 0,void 0,x,fe,Xe,R,X,S,$,h,!0),tt.beginPath(),tt.moveTo(0,Ne-.5),tt.lineTo(r,Ne-.5),tt.strokeStyle=en(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),tt.stroke(),Xt&&dl(tt,r,i,l,s,c,u,f,g,C,x,I,S,$,Ce,h),xt&&ui(tt,r,i,s,c,u,ze,f,h,fe,z,Xe,W,S,ke,K,$)};if(Re!==void 0){const Ze=ze[ze.length-1].sourceIndex+1,zt=Re.hasItemInRegion([{x:l,y:-2,width:Ze,height:2},{x:l,y:s,width:Ze,height:300},{x:0,y:s,width:g,height:300},{x:0,y:-2,width:g,height:2},{x:l,y:$-S,width:Ze,height:S,when:S>0}]),En=nn=>{sl(nn,ze,f,i,fe,c,u,s,$,Xe,W,D,R,v,M,y,S,ke,Ct,Re,z,te,Ce,_,pe,xe,be,ce,ne,h,je,nt,mt,N,ut);const Bt=z.current;K&&y&&Bt!==void 0&&Re.has(Al(Bt.range))&&ui(nn,r,i,s,c,u,ze,f,h,fe,z,Xe,W,S,ke,K,$)};zt&&(En($e),He!==null&&(He.save(),He.scale(ie,ie),He.textBaseline="middle",En(He),He.restore()),Re.hasHeader()&&(vc(tt,ze,r,x,fe,c,u,s,Re),wt())),$e.restore(),tt.restore();return}if((We!==!0||l!==(oe==null?void 0:oe.cellXOffset)||c!==(oe==null?void 0:oe.translateX)||xt!==(oe==null?void 0:oe.mustDrawFocusOnHeader)||Xt!==(oe==null?void 0:oe.mustDrawHighlightRingsOnHeader))&&wt(),We===!0){Qt(ft!==void 0&&oe!==void 0);const{regions:Ze}=yc($e,ft,ft===Te?oe.aBufferScroll:oe.bBufferScroll,ft===Te?oe.bBufferScroll:oe.aBufferScroll,oe,l,s,c,u,S,r,i,$,fe,ie,f,ze,I,it);Ct=Ze}else We!==!1&&(Qt(oe!==void 0),Ct=bc(oe,l,s,c,u,r,i,fe,ze,We));mc($e,ze,r,i,S,$,X,Xe,h);const It=dl($e,r,i,l,s,c,u,f,g,C,x,I,S,$,Ce,h),Dt=y?ui($e,r,i,s,c,u,ze,f,h,fe,z,Xe,W,S,ke,K,$):void 0;if($e.fillStyle=h.bgCell,Ct.length>0){$e.beginPath();for(const Ze of Ct)$e.rect(Ze.x,Ze.y,Ze.width,Ze.height);$e.clip(),$e.fill(),$e.beginPath()}else $e.fillRect(0,0,r,i);const An=sl($e,ze,f,i,fe,c,u,s,$,Xe,W,D,R,v,M,y,S,ke,Ct,Re,z,te,Ce,_,pe,xe,be,ce,ne,h,je,nt,mt,N,ut);gc($e,ze,f,r,i,fe,c,u,s,$,Xe,R,z.rows,v,S,ke,Ct,Re,h),wc($e,ze,s,c,u,r,i,Ct,fe,Xe,R,X,S,$,h),cl($e,ze,s,c,u,r,i,Ct,An,x,fe,Xe,R,X,S,$,h),It==null||It(),Dt==null||Dt(),A&&rt!=="none"&&Vn(ze,0,c,0,fe,(Ze,zt)=>Ze.sourceIndex===Fe?(ul(tt,zt+Ze.width,0,fe+1,en(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),rt==="full"&&ul($e,zt+Ze.width,fe,i,en(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),He!==null&&(He.fillStyle=h.bgCell,He.fillRect(0,0,r,i),He.drawImage($e.canvas,0,0));const zn=Cc(ze,i,fe,c,u,s,$,Xe,S,ke);_==null||_.setWindow({x:l,y:s,width:ze.length,height:zn-s},g,Array.from({length:S},(Ze,zt)=>$-1-zt));const ct=oe!==void 0&&(l!==oe.cellXOffset||c!==oe.translateX),Rn=oe!==void 0&&(s!==oe.cellYOffset||u!==oe.translateY);V.current={cellXOffset:l,cellYOffset:s,translateX:c,translateY:u,mustDrawFocusOnHeader:xt,mustDrawHighlightRingsOnHeader:Xt,lastBuffer:it?Ke===Te?"a":"b":void 0,aBufferScroll:Ke===Te?[ct,Rn]:oe==null?void 0:oe.aBufferScroll,bBufferScroll:Ke===_e?[ct,Rn]:oe==null?void 0:oe.bBufferScroll},$e.restore(),tt.restore()}const xc=80;function kc(e){const t=e-1;return t*t*t+1}class Sc{constructor(t){Oe(this,"callback");Oe(this,"currentHoveredItem");Oe(this,"leavingItems",[]);Oe(this,"lastAnimationTime");Oe(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>er(o.item,t.item))||this.leavingItems.push(t)});Oe(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>er(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Oe(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Oe(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Oe(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:kc(t.hoverAmount)})));Oe(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/xc;for(const i of this.leavingItems)i.hoverAmount=sn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=sn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Oe(this,"setHovered",t=>{var n;if(!er((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Mc{constructor(t){Oe(this,"fn");Oe(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Di(e){return new Mc(e)}const Rc=Di(()=>window.navigator.userAgent.includes("Firefox")),Pr=Di(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Wr=Di(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Ec(e){const t=a.useRef([]),n=a.useRef(0),o=a.useRef(e);o.current=e;const r=a.useCallback(()=>{const i=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(Ei);t.current=[],o.current(new nr(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:l)},[]);return a.useCallback(i=>{t.current.length===0&&r();const l=bn(i[0],i[1]);t.current.includes(l)||t.current.push(l)},[r])}const Kn="header",an="group-header",$r="out-of-bounds";var Fo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Fo||(Fo={}));function ts(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const hl=6,Ic=(e,t)=>{if(e.kind===j.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Dc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:l,cellYOffset:s,headerHeight:c,fillHandle:u=!1,groupHeaderHeight:f,rowHeight:m,rows:g,getCellContent:w,getRowThemeOverride:h,onHeaderMenuClick:y,onHeaderIndicatorClick:C,enableGroups:x,isFilling:v,onCanvasFocused:I,onCanvasBlur:X,isFocused:N,selection:A,freezeColumns:z,onContextMenu:K,freezeTrailingRows:S,fixedShadowX:$=!0,fixedShadowY:W=!0,drawFocusRing:D,onMouseDown:R,onMouseUp:M,onMouseMoveRaw:re,onMouseMove:te,onItemHovered:ce,dragAndDropState:Ce,firstColAccessible:Fe,onKeyDown:_,onKeyUp:V,highlightRegions:xe,canvasRef:ne,onDragStart:be,onDragEnd:pe,eventTargetRef:U,isResizing:ke,resizeColumn:ve,isDragging:je,isDraggable:nt=!1,allowResize:mt,disabledRows:et,hasAppendRow:Ae,getGroupDetails:Ve,theme:Re,prelightCells:ut,headerIcons:rt,verticalBorder:it,drawCell:ie,drawHeader:We,onCellFocused:De,onDragOverCell:Ie,onDrop:fe,onDragLeave:Ne,imageWindowLoader:Te,smoothScrollX:_e=!1,smoothScrollY:oe=!1,experimental:He,getCellRenderer:tt,resizeIndicator:$e="full"}=e,Ke=e.translateX??0,ft=e.translateY??0,Xe=Math.max(z,Math.min(i.length-1,l)),ze=a.useRef(null),Ct=a.useRef(window),xt=Ct.current,Xt=Te,wt=a.useRef(),[It,Dt]=a.useState(!1),An=a.useRef([]),zn=a.useRef(),[ct,Rn]=a.useState(),[Pe,Ze]=a.useState(),zt=a.useRef(null),[En,nn]=a.useState(),[Bt,Ue]=a.useState(!1),Mt=a.useRef(Bt);Mt.current=Bt;const at=a.useMemo(()=>new rc(rt,()=>{co.current=void 0,qn.current()}),[rt]),Pt=x?f+c:c,Tt=a.useRef(-1),jt=((He==null?void 0:He.enableFirefoxRescaling)??!1)&&Rc.value,Bo=((He==null?void 0:He.enableSafariRescaling)??!1)&&Pr.value;a.useLayoutEffect(()=>{window.devicePixelRatio===1||!jt&&!Bo||(Tt.current!==-1&&Dt(!0),window.clearTimeout(Tt.current),Tt.current=window.setTimeout(()=>{Dt(!1),Tt.current=-1},200))},[s,Xe,Ke,ft,jt,Bo]);const kt=da(i,z),Ft=$?Ao(kt,Ce):0,Ht=a.useCallback((k,G,de)=>{const se=k.getBoundingClientRect();if(G>=kt.length||de>=g)return;const q=se.width/n,J=pi(G,de,n,o,f,Pt,Xe,s,Ke,ft,g,z,S,kt,m);return q!==1&&(J.x*=q,J.y*=q,J.width*=q,J.height*=q),J.x+=se.x,J.y+=se.y,J},[n,o,f,Pt,Xe,s,Ke,ft,g,z,S,kt,m]),At=a.useCallback((k,G,de,se)=>{const q=k.getBoundingClientRect(),J=q.width/n,ae=(G-q.left)/J,ue=(de-q.top)/J,Z=5,qe=bi(kt,Xe,n,void 0,Ke);let he=0,Je=0;se instanceof MouseEvent&&(he=se.button,Je=se.buttons);const Ye=ga(ae,qe,Ke),Ee=ma(ue,o,x,c,f,g,m,s,ft,S),ot=(se==null?void 0:se.shiftKey)===!0,Vt=(se==null?void 0:se.ctrlKey)===!0,pt=(se==null?void 0:se.metaKey)===!0,Yt=se!==void 0&&!(se instanceof MouseEvent)||(se==null?void 0:se.pointerType)==="touch",hn=[ae<0?-1:n<ae?1:0,ue<Pt?-1:o<ue?1:0];let _t;if(Ye===-1||ue<0||ae<0||Ee===void 0||ae>n||ue>o){const ge=ae>n?1:ae<0?-1:0,ht=ue>o?1:ue<0?-1:0;let Gt=ge*2,On=ht*2;ge===0&&(Gt=Ye===-1?Fo.EndPadding:Fo.Center),ht===0&&(On=Ee===void 0?Fo.EndPadding:Fo.Center);let Ot=!1;if(Ye===-1&&Ee===-1){const Jn=Ht(k,kt.length-1,-1);Qt(Jn!==void 0),Ot=G<Jn.x+Jn.width+Z}const lt=ae>n&&ae<n+yi()||ue>o&&ue<o+yi();_t={kind:$r,location:[Ye!==-1?Ye:ae<0?0:kt.length-1,Ee??g-1],region:[Gt,On],shiftKey:ot,ctrlKey:Vt,metaKey:pt,isEdge:Ot,isTouch:Yt,button:he,buttons:Je,scrollEdge:hn,isMaybeScrollbar:lt}}else if(Ee<=-1){let ge=Ht(k,Ye,Ee);Qt(ge!==void 0);let ht=ge!==void 0&&ge.x+ge.width-G<=Z;const Gt=Ye-1;G-ge.x<=Z&&Gt>=0?(ht=!0,ge=Ht(k,Gt,Ee),Qt(ge!==void 0),_t={kind:x&&Ee===-2?an:Kn,location:[Gt,Ee],bounds:ge,group:kt[Gt].group??"",isEdge:ht,shiftKey:ot,ctrlKey:Vt,metaKey:pt,isTouch:Yt,localEventX:G-ge.x,localEventY:de-ge.y,button:he,buttons:Je,scrollEdge:hn}):_t={kind:x&&Ee===-2?an:Kn,group:kt[Ye].group??"",location:[Ye,Ee],bounds:ge,isEdge:ht,shiftKey:ot,ctrlKey:Vt,metaKey:pt,isTouch:Yt,localEventX:G-ge.x,localEventY:de-ge.y,button:he,buttons:Je,scrollEdge:hn}}else{const ge=Ht(k,Ye,Ee);Qt(ge!==void 0);const ht=ge!==void 0&&ge.x+ge.width-G<Z;let Gt=!1;if(u&&A.current!==void 0){const On=Al(A.current.range),Ot=Ht(k,On[0],On[1]);if(Ot!==void 0){const lt=Ot.x+Ot.width-2,Jn=Ot.y+Ot.height-2;Gt=Math.abs(lt-G)<hl&&Math.abs(Jn-de)<hl}}_t={kind:"cell",location:[Ye,Ee],bounds:ge,isEdge:ht,shiftKey:ot,ctrlKey:Vt,isFillHandle:Gt,metaKey:pt,isTouch:Yt,localEventX:G-ge.x,localEventY:de-ge.y,button:he,buttons:Je,scrollEdge:hn}}return _t},[n,kt,Xe,Ke,o,x,c,f,g,m,s,ft,S,Ht,u,A,Pt]),[In]=ct??[],sr=a.useRef(()=>{}),Bn=a.useRef(ct);Bn.current=ct;const[Dn,Fn]=a.useMemo(()=>{const k=document.createElement("canvas"),G=document.createElement("canvas");return k.style.display="none",k.style.opacity="0",k.style.position="fixed",G.style.display="none",G.style.opacity="0",G.style.position="fixed",[k.getContext("2d",{alpha:!1}),G.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>{if(!(Dn===null||Fn===null))return document.documentElement.append(Dn.canvas),document.documentElement.append(Fn.canvas),()=>{Dn.canvas.remove(),Fn.canvas.remove()}},[Dn,Fn]);const pn=a.useMemo(()=>new Sa,[]),ar=jt&&It?1:Bo&&It?2:5,cr=(He==null?void 0:He.disableMinimumCellWidth)===!0?1:10,co=a.useRef(),uo=a.useRef(null),fo=a.useRef(null),_n=a.useCallback(()=>{var ae;const k=ze.current,G=zt.current;if(k===null||G===null||(uo.current===null&&(uo.current=k.getContext("2d",{alpha:!1}),k.width=0,k.height=0),fo.current===null&&(fo.current=G.getContext("2d",{alpha:!1}),G.width=0,G.height=0),uo.current===null||fo.current===null||Dn===null||Fn===null))return;let de=!1;const se=ue=>{de=!0,nn(ue)},q=co.current,J={headerCanvasCtx:fo.current,canvasCtx:uo.current,bufferACtx:Dn,bufferBCtx:Fn,width:n,height:o,cellXOffset:Xe,cellYOffset:s,translateX:Math.round(Ke),translateY:Math.round(ft),mappedColumns:kt,enableGroups:x,freezeColumns:z,dragAndDropState:Ce,theme:Re,headerHeight:c,groupHeaderHeight:f,disabledRows:et??st.empty(),rowHeight:m,verticalBorder:it,isResizing:ke,resizeCol:ve,isFocused:N,selection:A,fillHandle:u,drawCellCallback:ie,hasAppendRow:Ae,overrideCursor:se,maxScaleFactor:ar,freezeTrailingRows:S,rows:g,drawFocus:D,getCellContent:w,getGroupDetails:Ve??(ue=>({name:ue})),getRowThemeOverride:h,drawHeaderCallback:We,prelightCells:ut,highlightRegions:xe,imageLoader:Xt,lastBlitData:zn,damage:wt.current,hoverValues:An.current,hoverInfo:Bn.current,spriteManager:at,scrolling:It,hyperWrapping:(He==null?void 0:He.hyperWrapping)??!1,touchMode:Bt,enqueue:sr.current,renderStateProvider:pn,renderStrategy:(He==null?void 0:He.renderStrategy)??(Pr.value?"double-buffer":"single-buffer"),getCellRenderer:tt,minimumCellWidth:cr,resizeIndicator:$e};J.damage===void 0?(co.current=J,fl(J,q)):fl(J,void 0),!de&&(J.damage===void 0||J.damage.has((ae=Bn==null?void 0:Bn.current)==null?void 0:ae[0]))&&nn(void 0)},[Dn,Fn,n,o,Xe,s,Ke,ft,kt,x,z,Ce,Re,c,f,et,m,it,ke,Ae,ve,N,A,u,S,g,D,ar,w,Ve,h,ie,We,ut,xe,Xt,at,It,He==null?void 0:He.hyperWrapping,He==null?void 0:He.renderStrategy,Bt,pn,tt,cr,$e]),qn=a.useRef(_n);a.useLayoutEffect(()=>{_n(),qn.current=_n},[_n]),a.useLayoutEffect(()=>{(async()=>{var G;((G=document==null?void 0:document.fonts)==null?void 0:G.ready)!==void 0&&(await document.fonts.ready,co.current=void 0,qn.current())})()},[]);const Ln=a.useCallback(k=>{wt.current=k,qn.current(),wt.current=void 0},[]),Yr=Ec(Ln);sr.current=Yr;const dr=a.useCallback(k=>{Ln(new nr(k.map(G=>G.cell)))},[Ln]);Xt.setCallback(Ln);const[ur,Gr]=a.useState(!1),[ho,Pn]=In??[],Lo=ho!==void 0&&Pn===-1,Kr=ho!==void 0&&Pn===-2;let Po=!1,yt=!1,Wt=En;if(Wt===void 0&&ho!==void 0&&Pn!==void 0&&Pn>-1&&Pn<g){const k=w([ho,Pn],!0);Po=k.kind===cn.NewRow||k.kind===cn.Marker&&k.markerKind!=="number",yt=k.kind===j.Boolean&&wi(k),Wt=k.cursor}const Wo=je?"grabbing":(Pe??!1)||ke?"col-resize":ur||v?"crosshair":Wt!==void 0?Wt:Lo||Po||yt||Kr?"pointer":"default",go=a.useMemo(()=>({contain:"strict",display:"block",cursor:Wo}),[Wo]),$o=a.useRef("default"),mo=U==null?void 0:U.current;mo!=null&&$o.current!==go.cursor&&(mo.style.cursor=$o.current=go.cursor);const dn=a.useCallback((k,G,de,se)=>{if(Ve===void 0)return;const q=Ve(k);if(q.actions!==void 0){const J=Zl(G,q.actions);for(const[ae,ue]of J.entries())if(lo(ue,de+G.x,se+ue.y))return q.actions[ae]}},[Ve]),Zt=a.useCallback((k,G,de,se)=>{const q=kt[G];if(!je&&!ke&&!(Pe??!1)){const J=Ht(k,G,-1);Qt(J!==void 0);const ae=Jl(void 0,q,J.x,J.y,J.width,J.height,Re,Si(q.title)==="rtl");if(q.hasMenu===!0&&ae.menuBounds!==void 0&&lo(ae.menuBounds,de,se))return{area:"menu",bounds:ae.menuBounds};if(q.indicatorIcon!==void 0&&ae.indicatorIconBounds!==void 0&&lo(ae.indicatorIconBounds,de,se))return{area:"indicator",bounds:ae.indicatorIconBounds}}},[kt,Ht,Pe,je,ke,Re]),Wn=a.useRef(0),jn=a.useRef(),wo=a.useRef(!1),Se=a.useCallback(k=>{const G=ze.current,de=U==null?void 0:U.current;if(G===null||k.target!==G&&k.target!==de)return;wo.current=!0;let se,q;if(k instanceof MouseEvent?(se=k.clientX,q=k.clientY):(se=k.touches[0].clientX,q=k.touches[0].clientY),k.target===de&&de!==null){const ae=de.getBoundingClientRect();if(se>ae.right||q>ae.bottom)return}const J=At(G,se,q,k);jn.current=J.location,J.isTouch&&(Wn.current=Date.now()),Mt.current!==J.isTouch&&Ue(J.isTouch),!(J.kind===Kn&&Zt(G,J.location[0],se,q)!==void 0)&&(J.kind===an&&dn(J.group,J.bounds,J.localEventX,J.localEventY)!==void 0||(R==null||R(J),!J.isTouch&&nt!==!0&&nt!==J.kind&&J.button<3&&J.button!==1&&k.preventDefault()))},[U,nt,At,dn,Zt,R]);Lt("touchstart",Se,xt,!1),Lt("mousedown",Se,xt,!1);const Oo=a.useRef(0),fr=a.useCallback(k=>{var Je,Ye;const G=Oo.current;Oo.current=Date.now();const de=ze.current;if(wo.current=!1,M===void 0||de===null)return;const se=U==null?void 0:U.current,q=k.target!==de&&k.target!==se;let J,ae,ue=!0;if(k instanceof MouseEvent){if(J=k.clientX,ae=k.clientY,ue=k.button<3,k.pointerType==="touch")return}else J=k.changedTouches[0].clientX,ae=k.changedTouches[0].clientY;let Z=At(de,J,ae,k);Z.isTouch&&Wn.current!==0&&Date.now()-Wn.current>500&&(Z={...Z,isLongTouch:!0}),G!==0&&Date.now()-G<(Z.isTouch?1e3:500)&&(Z={...Z,isDoubleClick:!0}),Mt.current!==Z.isTouch&&Ue(Z.isTouch),!q&&k.cancelable&&ue&&k.preventDefault();const[qe]=Z.location,he=Zt(de,qe,J,ae);if(Z.kind===Kn&&he!==void 0){(Z.button!==0||((Je=jn.current)==null?void 0:Je[0])!==qe||((Ye=jn.current)==null?void 0:Ye[1])!==-1)&&M(Z,!0);return}else if(Z.kind===an){const Ee=dn(Z.group,Z.bounds,Z.localEventX,Z.localEventY);if(Ee!==void 0){Z.button===0&&Ee.onClick(Z);return}}M(Z,q)},[M,U,At,Zt,dn]);Lt("mouseup",fr,xt,!1),Lt("touchend",fr,xt,!1);const un=a.useCallback(k=>{var qe,he;const G=ze.current;if(G===null)return;const de=U==null?void 0:U.current,se=k.target!==G&&k.target!==de;let q,J,ae=!0;k instanceof MouseEvent?(q=k.clientX,J=k.clientY,ae=k.button<3):(q=k.changedTouches[0].clientX,J=k.changedTouches[0].clientY);const ue=At(G,q,J,k);Mt.current!==ue.isTouch&&Ue(ue.isTouch),!se&&k.cancelable&&ae&&k.preventDefault();const[Z]=ue.location;if(ue.kind===Kn){const Je=Zt(G,Z,q,J);Je!==void 0&&ue.button===0&&((qe=jn.current)==null?void 0:qe[0])===Z&&((he=jn.current)==null?void 0:he[1])===-1&&(Je.area==="menu"?y==null||y(Z,Je.bounds):Je.area==="indicator"&&(C==null||C(Z,Je.bounds)))}else if(ue.kind===an){const Je=dn(ue.group,ue.bounds,ue.localEventX,ue.localEventY);Je!==void 0&&ue.button===0&&Je.onClick(ue)}},[U,At,Zt,y,C,dn]);Lt("click",un,xt,!1);const Ur=a.useCallback(k=>{const G=ze.current,de=U==null?void 0:U.current;if(G===null||k.target!==G&&k.target!==de||K===void 0)return;const se=At(G,k.clientX,k.clientY,k);K(se,()=>{k.cancelable&&k.preventDefault()})},[U,At,K]);Lt("contextmenu",Ur,(U==null?void 0:U.current)??null,!1);const fn=a.useCallback(k=>{wt.current=new nr(k.map(G=>G.item)),An.current=k,qn.current(),wt.current=void 0},[]),yo=a.useMemo(()=>new Sc(fn),[fn]),No=a.useRef(yo);No.current=yo,a.useLayoutEffect(()=>{const k=No.current;if(In===void 0||In[1]<0){k.setHovered(In);return}const G=w(In,!0),de=tt(G),se=de===void 0&&G.kind===j.Custom||(de==null?void 0:de.needsHover)!==void 0&&(typeof de.needsHover=="boolean"?de.needsHover:de.needsHover(G));k.setHovered(se?In:void 0)},[w,tt,In]);const Xo=a.useRef(),Vr=a.useCallback(k=>{var ue;const G=ze.current;if(G===null)return;const de=U==null?void 0:U.current,se=k.target!==G&&k.target!==de,q=At(G,k.clientX,k.clientY,k);if(q.kind!=="out-of-bounds"&&se&&!wo.current&&!q.isTouch)return;const J=(Z,qe)=>{Rn(he=>he===Z||(he==null?void 0:he[0][0])===(Z==null?void 0:Z[0][0])&&(he==null?void 0:he[0][1])===(Z==null?void 0:Z[0][1])&&((he==null?void 0:he[1][0])===(Z==null?void 0:Z[1][0])&&(he==null?void 0:he[1][1])===(Z==null?void 0:Z[1][1])||!qe)?he:Z)};if(!ts(q,Xo.current))nn(void 0),ce==null||ce(q),J(q.kind===$r?void 0:[q.location,[q.localEventX,q.localEventY]],!0),Xo.current=q;else if(q.kind==="cell"||q.kind===Kn||q.kind===an){let Z=!1,qe=!0;if(q.kind==="cell"){const Je=w(q.location);qe=((ue=tt(Je))==null?void 0:ue.needsHoverPosition)??Je.kind===j.Custom,Z=qe}else Z=!0;const he=[q.location,[q.localEventX,q.localEventY]];J(he,qe),Bn.current=he,Z&&Ln(new nr([q.location]))}const ae=q.location[0]>=(Fe?0:1);Ze(q.kind===Kn&&q.isEdge&&ae&&mt===!0),Gr(q.kind==="cell"&&q.isFillHandle),re==null||re(k),te(q)},[U,At,Fe,mt,re,te,ce,w,tt,Ln]);Lt("mousemove",Vr,xt,!0);const _r=a.useCallback(k=>{const G=ze.current;if(G===null)return;let de,se;A.current!==void 0&&(de=Ht(G,A.current.cell[0],A.current.cell[1]),se=A.current.cell),_==null||_({bounds:de,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:se})},[_,A,Ht]),vn=a.useCallback(k=>{const G=ze.current;if(G===null)return;let de,se;A.current!==void 0&&(de=Ht(G,A.current.cell[0],A.current.cell[1]),se=A.current.cell),V==null||V({bounds:de,stopPropagation:()=>k.stopPropagation(),preventDefault:()=>k.preventDefault(),cancel:()=>{},ctrlKey:k.ctrlKey,metaKey:k.metaKey,shiftKey:k.shiftKey,altKey:k.altKey,key:k.key,keyCode:k.keyCode,rawEvent:k,location:se})},[V,A,Ht]),$n=a.useCallback(k=>{if(ze.current=k,ne!==void 0&&(ne.current=k),k===null)Ct.current=window;else{const G=k.getRootNode();G===document&&(Ct.current=window),Ct.current=G}},[ne]),on=a.useCallback(k=>{const G=ze.current;if(G===null||nt===!1||ke){k.preventDefault();return}let de,se;const q=At(G,k.clientX,k.clientY);if(nt!==!0&&q.kind!==nt){k.preventDefault();return}const J=(Je,Ye)=>{de=Je,se=Ye};let ae,ue,Z;const qe=(Je,Ye,Ee)=>{ae=Je,ue=Ye,Z=Ee};let he=!1;if(be==null||be({...q,setData:J,setDragImage:qe,preventDefault:()=>he=!0,defaultPrevented:()=>he}),!he&&de!==void 0&&se!==void 0&&k.dataTransfer!==null)if(k.dataTransfer.setData(de,se),k.dataTransfer.effectAllowed="copyLink",ae!==void 0&&ue!==void 0&&Z!==void 0)k.dataTransfer.setDragImage(ae,ue,Z);else{const[Je,Ye]=q.location;if(Ye!==void 0){const Ee=document.createElement("canvas"),ot=Ht(G,Je,Ye);Qt(ot!==void 0);const Vt=Math.ceil(window.devicePixelRatio??1);Ee.width=ot.width*Vt,Ee.height=ot.height*Vt;const pt=Ee.getContext("2d");pt!==null&&(pt.scale(Vt,Vt),pt.textBaseline="middle",Ye===-1?(pt.font=Re.headerFontFull,pt.fillStyle=Re.bgHeader,pt.fillRect(0,0,Ee.width,Ee.height),Ql(pt,0,0,ot.width,ot.height,kt[Je],!1,Re,!1,void 0,void 0,!1,0,at,We,!1)):(pt.font=Re.baseFontFull,pt.fillStyle=Re.bgCell,pt.fillRect(0,0,Ee.width,Ee.height),jl(pt,w([Je,Ye]),0,Ye,!1,!1,0,0,ot.width,ot.height,!1,Re,Re.bgCell,Xt,at,1,void 0,!1,0,void 0,void 0,void 0,pn,tt,()=>{}))),Ee.style.left="-100%",Ee.style.position="absolute",Ee.style.width=`${ot.width}px`,Ee.style.height=`${ot.height}px`,document.body.append(Ee),k.dataTransfer.setDragImage(Ee,ot.width/2,ot.height/2),window.setTimeout(()=>{Ee.remove()},0)}}else k.preventDefault()},[nt,ke,At,be,Ht,Re,kt,at,We,w,Xt,pn,tt]);Lt("dragstart",on,(U==null?void 0:U.current)??null,!1,!1);const H=a.useRef(),bt=a.useCallback(k=>{const G=ze.current;if(fe!==void 0&&k.preventDefault(),G===null||Ie===void 0)return;const de=At(G,k.clientX,k.clientY),[se,q]=de.location,J=se-(Fe?0:1),[ae,ue]=H.current??[];(ae!==J||ue!==q)&&(H.current=[J,q],Ie([J,q],k.dataTransfer))},[Fe,At,Ie,fe]);Lt("dragover",bt,(U==null?void 0:U.current)??null,!1,!1);const Zn=a.useCallback(()=>{H.current=void 0,pe==null||pe()},[pe]);Lt("dragend",Zn,(U==null?void 0:U.current)??null,!1,!1);const qr=a.useCallback(k=>{const G=ze.current;if(G===null||fe===void 0)return;k.preventDefault();const de=At(G,k.clientX,k.clientY),[se,q]=de.location,J=se-(Fe?0:1);fe([J,q],k.dataTransfer)},[Fe,At,fe]);Lt("drop",qr,(U==null?void 0:U.current)??null,!1,!1);const hr=a.useCallback(()=>{Ne==null||Ne()},[Ne]);Lt("dragleave",hr,(U==null?void 0:U.current)??null,!1,!1);const gr=a.useRef(A);gr.current=A;const bo=a.useRef(null),mr=a.useCallback(k=>{var G;ze.current===null||!ze.current.contains(document.activeElement)||(k===null&&gr.current.current!==void 0?(G=ne==null?void 0:ne.current)==null||G.focus({preventScroll:!0}):k!==null&&k.focus({preventScroll:!0}),bo.current=k)},[ne]);a.useImperativeHandle(t,()=>({focus:()=>{var G;const k=bo.current;k===null||!document.contains(k)?(G=ne==null?void 0:ne.current)==null||G.focus({preventScroll:!0}):k.focus({preventScroll:!0})},getBounds:(k,G)=>{if(!(ne===void 0||ne.current===null))return Ht(ne.current,k??0,G??-1)},damage:dr}),[ne,dr,Ht]);const B=a.useRef(),$t=Zs(()=>{var ue,Z,qe;if(n<50||(He==null?void 0:He.disableAccessibilityTree)===!0)return null;let k=bi(kt,Xe,n,Ce,Ke);const G=Fe?0:-1;!Fe&&((ue=k[0])==null?void 0:ue.sourceIndex)===0&&(k=k.slice(1));const[de,se]=((Z=A.current)==null?void 0:Z.cell)??[],q=(qe=A.current)==null?void 0:qe.range,J=k.map(he=>he.sourceIndex),ae=io(s,Math.min(g,s+r));return de!==void 0&&se!==void 0&&!(J.includes(de)&&ae.includes(se))&&mr(null),a.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":g+1,"aria-multiselectable":"true","aria-colcount":kt.length+G},a.createElement("thead",{role:"rowgroup"},a.createElement("tr",{role:"row","aria-rowindex":1},k.map(he=>a.createElement("th",{role:"columnheader","aria-selected":A.columns.hasIndex(he.sourceIndex),"aria-colindex":he.sourceIndex+1+G,tabIndex:-1,onFocus:Je=>{if(Je.target!==bo.current)return De==null?void 0:De([he.sourceIndex,-1])},key:he.sourceIndex},he.title)))),a.createElement("tbody",{role:"rowgroup"},ae.map(he=>a.createElement("tr",{role:"row","aria-selected":A.rows.hasIndex(he),key:he,"aria-rowindex":he+2},k.map(Je=>{const Ye=Je.sourceIndex,Ee=bn(Ye,he),ot=de===Ye&&se===he,Vt=q!==void 0&&Ye>=q.x&&Ye<q.x+q.width&&he>=q.y&&he<q.y+q.height,pt=`glide-cell-${Ye}-${he}`,Yt=[Ye,he],hn=w(Yt,!0);return a.createElement("td",{key:Ee,role:"gridcell","aria-colindex":Ye+1+G,"aria-selected":Vt,"aria-readonly":Do(hn)||!Qo(hn),id:pt,"data-testid":pt,onClick:()=>{const _t=ne==null?void 0:ne.current;if(_t!=null)return _==null?void 0:_({bounds:Ht(_t,Ye,he),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:Yt})},onFocusCapture:_t=>{var ge,ht;if(!(_t.target===bo.current||((ge=B.current)==null?void 0:ge[0])===Ye&&((ht=B.current)==null?void 0:ht[1])===he))return B.current=Yt,De==null?void 0:De(Yt)},ref:ot?mr:void 0,tabIndex:-1},Ic(hn,tt))})))))},[n,kt,Xe,Ce,Ke,g,s,r,A,mr,w,ne,_,Ht,De],200),St=z===0||!$?0:Xe>z?1:sn(-Ke/100,0,1),jr=-s*32+ft,po=W?sn(-jr/100,0,1):0,vo=a.useMemo(()=>{if(!St&&!po)return null;const k={position:"absolute",top:0,left:Ft,width:n-Ft,height:o,opacity:St,pointerEvents:"none",transition:_e?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},G={position:"absolute",top:Pt,left:0,width:n,height:o,opacity:po,pointerEvents:"none",transition:oe?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return a.createElement(a.Fragment,null,St>0&&a.createElement("div",{id:"shadow-x",style:k}),po>0&&a.createElement("div",{id:"shadow-y",style:G}))},[St,po,Ft,n,_e,Pt,o,oe]),Ut=a.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return a.createElement(a.Fragment,null,a.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:_r,onKeyUp:vn,onFocus:I,onBlur:X,ref:$n,style:go},$t),a.createElement("canvas",{ref:zt,style:Ut}),vo)},Fc=a.memo(a.forwardRef(Dc));function Jo(e,t,n,o){return sn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Hc=e=>{const[t,n]=a.useState(),[o,r]=a.useState(),[i,l]=a.useState(),[s,c]=a.useState(),[u,f]=a.useState(!1),[m,g]=a.useState(),[w,h]=a.useState(),[y,C]=a.useState(),[x,v]=a.useState(!1),[I,X]=a.useState(),{onHeaderMenuClick:N,onHeaderIndicatorClick:A,getCellContent:z,onColumnMoved:K,onColumnResize:S,onColumnResizeStart:$,onColumnResizeEnd:W,gridRef:D,maxColumnWidth:R,minColumnWidth:M,onRowMoved:re,lockColumns:te,onColumnProposeMove:ce,onMouseDown:Ce,onMouseUp:Fe,onItemHovered:_,onDragStart:V,canvasRef:xe}=e,ne=(S??W??$)!==void 0,{columns:be,selection:pe}=e,U=pe.columns,ke=a.useCallback(ie=>{const[We,De]=ie.location;i!==void 0&&s!==We&&We>=te?(f(!0),c(We)):w!==void 0&&De!==void 0?(v(!0),C(Math.max(0,De))):o===void 0&&!u&&!x&&(_==null||_(ie))},[i,w,s,_,te,o,u,x]),ve=K!==void 0,je=a.useCallback(ie=>{var We;if(ie.button===0){const[De,Ie]=ie.location;if(ie.kind==="out-of-bounds"&&ie.isEdge&&ne){const fe=(We=D==null?void 0:D.current)==null?void 0:We.getBounds(be.length-1,-1);fe!==void 0&&(n(fe.x),r(be.length-1))}else if(ie.kind==="header"&&De>=te){const fe=xe==null?void 0:xe.current;if(ie.isEdge&&ne&&fe){n(ie.bounds.x),r(De);const Te=fe.getBoundingClientRect().width/fe.offsetWidth,_e=ie.bounds.width/Te;$==null||$(be[De],_e,De,_e+(be[De].growOffset??0))}else ie.kind==="header"&&ve&&(g(ie.bounds.x),l(De))}else ie.kind==="cell"&&te>0&&De===0&&Ie!==void 0&&re!==void 0&&(X(ie.bounds.y),h(Ie))}Ce==null||Ce(ie)},[Ce,ne,te,re,D,be,ve,$,xe]),nt=a.useCallback((ie,We)=>{u||x||N==null||N(ie,We)},[u,x,N]),mt=a.useCallback((ie,We)=>{u||x||A==null||A(ie,We)},[u,x,A]),et=a.useRef(-1),Ae=a.useCallback(()=>{et.current=-1,h(void 0),C(void 0),X(void 0),v(!1),l(void 0),c(void 0),g(void 0),f(!1),r(void 0),n(void 0)},[]),Ve=a.useCallback((ie,We)=>{if(ie.button===0){if(o!==void 0){if((U==null?void 0:U.hasIndex(o))===!0)for(const Ie of U){if(Ie===o)continue;const fe=be[Ie],Ne=Jo(fe,et.current,M,R);S==null||S(fe,Ne,Ie,Ne+(fe.growOffset??0))}const De=Jo(be[o],et.current,M,R);if(W==null||W(be[o],De,o,De+(be[o].growOffset??0)),U.hasIndex(o))for(const Ie of U){if(Ie===o)continue;const fe=be[Ie],Ne=Jo(fe,et.current,M,R);W==null||W(fe,Ne,Ie,Ne+(fe.growOffset??0))}}Ae(),i!==void 0&&s!==void 0&&(K==null||K(i,s)),w!==void 0&&y!==void 0&&(re==null||re(w,y))}Fe==null||Fe(ie,We)},[Fe,o,i,s,w,y,U,W,be,M,R,S,K,re,Ae]),Re=a.useMemo(()=>{if(!(i===void 0||s===void 0)&&i!==s&&(ce==null?void 0:ce(i,s))!==!1)return{src:i,dest:s}},[i,s,ce]),ut=a.useCallback(ie=>{const We=xe==null?void 0:xe.current;if(i!==void 0&&m!==void 0)Math.abs(ie.clientX-m)>20&&f(!0);else if(w!==void 0&&I!==void 0)Math.abs(ie.clientY-I)>20&&v(!0);else if(o!==void 0&&t!==void 0&&We){const Ie=We.getBoundingClientRect().width/We.offsetWidth,fe=(ie.clientX-t)/Ie,Ne=be[o],Te=Jo(Ne,fe,M,R);if(S==null||S(Ne,Te,o,Te+(Ne.growOffset??0)),et.current=fe,(U==null?void 0:U.first())===o)for(const _e of U){if(_e===o)continue;const oe=be[_e],He=Jo(oe,et.current,M,R);S==null||S(oe,He,_e,He+(oe.growOffset??0))}}},[i,m,w,I,o,t,be,M,R,S,U,xe]),rt=a.useCallback((ie,We)=>{if(w===void 0||y===void 0)return z(ie,We);let[De,Ie]=ie;return Ie===y?Ie=w:(Ie>y&&(Ie-=1),Ie>=w&&(Ie+=1)),z([De,Ie],We)},[w,y,z]),it=a.useCallback(ie=>{V==null||V(ie),ie.defaultPrevented()||Ae()},[Ae,V]);return a.createElement(Fc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:rt,isResizing:o!==void 0,onHeaderMenuClick:nt,onHeaderIndicatorClick:mt,isDragging:u,onItemHovered:ke,onDragStart:it,onMouseDown:je,allowResize:ne,onMouseUp:Ve,dragAndDropState:Re,onMouseMoveRaw:ut,ref:D})},Tc=Hc;function Ac(e){const t=a.useRef(null),[n,o]=a.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return a.useLayoutEffect(()=>{const r=l=>{for(const s of l){const{width:c,height:u}=s&&s.contentRect||{};o(f=>f.width===c&&f.height===u?f:{width:c,height:u})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const zc=(e,t,n)=>{const o=a.useRef(null),r=a.useRef(null),i=a.useRef(null),l=a.useRef(0),s=a.useRef(t);s.current=t;const c=n.current;a.useEffect(()=>{const u=()=>{var g,w;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((g=i.current)==null?void 0:g[0])===h[0]&&((w=i.current)==null?void 0:w[1])===h[1])if(l.current>10){i.current=null,r.current=null;return}else l.current++;else l.current=0,s.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(u,8.333333333333334)}},f=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},m=g=>{g.touches.length===0&&(r.current=!1,l.current=0,o.current=window.setTimeout(u,8.333333333333334))};if(e&&c!==null){const g=c;return g.addEventListener("touchstart",f),g.addEventListener("touchend",m),()=>{g.removeEventListener("touchstart",f),g.removeEventListener("touchend",m),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},Bc=zc,Lc=()=>e=>e.isSafari?"scroll":"auto",Pc=tn("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Lc()]}});function Wc(e){const[t,n]=a.useState(!1),o=typeof window>"u"?null:window,r=a.useRef(0);return Lt("touchstart",a.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Lt("touchend",a.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const $c=e=>{var ne,be;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:l,className:s,preventDiagonalScrolling:c=!1,paddingBottom:u=0,paddingRight:f=0,rightElement:m,rightElementProps:g,kineticScrollPerfHack:w=!1,scrollRef:h,initialSize:y}=e,C=[],x=(g==null?void 0:g.sticky)??!1,v=(g==null?void 0:g.fill)??!1,I=a.useRef(0),X=a.useRef(0),N=a.useRef(null),A=typeof window>"u"?1:window.devicePixelRatio,z=a.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),K=a.useRef(null),S=Wc(200),[$,W]=a.useState(!0),D=a.useRef(0);a.useLayoutEffect(()=>{if(!$||S||z.current.lockDirection===void 0)return;const pe=N.current;if(pe===null)return;const[U,ke]=z.current.lockDirection;U!==void 0?pe.scrollLeft=U:ke!==void 0&&(pe.scrollTop=ke),z.current.lockDirection=void 0},[S,$]);const R=a.useCallback((pe,U)=>{var it;const ke=N.current;if(ke===null)return;U=U??ke.scrollTop,pe=pe??ke.scrollLeft;const ve=z.current.scrollTop,je=z.current.scrollLeft,nt=pe-je,mt=U-ve;S&&nt!==0&&mt!==0&&(Math.abs(nt)>3||Math.abs(mt)>3)&&c&&z.current.lockDirection===void 0&&(z.current.lockDirection=Math.abs(nt)<Math.abs(mt)?[je,void 0]:[void 0,ve]);const et=z.current.lockDirection;pe=(et==null?void 0:et[0])??pe,U=(et==null?void 0:et[1])??U,z.current.scrollLeft=pe,z.current.scrollTop=U;const Ae=ke.clientWidth,Ve=ke.clientHeight,Re=U,ut=X.current-Re,rt=ke.scrollHeight-Ve;if(X.current=Re,rt>0&&(Math.abs(ut)>2e3||Re===0||Re===rt)&&o>ke.scrollHeight+5){const ie=Re/rt,We=(o-Ve)*ie;I.current=We-Re}et!==void 0&&(window.clearTimeout(D.current),W(!1),D.current=window.setTimeout(()=>W(!0),200)),i({x:pe,y:Re+I.current,width:Ae-f,height:Ve-u,paddingRight:((it=K.current)==null?void 0:it.clientWidth)??0})},[u,f,o,i,c,S]);Bc(w&&Pr.value,R,N);const M=a.useRef(R);M.current=R;const re=a.useRef(),te=a.useRef(!1);a.useLayoutEffect(()=>{te.current?R():te.current=!0},[R,u,f]);const ce=a.useCallback(pe=>{N.current=pe,h!==void 0&&(h.current=pe)},[h]);let Ce=0,Fe=0;for(C.push(a.createElement("div",{key:Ce++,style:{width:r,height:0}}));Fe<o;){const pe=Math.min(5e6,o-Fe);C.push(a.createElement("div",{key:Ce++,style:{width:0,height:pe}})),Fe+=pe}const{ref:_,width:V,height:xe}=Ac(y);return typeof window<"u"&&(((ne=re.current)==null?void 0:ne.height)!==xe||((be=re.current)==null?void 0:be.width)!==V)&&(window.setTimeout(()=>M.current(),0),re.current={width:V,height:xe}),(V??0)===0||(xe??0)===0?a.createElement("div",{ref:_}):a.createElement("div",{ref:_},a.createElement(Pc,{isSafari:Pr.value},a.createElement("div",{className:"dvn-underlay"},t),a.createElement("div",{ref:ce,style:re.current,draggable:l,onDragStart:pe=>{l||(pe.stopPropagation(),pe.preventDefault())},className:"dvn-scroller "+(s??""),onScroll:()=>R()},a.createElement("div",{className:"dvn-scroll-inner"+(m===void 0?" dvn-hidden":"")},a.createElement("div",{className:"dvn-stack"},C),m!==void 0&&a.createElement(a.Fragment,null,!v&&a.createElement("div",{className:"dvn-spacer"}),a.createElement("div",{ref:K,style:{height:xe,maxHeight:n-Math.ceil(A%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:f,flexGrow:v?1:void 0,right:x?f??0:void 0,pointerEvents:"auto"}},m))))))},Oc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:l,freezeColumns:s,experimental:c,nonGrowWidth:u,clientSize:f,className:m,onVisibleRegionChanged:g,scrollRef:w,preventDiagonalScrolling:h,rightElement:y,rightElementProps:C,overscrollX:x,overscrollY:v,initialSize:I,smoothScrollX:X=!1,smoothScrollY:N=!1,isDraggable:A}=e,{paddingRight:z,paddingBottom:K}=c??{},[S,$]=f,W=a.useRef(),D=a.useRef(),R=a.useRef(),M=a.useRef(),re=u+Math.max(0,x??0);let te=l?r+i:r;if(typeof o=="number")te+=n*o;else for(let _=0;_<n;_++)te+=o(_);v!==void 0&&(te+=v);const ce=a.useRef(),Ce=a.useCallback(()=>{var mt,et;if(ce.current===void 0)return;const _={...ce.current};let V=0,xe=_.x<0?-_.x:0,ne=0,be=0;_.x=_.x<0?0:_.x;let pe=0;for(let Ae=0;Ae<s;Ae++)pe+=t[Ae].width;for(const Ae of t){const Ve=V-pe;if(_.x>=Ve+Ae.width)V+=Ae.width,be++,ne++;else if(_.x>Ve)V+=Ae.width,X?xe+=Ve-_.x:be++,ne++;else if(_.x+_.width>Ve)V+=Ae.width,ne++;else break}let U=0,ke=0,ve=0;if(typeof o=="number")N?(ke=Math.floor(_.y/o),U=ke*o-_.y):ke=Math.ceil(_.y/o),ve=Math.ceil(_.height/o)+ke,U<0&&ve++;else{let Ae=0;for(let Ve=0;Ve<n;Ve++){const Re=o(Ve),ut=Ae+(N?0:Re/2);if(_.y>=Ae+Re)Ae+=Re,ke++,ve++;else if(_.y>ut)Ae+=Re,N?U+=ut-_.y:ke++,ve++;else if(_.y+_.height>Re/2+Ae)Ae+=Re,ve++;else break}}const je={x:be,y:ke,width:ne-be,height:ve-ke},nt=W.current;(nt===void 0||nt.y!==je.y||nt.x!==je.x||nt.height!==je.height||nt.width!==je.width||D.current!==xe||R.current!==U||_.width!==((mt=M.current)==null?void 0:mt[0])||_.height!==((et=M.current)==null?void 0:et[1]))&&(g==null||g({x:be,y:ke,width:ne-be,height:ve-ke},_.width,_.height,_.paddingRight??0,xe,U),W.current=je,D.current=xe,R.current=U,M.current=[_.width,_.height])},[t,o,n,g,s,X,N]),Fe=a.useCallback(_=>{ce.current=_,Ce()},[Ce]);return a.useEffect(()=>{Ce()},[Ce]),a.createElement($c,{scrollRef:w,className:m,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:A===!0||typeof A=="string",scrollWidth:re+(z??0),scrollHeight:te+(K??0),clientHeight:$,rightElement:y,paddingBottom:K,paddingRight:z,rightElementProps:C,update:Fe,initialSize:I},a.createElement(Tc,{eventTargetRef:w,width:S,height:$,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Nc=Oc,Xc=tn("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Yc=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Gc=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Kc=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Uc=10,Vc=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:l,searchResults:s,onSearchValueChange:c,getCellsForSelection:u,onSearchResultsChanged:f,showSearch:m=!1,onSearchClose:g}=e,[w]=a.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,y]=a.useState(""),C=l??h,x=a.useCallback(V=>{y(V),c==null||c(V)},[c]),[v,I]=a.useState(),X=a.useRef(v);X.current=v,a.useEffect(()=>{s!==void 0&&(s.length>0?I(V=>({rowsSearched:o,results:s.length,selectedIndex:(V==null?void 0:V.selectedIndex)??-1})):I(void 0))},[o,s]);const N=a.useRef();N.current===void 0&&(N.current=new AbortController);const A=a.useRef(),[z,K]=a.useState([]),S=s??z,$=a.useCallback(()=>{A.current!==void 0&&(window.cancelAnimationFrame(A.current),A.current=void 0,N.current.abort())},[]),W=a.useRef(n);W.current=n;const D=a.useCallback(V=>{const xe=new RegExp(V.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ne=W.current,be=Math.min(10,o),pe=0;I(void 0),K([]);const U=[],ke=async()=>{var rt;if(u===void 0)return;const ve=performance.now(),je=o-pe;let nt=u({x:0,y:ne,width:r.length,height:Math.min(be,je,o-ne)},N.current.signal);typeof nt=="function"&&(nt=await nt());let mt=!1;for(const[it,ie]of nt.entries())for(const[We,De]of ie.entries()){let Ie;switch(De.kind){case j.Text:case j.Number:Ie=De.displayData;break;case j.Uri:case j.Markdown:Ie=De.data;break;case j.Boolean:Ie=typeof De.data=="boolean"?De.data.toString():void 0;break;case j.Image:case j.Bubble:Ie=De.data.join("🐳");break;case j.Custom:Ie=De.copyData;break}Ie!==void 0&&xe.test(Ie)&&(U.push([We,it+ne]),mt=!0)}const et=performance.now();mt&&K([...U]),pe+=nt.length,Qt(pe<=o);const Ae=((rt=X.current)==null?void 0:rt.selectedIndex)??-1;I({results:U.length,rowsSearched:pe,selectedIndex:Ae}),f==null||f(U,Ae),ne+be>=o?ne=0:ne+=be;const Ve=et-ve,Re=Math.max(Ve,1),ut=Uc/Re;be=Math.ceil(be*ut),pe<o&&U.length<1e3&&(A.current=window.requestAnimationFrame(ke))};$(),A.current=window.requestAnimationFrame(ke)},[$,r.length,u,f,o]),R=a.useCallback(()=>{var V;g==null||g(),I(void 0),K([]),f==null||f([],-1),$(),(V=t==null?void 0:t.current)==null||V.focus()},[$,t,g,f]),M=a.useCallback(V=>{x(V.target.value),s===void 0&&(V.target.value===""?(I(void 0),K([]),$()):D(V.target.value))},[D,$,x,s]);a.useEffect(()=>{m&&i.current!==null&&(x(""),i.current.focus({preventScroll:!0}))},[m,i,x]);const re=a.useCallback(V=>{var ne;if((ne=V==null?void 0:V.stopPropagation)==null||ne.call(V),v===void 0)return;const xe=(v.selectedIndex+1)%v.results;I({...v,selectedIndex:xe}),f==null||f(S,xe)},[v,f,S]),te=a.useCallback(V=>{var ne;if((ne=V==null?void 0:V.stopPropagation)==null||ne.call(V),v===void 0)return;let xe=(v.selectedIndex-1)%v.results;xe<0&&(xe+=v.results),I({...v,selectedIndex:xe}),f==null||f(S,xe)},[f,S,v]),ce=a.useCallback(V=>{(V.ctrlKey||V.metaKey)&&V.nativeEvent.code==="KeyF"||V.key==="Escape"?(R(),V.stopPropagation(),V.preventDefault()):V.key==="Enter"&&(V.shiftKey?te():re())},[R,re,te]);a.useEffect(()=>()=>{$()},[$]);const[Ce,Fe]=a.useState(!1);a.useEffect(()=>{if(m)Fe(!0);else{const V=setTimeout(()=>Fe(!1),150);return()=>clearTimeout(V)}},[m]);const _=a.useMemo(()=>{if(!m&&!Ce)return null;let V;v!==void 0&&(V=v.results>=1e3?"over 1000":`${v.results} result${v.results!==1?"s":""}`,v.selectedIndex>=0&&(V=`${v.selectedIndex+1} of ${V}`));const xe=pe=>{pe.stopPropagation()},be={width:`${Math.floor(((v==null?void 0:v.rowsSearched)??0)/o*100)}%`};return a.createElement(Xc,{className:m?"":"out",onMouseDown:xe,onMouseMove:xe,onMouseUp:xe,onClick:xe},a.createElement("div",{className:"gdg-search-bar-inner"},a.createElement("input",{id:w,"aria-hidden":!m,"data-testid":"search-input",ref:i,onChange:M,value:C,tabIndex:m?void 0:-1,onKeyDownCapture:ce}),a.createElement("button",{"aria-label":"Previous Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:te,disabled:((v==null?void 0:v.results)??0)===0},Yc),a.createElement("button",{"aria-label":"Next Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:re,disabled:((v==null?void 0:v.results)??0)===0},Gc),g!==void 0&&a.createElement("button",{"aria-label":"Close Search","aria-hidden":!m,"data-testid":"search-close-button",tabIndex:m?void 0:-1,onClick:R},Kc)),v!==void 0?a.createElement(a.Fragment,null,a.createElement("div",{className:"gdg-search-status"},a.createElement("div",{"data-testid":"search-result-area"},V)),a.createElement("div",{className:"gdg-search-progress",style:be})):a.createElement("div",{className:"gdg-search-status"},a.createElement("label",{htmlFor:w},"Type to search")))},[m,Ce,v,o,w,i,M,C,ce,te,re,g,R]);return a.createElement(a.Fragment,null,a.createElement(Nc,{prelightCells:S,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),_)},_c=Vc;class qc extends a.PureComponent{constructor(){super(...arguments);Oe(this,"wrapperRef",a.createRef());Oe(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){document.addEventListener("touchend",this.clickOutside,!0),document.addEventListener("mousedown",this.clickOutside,!0),document.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){document.removeEventListener("touchend",this.clickOutside,!0),document.removeEventListener("mousedown",this.clickOutside,!0),document.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,...r}=this.props;return a.createElement("div",{...r,ref:this.wrapperRef},this.props.children)}}const jc=()=>e=>Math.max(16,e.targetHeight-10),Zc=tn("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[jc(),"px"]}}),Jc=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[l,s]=vt.useState(n);return vt.createElement(qc,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},vt.createElement(Zc,{targetHeight:t.height,"data-testid":"group-rename-input",value:l,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,l.length),onChange:c=>s(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(l):c.key==="Escape"&&o()},autoFocus:!0}))};function Qc(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Be(e,t,n){const o=ns(e,t);return o&&(n.didMatch=!0),o}function ns(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const u of c)if(ns(u,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const l=e.split("+"),s=l.pop();if(!Qc(s,t))return!1;if(l[0]==="any")return!0;for(const c of l)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Wr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function ed(e,t,n,o,r,i){const l=vt.useCallback((u,f,m,g)=>{var v;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}});const w=n==="mixed"&&(m||g==="drag"),h=o==="mixed"&&w,y=r==="mixed"&&w;let C={current:u===void 0?void 0:{...u,rangeStack:g==="drag"?((v=e.current)==null?void 0:v.rangeStack)??[]:[]},columns:h?e.columns:st.empty(),rows:y?e.rows:st.empty()};m&&(i==="multi-rect"||i==="multi-cell")&&C.current!==void 0&&e.current!==void 0&&(C={...C,current:{...C.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(C,f)},[o,e,n,i,r,t]),s=vt.useCallback((u,f,m)=>{u=u??e.rows,f!==void 0&&(u=u.add(f));let g;if(r==="exclusive"&&u.length>0)g={current:void 0,columns:st.empty(),rows:u};else{const w=m&&n==="mixed",h=m&&o==="mixed";g={current:w?e.current:void 0,columns:h?e.columns:st.empty(),rows:u}}t(g,!1)},[o,e,n,r,t]),c=vt.useCallback((u,f,m)=>{u=u??e.columns,f!==void 0&&(u=u.add(f));let g;if(o==="exclusive"&&u.length>0)g={current:void 0,rows:st.empty(),columns:u};else{const w=m&&n==="mixed",h=m&&r==="mixed";g={current:w?e.current:void 0,rows:h?e.rows:st.empty(),columns:u}}t(g,!1)},[o,e,n,r,t]);return[l,s,c]}function td(e,t,n,o,r){const i=a.useCallback(u=>{if(e===!0){const f=[];for(let m=u.y;m<u.y+u.height;m++){const g=[];for(let w=u.x;w<u.x+u.width;w++)w<0||m>=r?g.push({kind:j.Loading,allowOverlay:!1}):g.push(t([w,m]));f.push(g)}return f}return(e==null?void 0:e(u,o.signal))??[]},[o.signal,t,e,r]),l=e!==void 0?i:void 0,s=a.useCallback(u=>{if(l===void 0)return[];const f={...u,x:u.x-n};if(f.x<0){f.x=0,f.width--;const m=l(f,o.signal);return typeof m=="function"?async()=>(await m()).map(g=>[{kind:j.Loading,allowOverlay:!1},...g]):m.map(g=>[{kind:j.Loading,allowOverlay:!1},...g])}return l(f,o.signal)},[o.signal,l,n]);return[e!==void 0?s:void 0,l]}function nd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string"};switch(e.kind){case j.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===xi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case j.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case j.Image:case j.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case j.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case j.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case j.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case j.Markdown:case j.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case j.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case j.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case j.Protected:return{formatted:"************",rawValue:"",format:"string"};default:or()}}function od(e,t){return e.map((o,r)=>{const i=t[r];return o.map(l=>l.span!==void 0&&l.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:nd(l))})}function gl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function rd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(l=>gl(l,!0)).join(",")):r.push(gl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function fi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function ml(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function id(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function ld(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${fi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((l,s)=>`<li gdg-raw-value=${ml(r.rawValue[s])}>`+fi(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${ml(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${fi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function sd(e,t){const n=od(e,t),o=rd(n),r=ld(n);return{textPlain:o,textHtml:r}}function wl(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const c=s.cloneNode(!0),f=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,m=(f==null?void 0:f.children.length)===1&&f.children[0].nodeName==="FONT",g=c.querySelectorAll("br");for(const y of g)y.replaceWith(`
`);const w=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((l=c.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const y=c.querySelectorAll("li");i==null||i.push({rawValue:[...y].map(C=>C.getAttribute("gdg-raw-value")??""),formatted:[...y].map(C=>C.textContent??""),format:"string-array"})}else if(w!==null)i==null||i.push({rawValue:id(w),formatted:c.textContent??"",format:h});else{let y=c.textContent??"";m&&(y=y.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:y??"",formatted:y??"",format:h})}}}return i!==void 0&&r.push(i),r}function ad(e,t,n,o,r){var s;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(s=e.current)==null?void 0:s.range,u=[];if(c.width>2){const g=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof g=="function")return i;u.push(...g);const w=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof w=="function")return i;u.push(...w)}else{const g=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof g=="function")return i;u.push(...g)}let f=c.x-n,m=c.x+c.width-1-n;for(const g of u)for(const w of g)w.span!==void 0&&(f=Math.min(w.span[0],f),m=Math.max(w.span[1],m));f===c.x-n&&m===c.x+c.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:f+n,y:c.y,width:m-f+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function yl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function cd(e){let t;(function(s){s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(i){case t.None:s==="	"||s===`
`?(o.push(e.slice(r,l)),r=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(i=t.inString);break;case t.inString:s==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:s==='"'?i=t.inString:((s==="	"||s===`
`)&&(o.push(yl(e.slice(r,l))),r=l+1,s===`
`&&(n.push(o),o=[])),i=t.None);break}l++}return r<e.length&&o.push(yl(e.slice(r,e.length))),n.push(o),n.map(s=>s.map(c=>({rawValue:c,formatted:c,format:"string"})))}function bl(e,t,n){var s;const o=sd(e,t),r=c=>{var u;(u=window.navigator.clipboard)==null||u.writeText(c)},i=(c,u)=>{var f;return((f=window.navigator.clipboard)==null?void 0:f.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([u],{type:"text/html"})})]),!0)},l=(c,u)=>{var f,m;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(f=n==null?void 0:n.clipboardData)==null||f.setData("text/plain",c),(m=n==null?void 0:n.clipboardData)==null||m.setData("text/html",u)}catch{i(c,u)||r(c)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function os(e){return e!==!0}function pl(e){return typeof e=="string"?e:`${e}px`}const dd=()=>e=>e.innerWidth,ud=()=>e=>e.innerHeight,fd=tn("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[dd()],"wmyidgi-1":[ud()]}}),hd=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return a.createElement(fd,{innerHeight:pl(n),innerWidth:pl(t),...r},o)},gd=2,md=1300;function wd(e,t,n){const o=vt.useRef(0),[r,i]=e??[0,0];vt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let l=!1,s=0;const c=u=>{var f;if(!l){if(s===0)s=u;else{const m=u-s;o.current=Math.min(1,o.current+m/md);const g=o.current**1.618*m*gd;(f=t.current)==null||f.scrollBy(r*g,i*g),s=u,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{l=!0}},[t,r,i,n])}function yd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:l,remSize:s}){const[c,u,f,m,g,w]=vt.useMemo(()=>{if(!l||s===16)return[e,t,n,o,r,i];const h=s/16,y=e,C=Xl();return[typeof y=="number"?y*h:x=>Math.ceil(y(x)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??C.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??C.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??C.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,s,e,l,o]);return{rowHeight:c,headerHeight:u,groupHeaderHeight:f,theme:m,overscrollX:g,overscrollY:w}}const Gn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Le(e,t){return e===!0?t:e===!1?"":e}function vl(e){const t=Wr.value;return{activateCell:Le(e.activateCell," |Enter|shift+Enter"),clear:Le(e.clear,"any+Escape"),closeOverlay:Le(e.closeOverlay,"any+Escape"),acceptOverlayDown:Le(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Le(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Le(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Le(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Le(e.delete,t?"Backspace|Delete":"Delete"),downFill:Le(e.downFill,"primary+_68"),scrollToSelectedCell:Le(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Le(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Le(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Le(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Le(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Le(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Le(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Le(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Le(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Le(e.goToFirstCell,"primary+Home"),goToFirstColumn:Le(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Le(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Le(e.goToLastCell,"primary+End"),goToLastColumn:Le(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Le(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Le(e.goToNextPage,"PageDown"),goToPreviousPage:Le(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Le(e.rightFill,"primary+_82"),search:Le(e.search,"primary+f"),selectAll:Le(e.selectAll,"primary+a"),selectColumn:Le(e.selectColumn,"ctrl+ "),selectGrowDown:Le(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Le(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Le(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Le(e.selectGrowUp,"shift+ArrowUp"),selectRow:Le(e.selectRow,"shift+ "),selectToFirstCell:Le(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Le(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Le(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Le(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Le(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Le(e.selectToLastRow,"primary+shift+ArrowDown")}}function bd(e){const t=na(e);return vt.useMemo(()=>{if(t===void 0)return vl(Gn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??Gn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??Gn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??Gn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??Gn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??Gn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??Gn.selectToLastCell};return vl({...Gn,...n})},[t])}function pd(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const l={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(l.subGroups=o.subGroups.map((s,c)=>t(s,r+1,[...i,c])).sort((s,c)=>s.headerIndex-c.headerIndex)),l}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Fi(e,t){const n=[];function o(l,s,c=!1){let u=s!==null?s-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({headerIndex:l.headerIndex,contentIndex:-1,skip:c,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let f=0;f<l.subGroups.length;f++){const m=f<l.subGroups.length-1?l.subGroups[f+1].headerIndex:s;o(l.subGroups[f],m,c||l.isCollapsed)}}const r=pd(e.groups);for(let l=0;l<r.length;l++){const s=l<r.length-1?r[l+1].headerIndex:null;o(r[l],s)}let i=0;for(const l of n)l.contentIndex=i,i+=l.rows;return n.filter(l=>l.skip===!1).map(l=>{const{skip:s,...c}=l;return c})}function Or(e,t){if(t===void 0||Fi.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(n--,!o.isCollapsed){if(n<o.rows)return{path:[...o.path,n],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n,contentIndex:o.contentIndex+n,groupRows:o.rows};n-=o.rows}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function vd(e,t,n,o){const r=vt.useMemo(()=>e===void 0?void 0:Fi(e,t),[e,t]),i=vt.useMemo(()=>r===void 0?t:r.reduce((u,f)=>u+(f.isCollapsed?1:f.rows+1),0),[r,t]),l=vt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>{const{isGroupHeader:f}=Or(u,r);return f?e.height:typeof n=="number"?n:n(u)},[r,e,n]),s=vt.useCallback(u=>{if(r===void 0)return u;let f=u;for(const m of r){if(f===0)return;if(f--,!m.isCollapsed){if(f<m.rows)return m.contentIndex+f;f-=m.rows}}return u},[r]),c=ro(o??(e==null?void 0:e.themeOverride),vt.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:f,contentIndex:m,groupIndex:g}=Or(u,r);return f?e.themeOverride:o==null?void 0:o(u,g,m)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:s,getRowThemeOverride:c}:{rowHeight:l,rows:i,rowNumberMapper:s,getRowThemeOverride:c}}function Cd(e,t){const n=vt.useMemo(()=>e===void 0?void 0:Fi(e,t),[e,t]);return{getRowGroupingForPath:is,updateRowGroupingByPath:rs,mapper:vt.useCallback(o=>{if(typeof o=="number")return Or(o,n);const r=Or(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function rs(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,l)=>l===o?{...i,...n}:i):e.map((i,l)=>l===o?{...i,subGroups:rs(i.subGroups??[],r,n)}:i)}function is(e,t){const[n,...o]=t;return o[0]===-1?e[n]:is(e[n].subGroups??[],o)}function xd(e,t){const[n]=a.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function kd(e,t,n,o,r){const[i,l]=a.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),s=a.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:l}),[o,l,i]),[c,u,f]=ta(s),m=a.useRef(r);m.current=r;const g=xd(null,y=>{y!==null&&t!==void 0?y.scrollTop=t:y!==null&&e!==void 0&&(y.scrollLeft=e)}),w=(c.height??1)>1;a.useLayoutEffect(()=>{if(t!==void 0&&g.current!==null&&w){if(g.current.scrollTop===t)return;g.current.scrollTop=t,g.current.scrollTop!==t&&f(),m.current()}},[t,w,f,g]);const h=(c.width??1)>1;return a.useLayoutEffect(()=>{if(e!==void 0&&g.current!==null&&h){if(g.current.scrollLeft===e)return;g.current.scrollLeft=e,g.current.scrollLeft!==e&&f(),m.current()}},[e,h,f,g]),{visibleRegion:c,setVisibleRegion:u,scrollRef:g}}const Sd=a.lazy(async()=>await Sl(()=>import("./data-grid-overlay-editor-K62UQj4H.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url));let Md=0;function Rd(e){return Ys(qi(qi(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return io((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Hr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Tr={kind:j.Loading,allowOverlay:!1},Ar={columns:st.empty(),rows:st.empty(),current:void 0},Ed=(e,t)=>{var Ui,Vi,_i;const[n,o]=a.useState(Ar),[r,i]=a.useState(),l=a.useRef(null),s=a.useRef(null),[c,u]=a.useState(),f=a.useRef(),m=typeof window>"u"?null:window,{imageEditorOverride:g,getRowThemeOverride:w,markdownDivCreateNode:h,width:y,height:C,columns:x,rows:v,getCellContent:I,onCellClicked:X,onCellActivated:N,onFillPattern:A,onFinishedEditing:z,coercePasteValue:K,drawHeader:S,drawCell:$,editorBloom:W,onHeaderClicked:D,onColumnProposeMove:R,spanRangeBehavior:M="default",onGroupHeaderClicked:re,onCellContextMenu:te,className:ce,onHeaderContextMenu:Ce,getCellsForSelection:Fe,onGroupHeaderContextMenu:_,onGroupHeaderRenamed:V,onCellEdited:xe,onCellsEdited:ne,onSearchResultsChanged:be,searchResults:pe,onSearchValueChange:U,searchValue:ke,onKeyDown:ve,onKeyUp:je,keybindings:nt,editOnType:mt=!0,onRowAppended:et,onColumnMoved:Ae,validateCell:Ve,highlightRegions:Re,rangeSelect:ut="rect",columnSelect:rt="multi",rowSelect:it="multi",rangeSelectionBlending:ie="exclusive",columnSelectionBlending:We="exclusive",rowSelectionBlending:De="exclusive",onDelete:Ie,onDragStart:fe,onMouseMove:Ne,onPaste:Te,copyHeaders:_e=!1,freezeColumns:oe=0,cellActivationBehavior:He="second-click",rowSelectionMode:tt="auto",onHeaderMenuClick:$e,onHeaderIndicatorClick:Ke,getGroupDetails:ft,rowGrouping:Xe,onSearchClose:ze,onItemHovered:Ct,onSelectionCleared:xt,showSearch:Xt,onVisibleRegionChanged:wt,gridSelection:It,onGridSelectionChange:Dt,minColumnWidth:An=50,maxColumnWidth:zn=500,maxColumnAutoWidth:ct,provideEditor:Rn,trailingRowOptions:Pe,freezeTrailingRows:Ze=0,allowedFillDirections:zt="orthogonal",scrollOffsetX:En,scrollOffsetY:nn,verticalBorder:Bt,onDragOverCell:Ue,onDrop:Mt,onColumnResize:at,onColumnResizeEnd:Pt,onColumnResizeStart:Tt,customRenderers:jt,fillHandle:Bo,drawFocusRing:kt=!0,experimental:Ft,fixedShadowX:Ht,fixedShadowY:At,headerIcons:In,imageWindowLoader:sr,initialSize:Bn,isDraggable:Dn,onDragLeave:Fn,onRowMoved:pn,overscrollX:ar,overscrollY:cr,preventDiagonalScrolling:co,rightElement:uo,rightElementProps:fo,trapFocus:_n=!1,smoothScrollX:qn,smoothScrollY:Ln,scaleToRem:Yr=!1,rowHeight:dr=34,headerHeight:ur=36,groupHeaderHeight:Gr=ur,theme:ho,isOutsideClick:Pn,renderers:Lo,resizeIndicator:Kr,scrollToActiveCell:Po=!0}=e,yt=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Wt=(yt==null?void 0:yt.kind)??e.rowMarkers??"none",Hi=(yt==null?void 0:yt.width)??e.rowMarkerWidth,Wo=(yt==null?void 0:yt.startIndex)??e.rowMarkerStartIndex??1,go=(yt==null?void 0:yt.theme)??e.rowMarkerTheme,$o=yt==null?void 0:yt.headerTheme,mo=yt==null?void 0:yt.headerAlwaysVisible,dn=(yt==null?void 0:yt.checkboxStyle)??"square",Zt=Math.max(An,20),Wn=Math.max(zn,Zt),jn=Math.max(ct??Wn,Zt),wo=a.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Se,rowNumberMapper:Oo,rowHeight:fr,getRowThemeOverride:un}=vd(Xe,v,dr,w),Ur=a.useMemo(()=>Number.parseFloat(wo.fontSize),[wo]),{rowHeight:fn,headerHeight:yo,groupHeaderHeight:No,theme:Xo,overscrollX:Vr,overscrollY:_r}=yd({groupHeaderHeight:Gr,headerHeight:ur,overscrollX:ar,overscrollY:cr,remSize:Ur,rowHeight:fr,scaleToRem:Yr,theme:ho}),vn=bd(nt),$n=Hi??(v>1e4?48:v>1e3?44:v>100?36:32),on=Wt!=="none",H=on?1:0,bt=et!==void 0,Zn=(Pe==null?void 0:Pe.sticky)===!0,[qr,hr]=a.useState(!1),gr=Xt??qr,bo=a.useCallback(()=>{ze!==void 0?ze():hr(!1)},[ze]),B=a.useMemo(()=>It===void 0?void 0:Hr(It,H),[It,H])??n,$t=a.useRef();$t.current===void 0&&($t.current=new AbortController),a.useEffect(()=>()=>$t==null?void 0:$t.current.abort(),[]);const[St,jr]=td(Fe,I,H,$t.current,Se),po=a.useCallback((d,p,b)=>{if(Ve===void 0)return!0;const F=[d[0]-H,d[1]];return Ve==null?void 0:Ve(F,p,b)},[H,Ve]),vo=a.useRef(It),Ut=a.useCallback((d,p)=>{p&&(d=ad(d,St,H,M,$t.current)),Dt!==void 0?(vo.current=Hr(d,-H),Dt(vo.current)):o(d)},[Dt,St,H,M]),k=ro(at,a.useCallback((d,p,b,F)=>{at==null||at(x[b-H],p,b-H,F)},[at,H,x])),G=ro(Pt,a.useCallback((d,p,b,F)=>{Pt==null||Pt(x[b-H],p,b-H,F)},[Pt,H,x])),de=ro(Tt,a.useCallback((d,p,b,F)=>{Tt==null||Tt(x[b-H],p,b-H,F)},[Tt,H,x])),se=ro(S,a.useCallback((d,p)=>(S==null?void 0:S({...d,columnIndex:d.columnIndex-H},p))??!1,[S,H])),q=ro($,a.useCallback((d,p)=>($==null?void 0:$({...d,col:d.col-H},p))??!1,[$,H])),J=a.useCallback(d=>{if(Ie!==void 0){const p=Ie(Hr(d,-H));return typeof p=="boolean"?p:Hr(p,H)}return!0},[Ie,H]),[ae,ue,Z]=ed(B,Ut,ie,We,De,ut),qe=a.useMemo(()=>Tn(Xl(),Xo),[Xo]),[he,Je]=a.useState([0,0,0]),Ye=a.useMemo(()=>{if(Lo===void 0)return{};const d={};for(const p of Lo)d[p.kind]=p;return d},[Lo]),Ee=a.useCallback(d=>d.kind!==j.Custom?Ye[d.kind]:jt==null?void 0:jt.find(p=>p.isMatch(d)),[jt,Ye]);let{sizedColumns:ot,nonGrowWidth:Vt}=Ea(x,Se,jr,he[0]-(H===0?0:$n)-he[2],Zt,jn,qe,Ee,$t.current);Wt!=="none"&&(Vt+=$n);const pt=a.useMemo(()=>ot.some(d=>d.group!==void 0),[ot]),Yt=pt?yo+No:yo,hn=B.rows.length,_t=Wt==="none"?void 0:hn===0?!1:hn===Se?!0:void 0,ge=a.useMemo(()=>Wt==="none"?ot:[{title:"",width:$n,icon:void 0,hasMenu:!1,style:"normal",themeOverride:go,rowMarker:dn,rowMarkerChecked:_t,headerRowMarkerTheme:$o,headerRowMarkerAlwaysVisible:mo},...ot],[Wt,ot,$n,go,dn,_t,$o,mo]),ht=a.useRef({height:1,width:1,x:0,y:0}),Gt=a.useRef(!1),{setVisibleRegion:On,visibleRegion:Ot,scrollRef:lt}=kd(En,nn,fn,ht,()=>Gt.current=!0);ht.current=Ot;const Jn=Ot.x+H,wr=Ot.y,qt=a.useRef(null),Kt=a.useCallback(d=>{var p;d===!0?(p=qt.current)==null||p.focus():window.requestAnimationFrame(()=>{var b;(b=qt.current)==null||b.focus()})},[]),Nt=bt?Se+1:Se,rn=a.useCallback(d=>{const p=H===0?d:d.map(F=>({...F,location:[F.location[0]-H,F.location[1]]})),b=ne==null?void 0:ne(p);if(b!==!0)for(const F of p)xe==null||xe(F.location,F.value);return b},[xe,ne,H]),[Qn,Zr]=a.useState(),yr=B.current!==void 0&&B.current.range.width*B.current.range.height>1?B.current.range:void 0,Co=kt?(Ui=B.current)==null?void 0:Ui.cell:void 0,br=Co==null?void 0:Co[0],pr=Co==null?void 0:Co[1],ls=a.useMemo(()=>{if((Re===void 0||Re.length===0)&&(yr??br??pr??Qn)===void 0)return;const d=[];if(Re!==void 0)for(const p of Re){const b=ge.length-p.range.x-H;b>0&&d.push({color:p.color,range:{...p.range,x:p.range.x+H,width:Math.min(b,p.range.width)},style:p.style})}return Qn!==void 0&&d.push({color:so(qe.accentColor,0),range:Qn,style:"dashed"}),yr!==void 0&&d.push({color:so(qe.accentColor,.5),range:yr,style:"solid-outline"}),br!==void 0&&pr!==void 0&&d.push({color:qe.accentColor,range:{x:br,y:pr,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[Qn,yr,br,pr,Re,ge.length,qe.accentColor,H]),Ti=a.useRef(ge);Ti.current=ge;const Jt=a.useCallback(([d,p],b=!1)=>{var P,T,L,O,Y,Q,me;const F=bt&&p===Nt-1;if(d===0&&on){if(F)return Tr;const ee=Oo(p);return ee===void 0?Tr:{kind:cn.Marker,allowOverlay:!1,checkboxStyle:dn,checked:(B==null?void 0:B.rows.hasIndex(p))===!0,markerKind:Wt==="clickable-number"?"number":Wt,row:Wo+ee,drawHandle:pn!==void 0,cursor:Wt==="clickable-number"?"pointer":void 0}}else if(F){const ye=d===H?(Pe==null?void 0:Pe.hint)??"":"",le=Ti.current[d];if(((P=le==null?void 0:le.trailingRowOptions)==null?void 0:P.disabled)===!0)return Tr;{const Ge=((T=le==null?void 0:le.trailingRowOptions)==null?void 0:T.hint)??ye,Me=((L=le==null?void 0:le.trailingRowOptions)==null?void 0:L.addIcon)??(Pe==null?void 0:Pe.addIcon);return{kind:cn.NewRow,hint:Ge,allowOverlay:!1,icon:Me}}}else{const ee=d-H;if(b||(Ft==null?void 0:Ft.strict)===!0){const le=ht.current,Ge=le.x>ee||ee>le.x+le.width||le.y>p||p>le.y+le.height||p>=Qr.current,Me=ee===((Y=(O=le.extras)==null?void 0:O.selected)==null?void 0:Y[0])&&p===((Q=le.extras)==null?void 0:Q.selected[1]);let we=!1;if(((me=le.extras)==null?void 0:me.freezeRegions)!==void 0){for(const Qe of le.extras.freezeRegions)if(lo(Qe,ee,p)){we=!0;break}}if(Ge&&!Me&&!we)return Tr}let ye=I([ee,p]);return H!==0&&ye.span!==void 0&&(ye={...ye,span:[ye.span[0]+H,ye.span[1]+H]}),ye}},[bt,Nt,on,Oo,dn,B==null?void 0:B.rows,Wt,Wo,pn,H,Pe==null?void 0:Pe.hint,Pe==null?void 0:Pe.addIcon,Ft==null?void 0:Ft.strict,I]),Jr=a.useCallback(d=>{let p=(ft==null?void 0:ft(d))??{name:d};return V!==void 0&&d!==""&&(p={icon:p.icon,name:p.name,overrideTheme:p.overrideTheme,actions:[...p.actions??[],{title:"Rename",icon:"renameIcon",onClick:b=>ti({group:p.name,bounds:b.bounds})}]}),p},[ft,V]),vr=a.useCallback(d=>{var L;const[p,b]=d.cell,F=ge[p],E=(F==null?void 0:F.group)!==void 0?(L=Jr(F.group))==null?void 0:L.overrideTheme:void 0,P=F==null?void 0:F.themeOverride,T=un==null?void 0:un(b);i({...d,theme:Tn(qe,E,P,T,d.content.themeOverride)})},[un,ge,Jr,qe]),xo=a.useCallback((d,p,b)=>{var T;if(B.current===void 0)return;const[F,E]=B.current.cell,P=Jt([F,E]);if(P.kind!==j.Boolean&&P.allowOverlay){let L=P;if(b!==void 0)switch(L.kind){case j.Number:{const O=Ks(()=>b==="-"?-0:Number.parseFloat(b),0);L={...L,data:Number.isNaN(O)?0:O};break}case j.Text:case j.Markdown:case j.Uri:L={...L,data:b};break}vr({target:d,content:L,initialValue:b,cell:[F,E],highlight:b===void 0,forceEditMode:b!==void 0})}else P.kind===j.Boolean&&p&&P.readonly!==!0&&(rn([{location:B.current.cell,value:{...P,data:os(P.data)}}]),(T=qt.current)==null||T.damage([{cell:B.current.cell}]))},[Jt,B,rn,vr]),Ai=a.useCallback((d,p)=>{var E;const b=(E=qt.current)==null?void 0:E.getBounds(d,p);if(b===void 0||lt.current===null)return;const F=Jt([d,p]);F.allowOverlay&&vr({target:b,content:F,initialValue:void 0,highlight:!0,cell:[d,p],forceEditMode:!0})},[Jt,lt,vr]),Rt=a.useCallback((d,p,b="both",F=0,E=0,P=void 0)=>{if(lt.current!==null){const T=qt.current,L=s.current,O=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,Y=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,Q=typeof d!="number"&&d.unit==="px"?d.amount:void 0,me=typeof p!="number"&&p.unit==="px"?p.amount:void 0;if(T!==null&&L!==null){let ee={x:0,y:0,width:0,height:0},ye=0,le=0;if((O!==void 0||Y!==void 0)&&(ee=T.getBounds((O??0)+H,Y??0)??ee,ee.width===0||ee.height===0))return;const Ge=L.getBoundingClientRect(),Me=Ge.width/L.offsetWidth;if(Q!==void 0&&(ee={...ee,x:Q-Ge.left-lt.current.scrollLeft,width:1}),me!==void 0&&(ee={...ee,y:me+Ge.top-lt.current.scrollTop,height:1}),ee!==void 0){const we={x:ee.x-F,y:ee.y-E,width:ee.width+2*F,height:ee.height+2*E};let Qe=0;for(let ai=0;ai<oe;ai++)Qe+=ot[ai].width;let gt=0;const Et=Ze+(Zn?1:0);Et>0&&(gt=ao(Nt,Et,fn));let wn=Qe*Me+Ge.left+H*$n*Me,xn=Ge.right,yn=Ge.top+Yt*Me,kn=Ge.bottom-gt*Me;const Er=ee.width+F*2;switch(P==null?void 0:P.hAlign){case"start":xn=wn+Er;break;case"end":wn=xn-Er;break;case"center":wn=Math.floor((wn+xn)/2)-Er/2,xn=wn+Er;break}const Ir=ee.height+E*2;switch(P==null?void 0:P.vAlign){case"start":kn=yn+Ir;break;case"end":yn=kn-Ir;break;case"center":yn=Math.floor((yn+kn)/2)-Ir/2,kn=yn+Ir;break}wn>we.x?ye=we.x-wn:xn<we.x+we.width&&(ye=we.x+we.width-xn),yn>we.y?le=we.y-yn:kn<we.y+we.height&&(le=we.y+we.height-kn),b==="vertical"||typeof d=="number"&&d<oe?ye=0:(b==="horizontal"||typeof p=="number"&&p>=Nt-Et)&&(le=0),(ye!==0||le!==0)&&(Me!==1&&(ye/=Me,le/=Me),lt.current.scrollTo(ye+lt.current.scrollLeft,le+lt.current.scrollTop))}}}},[H,Ze,$n,lt,Yt,oe,ot,Nt,Zn,fn]),zi=a.useRef(Ai),Bi=a.useRef(I),Qr=a.useRef(Se);zi.current=Ai,Bi.current=I,Qr.current=Se;const ko=a.useCallback(async(d,p=!0)=>{var O;const b=ge[d];if(((O=b==null?void 0:b.trailingRowOptions)==null?void 0:O.disabled)===!0)return;const F=et==null?void 0:et();let E,P=!0;F!==void 0&&(E=await F,E==="top"&&(P=!1),typeof E=="number"&&(P=!1));let T=0;const L=()=>{if(Qr.current<=Se){T<500&&window.setTimeout(L,T),T=50+T*2;return}const Y=typeof E=="number"?E:P?Se:0;Rr.current(d-H,Y),ae({cell:[d,Y],range:{x:d,y:Y,width:1,height:1}},!1,!1,"edit");const Q=Bi.current([d-H,Y]);Q.allowOverlay&&Qo(Q)&&Q.readonly!==!0&&p&&window.setTimeout(()=>{zi.current(d,Y)},0)};L()},[ge,et,H,Se,ae]),Cr=a.useCallback(d=>{var b,F;const p=((F=(b=ot[d])==null?void 0:b.trailingRowOptions)==null?void 0:F.targetColumn)??(Pe==null?void 0:Pe.targetColumn);if(typeof p=="number")return p+(on?1:0);if(typeof p=="object"){const E=x.indexOf(p);if(E>=0)return E+(on?1:0)}},[ot,x,on,Pe==null?void 0:Pe.targetColumn]),Nn=a.useRef(),So=a.useRef(),Yo=a.useCallback((d,p)=>{var E;const[b,F]=p;return Tn(qe,(E=ge[b])==null?void 0:E.themeOverride,un==null?void 0:un(F),d.themeOverride)},[un,ge,qe]),{mapper:eo}=Cd(Xe,v),gn=Xe==null?void 0:Xe.navigationBehavior,Go=a.useCallback(d=>{var Q,me,ee;const p=Wr.value?d.metaKey:d.ctrlKey,b=p&&it==="multi",F=p&&rt==="multi",[E,P]=d.location,T=B.columns,L=B.rows,[O,Y]=((Q=B.current)==null?void 0:Q.cell)??[];if(d.kind==="cell"){if(So.current=void 0,to.current=[E,P],E===0&&on){if(bt===!0&&P===Se||Wt==="number"||it==="none")return;const ye=Jt(d.location);if(ye.kind!==cn.Marker)return;if(pn!==void 0){const Me=Ee(ye);Qt((Me==null?void 0:Me.kind)===cn.Marker);const we=(me=Me==null?void 0:Me.onClick)==null?void 0:me.call(Me,{...d,cell:ye,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Yo(ye,d.location),preventDefault:()=>{}});if(we===void 0||we.checked===ye.checked)return}i(void 0),Kt();const le=L.hasIndex(P),Ge=Nn.current;if(it==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&Ge!==void 0&&L.hasIndex(Ge)){const Me=[Math.min(Ge,P),Math.max(Ge,P)+1];b||tt==="multi"?ue(void 0,Me,!0):ue(st.fromSingleSelection(Me),void 0,b)}else b||d.isTouch||tt==="multi"?le?ue(L.remove(P),void 0,!0):(ue(void 0,P,!0),Nn.current=P):le&&L.length===1?ue(st.empty(),void 0,p):(ue(st.fromSingleSelection(P),void 0,p),Nn.current=P)}else if(E>=H&&bt&&P===Se){const ye=Cr(E);ko(ye??E)}else if(O!==E||Y!==P){const ye=Jt(d.location),le=Ee(ye);if((le==null?void 0:le.onSelect)!==void 0){let we=!1;if(le.onSelect({...d,cell:ye,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>we=!0,theme:Yo(ye,d.location)}),we)return}if(gn==="block"&&eo(P).isGroupHeader)return;const Ge=Zn&&P===Se,Me=Zn&&B!==void 0&&((ee=B.current)==null?void 0:ee.cell[1])===Se;if((d.shiftKey||d.isLongTouch===!0)&&O!==void 0&&Y!==void 0&&B.current!==void 0&&!Me){if(Ge)return;const we=Math.min(E,O),Qe=Math.max(E,O),gt=Math.min(P,Y),Et=Math.max(P,Y);ae({...B.current,range:{x:we,y:gt,width:Qe-we+1,height:Et-gt+1}},!0,p,"click"),Nn.current=void 0,Kt()}else ae({cell:[E,P],range:{x:E,y:P,width:1,height:1}},!0,p,"click"),Nn.current=void 0,i(void 0),Kt()}}else if(d.kind==="header")if(to.current=[E,P],i(void 0),on&&E===0)Nn.current=void 0,So.current=void 0,it==="multi"&&(L.length!==Se?ue(st.fromSingleSelection([0,Se]),void 0,p):ue(st.empty(),void 0,p),Kt());else{const ye=So.current;if(rt==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&ye!==void 0&&T.hasIndex(ye)){const le=[Math.min(ye,E),Math.max(ye,E)+1];F?Z(void 0,le,p):Z(st.fromSingleSelection(le),void 0,p)}else F?(T.hasIndex(E)?Z(T.remove(E),void 0,p):Z(void 0,E,p),So.current=E):rt!=="none"&&(Z(st.fromSingleSelection(E),void 0,p),So.current=E);Nn.current=void 0,Kt()}else d.kind===an?to.current=[E,P]:d.kind===$r&&!d.isMaybeScrollbar&&(Ut(Ar,!1),i(void 0),Kt(),xt==null||xt(),Nn.current=void 0,So.current=void 0)},[it,rt,B,on,H,bt,Se,Wt,Jt,pn,Kt,tt,Ee,Yo,ue,Cr,ko,gn,eo,Zn,ae,Z,Ut,xt]),Ko=a.useRef(!1),to=a.useRef(),Li=a.useRef(Ot),ln=a.useRef(),ss=a.useCallback(d=>{if(Mo.current=!1,Li.current=ht.current,d.button!==0&&d.button!==1){ln.current=void 0;return}const p=performance.now();ln.current={button:d.button,time:p,location:d.location},(d==null?void 0:d.kind)==="header"&&(Ko.current=!0);const b=d.kind==="cell"&&d.isFillHandle;!b&&d.kind!=="cell"&&d.isEdge||(u({previousSelection:B,fillHandle:b}),to.current=void 0,!d.isTouch&&d.button===0&&!b?Go(d):!d.isTouch&&d.button===1&&(to.current=d.location))},[B,Go]),[ei,ti]=a.useState(),Pi=a.useCallback(d=>{if(d.kind!==an||rt!=="multi")return;const p=Wr.value?d.metaKey:d.ctrlKey,[b]=d.location,F=B.columns;if(b<H)return;const E=ge[b];let P=b,T=b;for(let L=b-1;L>=H&&rr(E.group,ge[L].group);L--)P--;for(let L=b+1;L<ge.length&&rr(E.group,ge[L].group);L++)T++;if(Kt(),p)if(F.hasAll([P,T+1])){let L=F;for(let O=P;O<=T;O++)L=L.remove(O);Z(L,void 0,p)}else Z(void 0,[P,T+1],p);else Z(st.fromSingleSelection([P,T+1]),void 0,p)},[rt,Kt,B.columns,ge,H,Z]),Mo=a.useRef(!1),xr=a.useCallback(async d=>{if(St!==void 0&&k!==void 0){const p=ht.current.y,b=ht.current.height;let F=St({x:d,y:p,width:1,height:Math.min(b,Se-p)},$t.current.signal);typeof F!="object"&&(F=await F());const E=ot[d-H],T=document.createElement("canvas").getContext("2d",{alpha:!1});if(T!==null){T.font=qe.baseFontFull;const L=Gl(T,qe,E,0,F,Zt,Wn,!1,Ee);k==null||k(E,L.width,d,L.width)}}},[ot,St,Wn,qe,Zt,k,H,Se,Ee]),[as,ni]=a.useState(),Ro=a.useCallback(async(d,p)=>{var L,O;const b=(L=d.current)==null?void 0:L.range;if(b===void 0||St===void 0||p.current===void 0)return;const F=p.current.range;if(A!==void 0){let Y=!1;if(A({fillDestination:{...F,x:F.x-H},patternSource:{...b,x:b.x-H},preventDefault:()=>Y=!0}),Y)return}let E=St(b,$t.current.signal);typeof E!="object"&&(E=await E());const P=E,T=[];for(let Y=0;Y<F.width;Y++)for(let Q=0;Q<F.height;Q++){const me=[F.x+Y,F.y+Q];if(Tl(me,b))continue;const ee=P[Q%b.height][Y%b.width];Do(ee)||!Qo(ee)||T.push({location:me,value:{...ee}})}rn(T),(O=qt.current)==null||O.damage(T.map(Y=>({cell:Y.location})))},[St,rn,A,H]),Wi=a.useCallback(()=>{if(B.current===void 0||B.current.range.width<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,width:1}}};Ro(d,B)},[Ro,B]),$i=a.useCallback(()=>{if(B.current===void 0||B.current.range.height<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,height:1}}};Ro(d,B)},[Ro,B]),cs=a.useCallback((d,p)=>{var Q,me;const b=c;if(u(void 0),Zr(void 0),ni(void 0),Ko.current=!1,p)return;if((b==null?void 0:b.fillHandle)===!0&&B.current!==void 0&&((Q=b.previousSelection)==null?void 0:Q.current)!==void 0){if(Qn===void 0)return;const ee={...B,current:{...B.current,range:ql(b.previousSelection.current.range,Qn)}};Ro(b.previousSelection,ee),Ut(ee,!0);return}const[F,E]=d.location,[P,T]=to.current??[],L=()=>{Mo.current=!0},O=ee=>{var le,Ge,Me;const ye=ee.isTouch||P===F&&T===E;if(ye&&(X==null||X([F-H,E],{...ee,preventDefault:L})),ee.button===1)return!Mo.current;if(!Mo.current){const we=Jt(d.location),Qe=Ee(we);if(Qe!==void 0&&Qe.onClick!==void 0&&ye){const Et=Qe.onClick({...ee,cell:we,posX:ee.localEventX,posY:ee.localEventY,bounds:ee.bounds,theme:Yo(we,d.location),preventDefault:L});Et!==void 0&&!Do(Et)&&Io(Et)&&(rn([{location:ee.location,value:Et}]),(le=qt.current)==null||le.damage([{cell:ee.location}]))}if(Mo.current||B.current===void 0)return!1;let gt=!1;switch(we.activationBehaviorOverride??He){case"double-click":case"second-click":{if(((Me=(Ge=b==null?void 0:b.previousSelection)==null?void 0:Ge.current)==null?void 0:Me.cell)===void 0)break;const[Et,wn]=B.current.cell,[xn,yn]=b.previousSelection.current.cell;gt=F===Et&&F===xn&&E===wn&&E===yn&&(ee.isDoubleClick===!0||He==="second-click");break}case"single-click":{gt=!0;break}}if(gt)return N==null||N([F-H,E]),xo(ee.bounds,!1),!0}return!1},Y=d.location[0]-H;if(d.isTouch){const ee=ht.current,ye=Li.current;if(ee.x!==ye.x||ee.y!==ye.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&er((me=B.current)==null?void 0:me.cell,d.location)){te==null||te([Y,d.location[1]],{...d,preventDefault:L});return}else if(d.kind==="header"&&B.columns.hasIndex(F)){Ce==null||Ce(Y,{...d,preventDefault:L});return}else if(d.kind===an){if(Y<0)return;_==null||_(Y,{...d,preventDefault:L});return}}d.kind==="cell"?O(d)||Go(d):d.kind===an?re==null||re(Y,{...d,preventDefault:L}):(d.kind===Kn&&(D==null||D(Y,{...d,preventDefault:L})),Go(d));return}if(d.kind==="header"){if(Y<0)return;d.isEdge?d.isDoubleClick===!0&&xr(F):d.button===0&&F===P&&E===T&&(D==null||D(Y,{...d,preventDefault:L}))}if(d.kind===an){if(Y<0)return;d.button===0&&F===P&&E===T&&(re==null||re(Y,{...d,preventDefault:L}),Mo.current||Pi(d))}d.kind==="cell"&&(d.button===0||d.button===1)&&O(d),to.current=void 0},[c,B,H,Qn,Ro,Ut,X,Jt,Ee,He,Yo,rn,N,xo,te,Ce,_,Go,re,D,xr,Pi]),ds=a.useCallback(d=>{const p={...d,location:[d.location[0]-H,d.location[1]]};Ne==null||Ne(p),c!==void 0&&d.buttons===0&&(u(void 0),Zr(void 0),ni(void 0),Ko.current=!1),ni(b=>{var F;return Ko.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(b==null?void 0:b[0])&&d.scrollEdge[1]===b[1]?b:c===void 0||(((F=ln.current)==null?void 0:F.location[0])??0)<H?void 0:d.scrollEdge})},[c,Ne,H]),us=a.useCallback((d,p)=>{$e==null||$e(d-H,p)},[$e,H]),fs=a.useCallback((d,p)=>{Ke==null||Ke(d-H,p)},[Ke,H]),Cn=(Vi=B==null?void 0:B.current)==null?void 0:Vi.cell,hs=a.useCallback((d,p,b,F,E,P)=>{Gt.current=!1;let T=Cn;T!==void 0&&(T=[T[0]-H,T[1]]);const L=oe===0?void 0:{x:0,y:d.y,width:oe,height:d.height},O=[];L!==void 0&&O.push(L),Ze>0&&(O.push({x:d.x-H,y:Se-Ze,width:d.width,height:Ze}),oe>0&&O.push({x:0,y:Se-Ze,width:oe,height:Ze}));const Y={x:d.x-H,y:d.y,width:d.width,height:bt&&d.y+d.height>=Se?d.height-1:d.height,tx:E,ty:P,extras:{selected:T,freezeRegion:L,freezeRegions:O}};ht.current=Y,On(Y),Je([p,b,F]),wt==null||wt(Y,Y.tx,Y.ty,Y.extras)},[Cn,H,bt,Se,oe,Ze,On,wt]),gs=ro(Ae,a.useCallback((d,p)=>{Ae==null||Ae(d-H,p-H),rt!=="none"&&Z(st.fromSingleSelection(p),void 0,!0)},[rt,Ae,H,Z])),oi=a.useRef(!1),ms=a.useCallback(d=>{if(d.location[0]===0&&H>0){d.preventDefault();return}fe==null||fe({...d,location:[d.location[0]-H,d.location[1]]}),d.defaultPrevented()||(oi.current=!0),u(void 0)},[fe,H]),ws=a.useCallback(()=>{oi.current=!1},[]),Oi=Xe==null?void 0:Xe.selectionBehavior,kr=a.useCallback(d=>{if(Oi!=="block-spanning")return;const{isGroupHeader:p,path:b,groupRows:F}=eo(d);if(p)return[d,d];const E=b[b.length-1],P=d-E,T=d+F-E-1;return[P,T]},[eo,Oi]),ri=a.useRef(),ii=a.useCallback(d=>{var p,b,F;if(!ts(d,ri.current)&&(ri.current=d,!(((p=ln==null?void 0:ln.current)==null?void 0:p.button)!==void 0&&ln.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((b=ln.current)==null?void 0:b.location[0])===0&&d.location[0]===0&&H===1&&it==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(ln.current.location[1])&&B.rows.hasIndex(ln.current.location[1])){const E=Math.min(ln.current.location[1],d.location[1]),P=Math.max(ln.current.location[1],d.location[1])+1;ue(st.fromSingleSelection([E,P]),void 0,!1)}if(d.buttons!==0&&c!==void 0&&B.current!==void 0&&!oi.current&&!Ko.current&&(ut==="rect"||ut==="multi-rect")){const[E,P]=B.current.cell;let[T,L]=d.location;if(L<0&&(L=ht.current.y),c.fillHandle===!0&&((F=c.previousSelection)==null?void 0:F.current)!==void 0){const O=c.previousSelection.current.range;L=Math.min(L,bt?Se-1:Se);const Y=ic(O,T,L,zt);Zr(Y)}else{if(bt&&P===Se)return;if(bt&&L===Se)if(d.kind===$r)L--;else return;T=Math.max(T,H);const Q=kr(P);L=Q===void 0?L:sn(L,Q[0],Q[1]);const me=T-E,ee=L-P,ye={x:me>=0?E:T,y:ee>=0?P:L,width:Math.abs(me)+1,height:Math.abs(ee)+1};ae({...B.current,range:ye},!0,!1,"drag")}}Ct==null||Ct({...d,location:[d.location[0]-H,d.location[1]]})}},[c,H,it,B,ut,Ct,ue,bt,Se,zt,kr,ae]),ys=a.useCallback(()=>{var T,L;const d=ri.current;if(d===void 0)return;const[p,b]=d.scrollEdge;let[F,E]=d.location;const P=ht.current;p===-1?F=((L=(T=P.extras)==null?void 0:T.freezeRegion)==null?void 0:L.x)??P.x:p===1&&(F=P.x+P.width),b===-1?E=Math.max(0,P.y):b===1&&(E=Math.min(Se-1,P.y+P.height)),F=sn(F,0,ge.length-1),E=sn(E,0,Se-1),ii({...d,location:[F,E]})},[ge.length,ii,Se]);wd(as,lt,ys);const mn=a.useCallback(d=>{if(B.current===void 0)return;const[p,b]=d,[F,E]=B.current.cell,P=B.current.range;let T=P.x,L=P.x+P.width,O=P.y,Y=P.y+P.height;const[Q,me]=kr(E)??[0,Se-1],ee=me+1;if(b!==0)switch(b){case 2:{Y=ee,O=E,Rt(0,Y,"vertical");break}case-2:{O=Q,Y=E+1,Rt(0,O,"vertical");break}case 1:{O<E?(O++,Rt(0,O,"vertical")):(Y=Math.min(ee,Y+1),Rt(0,Y,"vertical"));break}case-1:{Y>E+1?(Y--,Rt(0,Y,"vertical")):(O=Math.max(Q,O-1),Rt(0,O,"vertical"));break}default:or()}if(p!==0)if(p===2)L=ge.length,T=F,Rt(L-1-H,0,"horizontal");else if(p===-2)T=H,L=F+1,Rt(T-H,0,"horizontal");else{let ye=[];if(St!==void 0){const le=St({x:T,y:O,width:L-T-H,height:Y-O},$t.current.signal);typeof le=="object"&&(ye=Rd(le))}if(p===1){let le=!1;if(T<F){if(ye.length>0){const Ge=io(T+1,F+1).find(Me=>!ye.includes(Me-H));Ge!==void 0&&(T=Ge,le=!0)}else T++,le=!0;le&&Rt(T,0,"horizontal")}le||(L=Math.min(ge.length,L+1),Rt(L-1-H,0,"horizontal"))}else if(p===-1){let le=!1;if(L>F+1){if(ye.length>0){const Ge=io(L-1,F,-1).find(Me=>!ye.includes(Me-H));Ge!==void 0&&(L=Ge,le=!0)}else L--,le=!0;le&&Rt(L-H,0,"horizontal")}le||(T=Math.max(H,T-1),Rt(T-H,0,"horizontal"))}else or()}ae({cell:B.current.cell,range:{x:T,y:O,width:L-T,height:Y-O}},!0,!1,"keyboard-select")},[St,kr,B,ge.length,H,Se,Rt,ae]),li=a.useRef(Po);li.current=Po;const Xn=a.useCallback((d,p,b,F)=>{const E=Nt-(b?0:1);d=sn(d,H,ot.length-1+H),p=sn(p,0,E);const P=Cn==null?void 0:Cn[0],T=Cn==null?void 0:Cn[1];if(d===P&&p===T)return!1;if(F&&B.current!==void 0){const L=[...B.current.rangeStack];(B.current.range.width>1||B.current.range.height>1)&&L.push(B.current.range),Ut({...B,current:{cell:[d,p],range:{x:d,y:p,width:1,height:1},rangeStack:L}},!0)}else ae({cell:[d,p],range:{x:d,y:p,width:1,height:1}},!0,!1,"keyboard-nav");return f.current!==void 0&&f.current[0]===d&&f.current[1]===p&&(f.current=void 0),li.current&&Rt(d-H,p),!0},[Nt,H,ot.length,Cn,B,Rt,Ut,ae]),bs=a.useCallback((d,p)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&Io(d)&&(rn([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var E;(E=qt.current)==null||E.damage([{cell:r.cell}])})),Kt(!0),i(void 0);const[b,F]=p;if(B.current!==void 0&&(b!==0||F!==0)){const E=B.current.cell[1]===Nt-1&&d!==void 0;Xn(sn(B.current.cell[0]+b,0,ge.length-1),sn(B.current.cell[1]+F,0,Nt-1),E,!1)}z==null||z(d,p)},[r==null?void 0:r.cell,Kt,B,z,rn,Nt,Xn,ge.length]),ps=a.useMemo(()=>`gdg-overlay-${Md++}`,[]),no=a.useCallback(d=>{var b,F,E,P;Kt();const p=[];for(let T=d.x;T<d.x+d.width;T++)for(let L=d.y;L<d.y+d.height;L++){const O=I([T-H,L]);if(!O.allowOverlay&&O.kind!==j.Boolean)continue;let Y;if(O.kind===j.Custom){const Q=Ee(O),me=(b=Q==null?void 0:Q.provideEditor)==null?void 0:b.call(Q,O);(Q==null?void 0:Q.onDelete)!==void 0?Y=Q.onDelete(O):Us(me)&&(Y=(F=me==null?void 0:me.deletedValue)==null?void 0:F.call(me,O))}else if(Io(O)&&O.allowOverlay||O.kind===j.Boolean){const Q=Ee(O);Y=(E=Q==null?void 0:Q.onDelete)==null?void 0:E.call(Q,O)}Y!==void 0&&!Do(Y)&&Io(Y)&&p.push({location:[T,L],value:Y})}rn(p),(P=qt.current)==null||P.damage(p.map(T=>({cell:T.location})))},[Kt,I,Ee,rn,H]),Uo=r!==void 0,Ni=a.useCallback(d=>{var Ge,Me;const p=()=>{d.stopPropagation(),d.preventDefault()},b={didMatch:!1},{bounds:F}=d,E=B.columns,P=B.rows,T=vn;if(!Uo&&Be(T.clear,d,b))Ut(Ar,!1),xt==null||xt();else if(!Uo&&Be(T.selectAll,d,b))Ut({columns:st.empty(),rows:st.empty(),current:{cell:((Ge=B.current)==null?void 0:Ge.cell)??[H,0],range:{x:H,y:0,width:x.length,height:Se},rangeStack:[]}},!1);else if(Be(T.search,d,b))(Me=l==null?void 0:l.current)==null||Me.focus({preventScroll:!0}),hr(!0);else if(Be(T.delete,d,b)){const we=(J==null?void 0:J(B))??!0;if(we!==!1){const Qe=we===!0?B:we;if(Qe.current!==void 0){no(Qe.current.range);for(const gt of Qe.current.rangeStack)no(gt)}for(const gt of Qe.rows)no({x:H,y:gt,width:x.length,height:1});for(const gt of Qe.columns)no({x:gt,y:0,width:1,height:Se})}}if(b.didMatch)return p(),!0;if(B.current===void 0)return!1;let[L,O]=B.current.cell;const[,Y]=B.current.cell;let Q=!1,me=!1;if(Be(T.scrollToSelectedCell,d,b)?Rr.current(L-H,O):rt!=="none"&&Be(T.selectColumn,d,b)?E.hasIndex(L)?Z(E.remove(L),void 0,!0):rt==="single"?Z(st.fromSingleSelection(L),void 0,!0):Z(void 0,L,!0):it!=="none"&&Be(T.selectRow,d,b)?P.hasIndex(O)?ue(P.remove(O),void 0,!0):it==="single"?ue(st.fromSingleSelection(O),void 0,!0):ue(void 0,O,!0):!Uo&&F!==void 0&&Be(T.activateCell,d,b)?O===Se&&bt?window.setTimeout(()=>{const we=Cr(L);ko(we??L)},0):(N==null||N([L-H,O]),xo(F,!0)):B.current.range.height>1&&Be(T.downFill,d,b)?$i():B.current.range.width>1&&Be(T.rightFill,d,b)?Wi():Be(T.goToNextPage,d,b)?O+=Math.max(1,ht.current.height-4):Be(T.goToPreviousPage,d,b)?O-=Math.max(1,ht.current.height-4):Be(T.goToFirstCell,d,b)?(i(void 0),O=0,L=0):Be(T.goToLastCell,d,b)?(i(void 0),O=Number.MAX_SAFE_INTEGER,L=Number.MAX_SAFE_INTEGER):Be(T.selectToFirstCell,d,b)?(i(void 0),mn([-2,-2])):Be(T.selectToLastCell,d,b)?(i(void 0),mn([2,2])):Uo?(Be(T.closeOverlay,d,b)&&i(void 0),Be(T.acceptOverlayDown,d,b)&&(i(void 0),O++),Be(T.acceptOverlayUp,d,b)&&(i(void 0),O--),Be(T.acceptOverlayLeft,d,b)&&(i(void 0),L--),Be(T.acceptOverlayRight,d,b)&&(i(void 0),L++)):(Be(T.goDownCell,d,b)?O+=1:Be(T.goUpCell,d,b)?O-=1:Be(T.goRightCell,d,b)?L+=1:Be(T.goLeftCell,d,b)?L-=1:Be(T.goDownCellRetainSelection,d,b)?(O+=1,Q=!0):Be(T.goUpCellRetainSelection,d,b)?(O-=1,Q=!0):Be(T.goRightCellRetainSelection,d,b)?(L+=1,Q=!0):Be(T.goLeftCellRetainSelection,d,b)?(L-=1,Q=!0):Be(T.goToLastRow,d,b)?O=Se-1:Be(T.goToFirstRow,d,b)?O=Number.MIN_SAFE_INTEGER:Be(T.goToLastColumn,d,b)?L=Number.MAX_SAFE_INTEGER:Be(T.goToFirstColumn,d,b)?L=Number.MIN_SAFE_INTEGER:(ut==="rect"||ut==="multi-rect")&&(Be(T.selectGrowDown,d,b)?mn([0,1]):Be(T.selectGrowUp,d,b)?mn([0,-1]):Be(T.selectGrowRight,d,b)?mn([1,0]):Be(T.selectGrowLeft,d,b)?mn([-1,0]):Be(T.selectToLastRow,d,b)?mn([0,2]):Be(T.selectToFirstRow,d,b)?mn([0,-2]):Be(T.selectToLastColumn,d,b)?mn([2,0]):Be(T.selectToFirstColumn,d,b)&&mn([-2,0])),me=b.didMatch),gn!==void 0&&gn!=="normal"&&O!==Y){const we=gn==="skip-up"||gn==="skip"||gn==="block",Qe=gn==="skip-down"||gn==="skip"||gn==="block",gt=O<Y;if(gt&&we){for(;O>=0&&eo(O).isGroupHeader;)O--;O<0&&(O=Y)}else if(!gt&&Qe){for(;O<Se&&eo(O).isGroupHeader;)O++;O>=Se&&(O=Y)}}const ye=Xn(L,O,!1,Q),le=b.didMatch;return le&&(ye||!me||_n)&&p(),le},[gn,Uo,B,vn,rt,it,ut,H,eo,Se,Xn,Ut,xt,x.length,J,_n,no,Z,ue,bt,Cr,ko,N,xo,$i,Wi,mn]),Vo=a.useCallback(d=>{let p=!1;if(ve!==void 0&&ve({...d,cancel:()=>{p=!0}}),p||Ni(d)||B.current===void 0)return;const[b,F]=B.current.cell,E=ht.current;if(mt&&!d.metaKey&&!d.ctrlKey&&B.current!==void 0&&d.key.length===1&&/[ -~]/g.test(d.key)&&d.bounds!==void 0&&Qo(I([b-H,Math.max(0,Math.min(F,Se-1))]))){if((!bt||F!==Se)&&(E.y>F||F>E.y+E.height||E.x>b||b>E.x+E.width))return;xo(d.bounds,!0,d.key),d.stopPropagation(),d.preventDefault()}},[mt,ve,Ni,B,I,H,Se,bt,xo]),vs=a.useCallback((d,p)=>{const b=d.location[0]-H;if(d.kind==="header"&&(Ce==null||Ce(b,{...d,preventDefault:p})),d.kind===an){if(b<0)return;_==null||_(b,{...d,preventDefault:p})}if(d.kind==="cell"){const[F,E]=d.location;te==null||te([b,E],{...d,preventDefault:p}),ua(B,d.location)||Xn(F,E,!1,!1)}},[B,te,_,Ce,H,Xn]),si=a.useCallback(async d=>{var T,L,O;if(!vn.paste)return;function p(Y,Q,me,ee){var le,Ge;const ye=typeof me=="object"?(me==null?void 0:me.join(`
`))??"":(me==null?void 0:me.toString())??"";if(!Do(Y)&&Qo(Y)&&Y.readonly!==!0){const Me=K==null?void 0:K(ye,Y);if(Me!==void 0&&Io(Me))return{location:Q,value:Me};const we=Ee(Y);if(we===void 0)return;if(we.kind===j.Custom){Qt(Y.kind===j.Custom);const Qe=(le=we.onPaste)==null?void 0:le.call(we,ye,Y.data);return Qe===void 0?void 0:{location:Q,value:{...Y,data:Qe}}}else{const Qe=(Ge=we.onPaste)==null?void 0:Ge.call(we,ye,Y,{formatted:ee,formattedString:typeof ee=="string"?ee:ee==null?void 0:ee.join(`
`),rawValue:me});return Qe===void 0?void 0:(Qt(Qe.kind===Y.kind),{location:Q,value:Qe})}}}const b=B.columns,F=B.rows,E=((T=lt.current)==null?void 0:T.contains(document.activeElement))===!0||((L=s.current)==null?void 0:L.contains(document.activeElement))===!0;let P;if(B.current!==void 0?P=[B.current.range.x,B.current.range.y]:b.length===1?P=[b.first()??0,0]:F.length===1&&(P=[H,F.first()??0]),E&&P!==void 0){let Y,Q;const me="text/plain",ee="text/html";if(navigator.clipboard.read!==void 0){const Me=await navigator.clipboard.read();for(const we of Me){if(we.types.includes(ee)){const gt=await(await we.getType(ee)).text(),Et=wl(gt);if(Et!==void 0){Y=Et;break}}we.types.includes(me)&&(Q=await(await we.getType(me)).text())}}else if(navigator.clipboard.readText!==void 0)Q=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(ee)){const Me=d.clipboardData.getData(ee);Y=wl(Me)}Y===void 0&&d.clipboardData.types.includes(me)&&(Q=d.clipboardData.getData(me))}else return;const[ye,le]=P,Ge=[];do{if(Te===void 0){const Me=Jt(P),we=Q??(Y==null?void 0:Y.map(gt=>gt.map(Et=>Et.rawValue).join("	")).join("	"))??"",Qe=p(Me,P,we,void 0);Qe!==void 0&&Ge.push(Qe);break}if(Y===void 0){if(Q===void 0)return;Y=cd(Q)}if(Te===!1||typeof Te=="function"&&(Te==null?void 0:Te([P[0]-H,P[1]],Y.map(Me=>Me.map(we=>{var Qe;return((Qe=we.rawValue)==null?void 0:Qe.toString())??""}))))!==!0)return;for(const[Me,we]of Y.entries()){if(Me+le>=Se)break;for(const[Qe,gt]of we.entries()){const Et=[Qe+ye,Me+le],[wn,xn]=Et;if(wn>=ge.length||xn>=Nt)continue;const yn=Jt(Et),kn=p(yn,Et,gt.rawValue,gt.formatted);kn!==void 0&&Ge.push(kn)}}}while(!1);rn(Ge),(O=qt.current)==null||O.damage(Ge.map(Me=>({cell:Me.location})))}},[K,Ee,Jt,B,vn.paste,lt,ge.length,rn,Nt,Te,H,Se]);Lt("paste",si,m,!1,!0);const _o=a.useCallback(async(d,p)=>{var T,L;if(!vn.copy)return;const b=p===!0||((T=lt.current)==null?void 0:T.contains(document.activeElement))===!0||((L=s.current)==null?void 0:L.contains(document.activeElement))===!0,F=B.columns,E=B.rows,P=(O,Y)=>{if(!_e)bl(O,Y,d);else{const Q=Y.map(me=>({kind:j.Text,data:x[me].title,displayData:x[me].title,allowOverlay:!1}));bl([Q,...O],Y,d)}};if(b&&St!==void 0){if(B.current!==void 0){let O=St(B.current.range,$t.current.signal);typeof O!="object"&&(O=await O()),P(O,io(B.current.range.x-H,B.current.range.x+B.current.range.width-H))}else if(E!==void 0&&E.length>0){const Y=[...E].map(Q=>{const me=St({x:H,y:Q,width:x.length,height:1},$t.current.signal);return typeof me=="object"?me[0]:me().then(ee=>ee[0])});if(Y.some(Q=>Q instanceof Promise)){const Q=await Promise.all(Y);P(Q,io(x.length))}else P(Y,io(x.length))}else if(F.length>0){const O=[],Y=[];for(const Q of F){let me=St({x:Q,y:0,width:1,height:Se},$t.current.signal);typeof me!="object"&&(me=await me()),O.push(me),Y.push(Q-H)}if(O.length===1)P(O[0],Y);else{const Q=O.reduce((me,ee)=>me.map((ye,le)=>[...ye,...ee[le]]));P(Q,Y)}}}},[x,St,B,vn.copy,H,lt,Se,_e]);Lt("copy",_o,m,!1,!1);const Cs=a.useCallback(async d=>{var b,F;if(!(!vn.cut||!(((b=lt.current)==null?void 0:b.contains(document.activeElement))===!0||((F=s.current)==null?void 0:F.contains(document.activeElement))===!0))&&(await _o(d),B.current!==void 0)){let E={current:{cell:B.current.cell,range:B.current.range,rangeStack:[]},rows:st.empty(),columns:st.empty()};const P=J==null?void 0:J(E);if(P===!1||(E=P===!0?E:P,E.current===void 0))return;no(E.current.range)}},[no,B,vn.cut,_o,lt,J]);Lt("cut",Cs,m,!1,!1);const xs=a.useCallback((d,p)=>{if(be!==void 0){H!==0&&(d=d.map(E=>[E[0]-H,E[1]])),be(d,p);return}if(d.length===0||p===-1)return;const[b,F]=d[p];f.current!==void 0&&f.current[0]===b&&f.current[1]===F||(f.current=[b,F],Xn(b,F,!1,!1))},[be,H,Xn]),[Sr,Mr]=((_i=It==null?void 0:It.current)==null?void 0:_i.cell)??[],Rr=a.useRef(Rt);Rr.current=Rt,a.useLayoutEffect(()=>{var d,p,b,F;li.current&&!Gt.current&&Sr!==void 0&&Mr!==void 0&&(Sr!==((p=(d=vo.current)==null?void 0:d.current)==null?void 0:p.cell[0])||Mr!==((F=(b=vo.current)==null?void 0:b.current)==null?void 0:F.cell[1]))&&Rr.current(Sr,Mr),Gt.current=!1},[Sr,Mr]);const Xi=B.current!==void 0&&(B.current.cell[0]>=ge.length||B.current.cell[1]>=Nt);a.useLayoutEffect(()=>{Xi&&Ut(Ar,!1)},[Xi,Ut]);const ks=a.useMemo(()=>bt===!0&&(Pe==null?void 0:Pe.tint)===!0?st.fromSingleSelection(Nt-1):st.empty(),[Nt,bt,Pe==null?void 0:Pe.tint]),Ss=a.useCallback(d=>typeof Bt=="boolean"?Bt:(Bt==null?void 0:Bt(d-H))??!0,[H,Bt]),Ms=a.useMemo(()=>{if(ei===void 0||s.current===null)return null;const{bounds:d,group:p}=ei,b=s.current.getBoundingClientRect();return a.createElement(Jc,{bounds:d,group:p,canvasBounds:b,onClose:()=>ti(void 0),onFinish:F=>{ti(void 0),V==null||V(p,F)}})},[V,ei]),Rs=Math.min(ge.length,oe+(on?1:0));a.useImperativeHandle(t,()=>({appendRow:(d,p)=>ko(d+H,p),updateCells:d=>{var p;return H!==0&&(d=d.map(b=>({cell:[b.cell[0]+H,b.cell[1]]}))),(p=qt.current)==null?void 0:p.damage(d)},getBounds:(d,p)=>{var b;if(!((s==null?void 0:s.current)===null||(lt==null?void 0:lt.current)===null)){if(d===void 0&&p===void 0){const F=s.current.getBoundingClientRect(),E=F.width/lt.current.clientWidth;return{x:F.x-lt.current.scrollLeft*E,y:F.y-lt.current.scrollTop*E,width:lt.current.scrollWidth*E,height:lt.current.scrollHeight*E}}return(b=qt.current)==null?void 0:b.getBounds((d??0)+H,p)}},focus:()=>{var d;return(d=qt.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":Vo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Vo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Vo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await _o(void 0,!0);break;case"paste":await si();break}},scrollTo:Rt,remeasureColumns:d=>{for(const p of d)xr(p+H)}}),[ko,xr,lt,_o,Vo,si,H,Rt]);const[Yi,Gi]=Cn??[],Es=a.useCallback(d=>{const[p,b]=d;if(b===-1){rt!=="none"&&(Z(st.fromSingleSelection(p),void 0,!1),Kt());return}Yi===p&&Gi===b||(ae({cell:d,range:{x:p,y:b,width:1,height:1}},!0,!1,"keyboard-nav"),Rt(p,b))},[rt,Kt,Rt,Yi,Gi,ae,Z]),[Is,Ds]=a.useState(!1),Ki=a.useRef(Ml(d=>{Ds(d)},5)),Fs=a.useCallback(()=>{Ki.current(!0),B.current===void 0&&B.columns.length===0&&B.rows.length===0&&c===void 0&&ae({cell:[H,wr],range:{x:H,y:wr,width:1,height:1}},!0,!1,"keyboard-select")},[wr,B,c,H,ae]),Hs=a.useCallback(()=>{Ki.current(!1)},[]),[Ts,As]=a.useMemo(()=>{let d;const p=(Ft==null?void 0:Ft.scrollbarWidthOverride)??yi(),b=Se+(bt?1:0);if(typeof fn=="number")d=Yt+b*fn;else{let E=0;const P=Math.min(b,10);for(let T=0;T<P;T++)E+=fn(T);E=Math.floor(E/P),d=Yt+b*E}d+=p;const F=ge.reduce((E,P)=>P.width+E,0)+p;return[`${Math.min(1e5,F)}px`,`${Math.min(1e5,d)}px`]},[ge,Ft==null?void 0:Ft.scrollbarWidthOverride,fn,Se,bt,Yt]),zs=a.useMemo(()=>Ma(qe),[qe]);return a.createElement(Yl.Provider,{value:qe},a.createElement(hd,{style:zs,className:ce,inWidth:y??Ts,inHeight:C??As},a.createElement(_c,{fillHandle:Bo,drawFocusRing:kt,experimental:Ft,fixedShadowX:Ht,fixedShadowY:At,getRowThemeOverride:un,headerIcons:In,imageWindowLoader:sr,initialSize:Bn,isDraggable:Dn,onDragLeave:Fn,onRowMoved:pn,overscrollX:Vr,overscrollY:_r,preventDiagonalScrolling:co,rightElement:uo,rightElementProps:fo,smoothScrollX:qn,smoothScrollY:Ln,className:ce,enableGroups:pt,onCanvasFocused:Fs,onCanvasBlur:Hs,canvasRef:s,onContextMenu:vs,theme:qe,cellXOffset:Jn,cellYOffset:wr,accessibilityHeight:Ot.height,onDragEnd:ws,columns:ge,nonGrowWidth:Vt,drawHeader:se,onColumnProposeMove:R,drawCell:q,disabledRows:ks,freezeColumns:Rs,lockColumns:H,firstColAccessible:H===0,getCellContent:Jt,minColumnWidth:Zt,maxColumnWidth:Wn,searchInputRef:l,showSearch:gr,onSearchClose:bo,highlightRegions:ls,getCellsForSelection:St,getGroupDetails:Jr,headerHeight:yo,isFocused:Is,groupHeaderHeight:pt?No:0,freezeTrailingRows:Ze+(bt&&(Pe==null?void 0:Pe.sticky)===!0?1:0),hasAppendRow:bt,onColumnResize:k,onColumnResizeEnd:G,onColumnResizeStart:de,onCellFocused:Es,onColumnMoved:gs,onDragStart:ms,onHeaderMenuClick:us,onHeaderIndicatorClick:fs,onItemHovered:ii,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:ds,onKeyDown:Vo,onKeyUp:je,onMouseDown:ss,onMouseUp:cs,onDragOverCell:Ue,onDrop:Mt,onSearchResultsChanged:xs,onVisibleRegionChanged:hs,clientSize:he,rowHeight:fn,searchResults:pe,searchValue:ke,onSearchValueChange:U,rows:Nt,scrollRef:lt,selection:B,translateX:Ot.tx,translateY:Ot.ty,verticalBorder:Ss,gridRef:qt,getCellRenderer:Ee,resizeIndicator:Kr}),Ms,r!==void 0&&a.createElement(a.Suspense,{fallback:null},a.createElement(Sd,{...r,validateCell:po,bloom:W,id:ps,getCellRenderer:Ee,className:(Ft==null?void 0:Ft.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Rn,imageEditorOverride:g,onFinishEditing:bs,markdownDivCreateNode:h,isOutsideClick:Pn}))))},Id=a.forwardRef(Ed),Cl=20,Dd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:j.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Fd(e,e.cell.data,wi(e.cell),e.cell.maxSize??Cl,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onClick:e=>{const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:l,height:s,x:c,y:u}=r,f=t.maxSize??Cl,m=Math.floor(r.y+s/2),g=Dl(f,s,i.cellVerticalPadding),w=Il(t.contentAlign??"center",c,l,i.cellHorizontalPadding,g),h=El(w,m,g),y=Fl(c+n,u+o,h);if(wi(t)&&y)return{...t,data:os(t.data)}},onPaste:(e,t)=>{let n=Br;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=xi),n===t.data?void 0:{...t,data:n}}};function Fd(e,t,n,o,r){if(!n&&t===Br)return;const{ctx:i,hoverAmount:l,theme:s,rect:c,highlighted:u,hoverX:f,hoverY:m,cell:{contentAlign:g}}=e,{x:w,y:h,width:y,height:C}=c;let x=!1;if(r>0){let v=n?1-r+r*l:.4;if(t===Br&&(v*=l),v===0)return;v<1&&(x=!0,i.globalAlpha=v)}Ii(i,s,t,w,h,y,C,u,f,m,o,g),x&&(i.globalAlpha=1)}const Hd=tn("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Td=e=>{const{bubbles:t}=e;return a.createElement(Hd,null,t.map((n,o)=>a.createElement("div",{key:o,className:"boe-bubble"},n)),a.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Ad=Td,zd={getAccessibilityString:e=>Hl(e.data),kind:j.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r).width+o+20,0)+2*n.cellHorizontalPadding-4,draw:e=>Ld(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement(Ad,{bubbles:t.data})},onPaste:()=>{}},Bd=4;function Ld(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:l,y:s,width:c,height:u}=n,f=20,m=8,g=Bd;let w=l+o.cellHorizontalPadding;const h=[];for(const y of t){if(w>l+c)break;const C=zo(y,r,o.baseFontFull).width;h.push({x:w,width:C}),w+=C+m*2+g}r.beginPath();for(const y of h)Mn(r,y.x,s+(u-f)/2,y.width+m*2,f,o.roundingRadius??f/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[y,C]of h.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[y],C.x+m,s+u/2+Un(r,o))}const Pd=tn("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Wd=e=>{const{drilldowns:t}=e;return a.createElement(Pd,null,t.map((n,o)=>a.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&a.createElement("img",{src:n.img}),a.createElement("div",null,n.text))))},$d=Wd,Od={getAccessibilityString:e=>Hl(e.data.map(t=>t.text)),kind:j.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+20+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Yd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement($d,{drilldowns:t.data})},onPaste:()=>{}},Nd=4,hi={};function Xd(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,l=n-i*2,s=4,c=n*r,u=o+i,f=o*3,m=(f+i*2)*r,g=`${e},${t},${r},${n}`;if(hi[g]!==void 0)return{el:hi[g],height:c,width:m,middleWidth:s*r,sideWidth:u*r,padding:i*r,dpr:r};const w=document.createElement("canvas"),h=w.getContext("2d");return h===null?null:(w.width=m,w.height=c,h.scale(r,r),hi[g]=w,h.beginPath(),Mn(h,i,i,f,l,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),Mn(h,i+.5,i+.5,f,l,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:w,height:c,width:m,sideWidth:u*r,middleWidth:o*r,padding:i*r,dpr:r})}function Yd(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:l,row:s}=e,{x:c,width:u}=n,f=o.baseFontFull,m=Wl(r,f),g=Math.min(n.height,Math.max(16,Math.ceil(m*o.lineHeight)*2)),w=Math.floor(n.y+(n.height-g)/2),h=g-10,y=8,C=Nd;let x=c+o.cellHorizontalPadding;const v=o.roundingRadius??6,I=Xd(o.bgCell,o.drilldownBorder,g,v),X=[];for(const N of t){if(x>c+u)break;const z=zo(N.text,r,f).width;let K=0;N.img!==void 0&&i.loadOrGetImage(N.img,l,s)!==void 0&&(K=h-8+4);const S=z+K+y*2;X.push({x,width:S}),x+=S+C}if(I!==null){const{el:N,height:A,middleWidth:z,sideWidth:K,width:S,dpr:$,padding:W}=I,D=K/$,R=W/$;for(const M of X){const re=Math.floor(M.x),te=Math.floor(M.width),ce=te-(D-R)*2;r.imageSmoothingEnabled=!1,r.drawImage(N,0,0,K,A,re-R,w,D,g),ce>0&&r.drawImage(N,K,0,z,A,re+(D-R),w,ce,g),r.drawImage(N,S-K,0,K,A,re+te-(D-R),w,D,g),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[N,A]of X.entries()){const z=t[N];let K=A.x+y;if(z.img!==void 0){const S=i.loadOrGetImage(z.img,l,s);if(S!==void 0){const $=h-8;let W=0,D=0,R=S.width,M=S.height;R>M?(W+=(R-M)/2,R=M):M>R&&(D+=(M-R)/2,M=R),r.beginPath(),Mn(r,K,w+g/2-$/2,$,$,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(S,W,D,R,M,K,w+g/2-$/2,$,$),r.restore(),K+=$+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(z.text,K,w+g/2+Un(r,o))}}const Gd={getAccessibilityString:e=>e.data.join(", "),kind:j.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Kd(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??oa;return a.createElement(r,{urls:t.data,canWrite:t.readonly!==!1,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},gi=4;function Kd(e,t,n,o){const{rect:r,col:i,row:l,theme:s,ctx:c,imageLoader:u}=e,{x:f,y:m,height:g,width:w}=r,h=g-s.cellVerticalPadding*2,y=[];let C=0;for(let v=0;v<t.length;v++){const I=t[v];if(I.length===0)continue;const X=u.loadOrGetImage(I,i,l);if(X!==void 0){y[v]=X;const N=X.width*(h/X.height);C+=N+gi}}if(C===0)return;C-=gi;let x=f+s.cellHorizontalPadding;o==="right"?x=Math.floor(f+w-s.cellHorizontalPadding-C):o==="center"&&(x=Math.floor(f+w/2-C/2));for(const v of y){if(v===void 0)continue;const I=v.width*(h/v.height);n>0&&(c.beginPath(),Mn(c,x,m+s.cellVerticalPadding,I,h,n),c.save(),c.clip()),c.drawImage(v,x,m+s.cellVerticalPadding,I,h),n>0&&c.restore(),x+=I+gi}}function Ud(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Vd={getAccessibilityString:()=>"",kind:j.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Ud(n,o)*t.skeletonWidthVariability));const c=l.cellHorizontalPadding,u=t.skeletonHeight??Math.min(18,i.height-2*l.cellVerticalPadding);Mn(r,i.x+c,i.y+(i.height-u)/2,s,u,l.roundingRadius??3),r.fillStyle=so(l.textDark,.1),r.fill()},onPaste:()=>{}},_d=()=>e=>e.targetWidth,xl=tn("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[_d(),"px"]}}),qd=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:l,validatedSelection:s}=e,c=t.data,u=t.readonly===!0,[f,m]=a.useState(c===""||o),g=a.useCallback(()=>{m(h=>!h)},[]),w=c?"gdg-ml-6":"";return f?a.createElement(xl,{targetWidth:i.width-20},a.createElement(Nr,{autoFocus:!0,highlight:!1,validatedSelection:s,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),a.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${w}`,onClick:()=>l(t)},a.createElement(js,null))):a.createElement(xl,{targetWidth:i.width},a.createElement(ia,{contents:c,createNode:r}),!u&&a.createElement(a.Fragment,null,a.createElement("div",{className:"spacer"}),a.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${w}`,onClick:g},a.createElement(ki,null))),a.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},jd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:lr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Sn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:l,validatedSelection:s}=e;return a.createElement(qd,{onFinish:r,targetRect:o,value:n,validatedSelection:s,onChange:c=>t({...n,data:c.target.value}),forceEditMode:l,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Zd={getAccessibilityString:e=>e.row.toString(),kind:cn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Jd,measure:()=>44,draw:e=>eu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:l}=t,s=n.drawHandle?7+(i-7)/2:i/2,c=l/2;if(Math.abs(o-s)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Jd(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=Qd,n.textAlign="center",i}function Qd(e){const{ctx:t}=e;t.textAlign="start"}function eu(e,t,n,o,r,i){const{ctx:l,rect:s,hoverAmount:c,theme:u}=e,{x:f,y:m,width:g,height:w}=s,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){l.globalAlpha=h;const y=7*(n?c:1);if(Ii(l,u,n,r?f+y:f,m,r?g-y:g,w,!0,void 0,void 0,18,"center",i),r){l.globalAlpha=c,l.beginPath();for(const C of[3,6])for(const x of[-5,-1,3])l.rect(f+C,m+w/2+x,2,2);l.fillStyle=u.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const y=t.toString(),C=u.markerFontFull,x=f+g/2;o==="both"&&c!==0&&(l.globalAlpha=1-c),l.fillStyle=u.textLight,l.font=C,l.fillText(y,x,m+w/2+Un(l,C)),c!==0&&(l.globalAlpha=1)}}const tu={getAccessibilityString:()=>"",kind:cn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>nu(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function nu(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:l,spriteManager:s}=e,{x:c,y:u,width:f,height:m}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,u+1,f,m-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const g=t!=="";let w=0;if(n!==void 0){const y=m-8,C=c+8/2,x=u+8/2;s.drawSprite(n,"normal",o,C,x,y,l,g?1:i),w=y}else{w=24;const h=12,y=g?h:i*h,C=g?0:(1-i)*h*.5,x=l.cellHorizontalPadding+4;y>0&&(o.moveTo(c+x+C,u+m/2),o.lineTo(c+x+C+y,u+m/2),o.moveTo(c+x+C+y*.5,u+m/2-y*.5),o.lineTo(c+x+C+y*.5,u+m/2+y*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,w+c+l.cellHorizontalPadding+.5,u+m/2+Un(o,l)),o.beginPath()}const ou=a.lazy(async()=>await Sl(()=>import("./number-overlay-editor-3ljU3NGx.js"),__vite__mapDeps([8,1,3,9]),import.meta.url)),ru={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Number,needsHover:!1,needsHoverPosition:!1,useLabel:!0,drawPrep:lr,draw:e=>Sn(e,e.cell.displayData,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return a.createElement(a.Suspense,{fallback:null},a.createElement(ou,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},iu={getAccessibilityString:()=>"",measure:()=>108,kind:j.Protected,needsHover:!1,needsHoverPosition:!1,draw:lu,onPaste:()=>{}};function lu(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:l}=o;t.beginPath();const s=2.5;let c=r+n.cellHorizontalPadding+s;const u=i+l/2,f=Math.cos(el(30))*s,m=Math.sin(el(30))*s;for(let g=0;g<12;g++)t.moveTo(c,u-s),t.lineTo(c,u+s),t.moveTo(c+f,u-m),t.lineTo(c-f,u+m),t.moveTo(c-f,u-m),t.lineTo(c+f,u+m),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const su={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>lr(e,t,e.theme.textLight),draw:e=>Sn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return vt.createElement(Nr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},au={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:lr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:l,overrideCursor:s}=e,{displayData:c,contentAlign:u,hoverEffect:f,allowWrapping:m}=t;if(f===!0&&n>0){r.textBaseline="alphabetic";const g=l.cellHorizontalPadding,w=l.cellVerticalPadding,h=zo(c,r,l.baseFontFull,"alphabetic"),y=i.height-w,C=Math.min(y,h.actualBoundingBoxAscent*2.5);r.beginPath(),Mn(r,i.x+g/2,i.y+(i.height-C)/2+1,h.width+g*3,C-1,l.roundingRadius??4),r.globalAlpha=n,r.fillStyle=so(l.textDark,.1),r.fill(),r.globalAlpha=1,r.fillStyle=l.textDark,r.textBaseline="middle",s==null||s("text")}Sn(e,c,u,m,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return a.createElement(Nr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:l=>o({...r,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},cu=tn("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),du=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:l}=e,[s,c]=a.useState(!r&&(t===""||o)),u=a.useCallback(()=>{c(!0)},[]);return s?a.createElement(Nr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):a.createElement(cu,null,a.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!r&&a.createElement("div",{className:"gdg-edit-icon",onClick:u},a.createElement(ki,null)),a.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},uu=du;function kl(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?r=t.width-l-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-l/2),{x:r,y:i,width:l,height:s}}const fu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:lr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:l,ctx:s}=e,c=t.displayData??t.data,u=t.hoverEffect===!0;if(o!==void 0&&u&&r!==void 0&&i!==void 0){const f=zo(c,s,n.baseFontFull),m=kl(f,l,n,t.contentAlign),{x:g,y:w,width:h,height:y}=m;if(r>=g-4&&r<=g-4+h+8&&i>=w-4&&i<=w-4+y+8){const C=Un(s,n.baseFontFull);o("pointer");const x=5,v=w-C;s.beginPath(),s.moveTo(l.x+g,Math.floor(l.y+v+y+x)+.5),s.lineTo(l.x+g+h,Math.floor(l.y+v+y+x)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,Sn({...e,rect:{...l,x:l.x-1}},c,t.contentAlign),Sn({...e,rect:{...l,x:l.x-2}},c,t.contentAlign),Sn({...e,rect:{...l,x:l.x+1}},c,t.contentAlign),Sn({...e,rect:{...l,x:l.x+2}},c,t.contentAlign),s.restore()}}s.fillStyle=u?n.linkColor:n.textDark,Sn(e,c,t.contentAlign)},onClick:e=>{const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return;const s=Ll(l,i.baseFontFull);if(s===void 0)return;const c=kl(s,n,i,t.contentAlign);lo({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)&&t.onClickUri(e)},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return a.createElement(uu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},hu=[Zd,tu,Dd,zd,Od,Gd,Vd,jd,ru,iu,su,au,fu],mi=[];class gu extends Ol{constructor(){super(...arguments);Oe(this,"imageLoaded",()=>{});Oe(this,"loadedLocations",[]);Oe(this,"cache",{});Oe(this,"sendLoaded",Xs(()=>{this.imageLoaded(new nr(this.loadedLocations)),this.loadedLocations=[]},20));Oe(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let l=0;l<r.cells.length;l++){const s=r.cells[l];if(this.isInWindow(s)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let l=!1;const s=mi.pop()??new Image;let c=!1;const u={img:void 0,cells:[bn(o,r)],url:n,cancel:()=>{c||(c=!0,mi.length<12?mi.unshift(s):l||(s.src=""))}},f=new Promise(m=>s.addEventListener("load",()=>m(null)));requestAnimationFrame(async()=>{try{s.src=n,await f,await s.decode();const m=this.cache[i];if(m!==void 0&&!c){m.img=s;for(const g of m.cells)this.loadedLocations.push(Ei(g));l=!0,this.sendLoaded()}}catch{u.cancel()}}),this.cache[i]=u}loadOrGetImage(n,o,r){const i=n,l=this.cache[i];if(l!==void 0){const s=bn(o,r);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,r,i)}}const mu=gu,wu=(e,t)=>{const n=a.useMemo(()=>({...nc,...e.headerIcons}),[e.headerIcons]),o=a.useMemo(()=>e.imageWindowLoader??new mu,[e.imageWindowLoader]);return a.createElement(Id,{...e,renderers:hu,headerIcons:n,ref:t,imageWindowLoader:o})},Iu=a.forwardRef(wu);export{qc as C,Iu as D,j as G,Yl as T,Nr as a,en as b,Mu as c,Ru as d,ku as e,Io as f,Un as g,Zi as h,Su as i,Do as j,Us as k,Ma as l,zo as m,To as p,Mn as r,Eu as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./data-grid-overlay-editor-K62UQj4H.js","./index-BMVQvedj.js","./index-wocATsGp.js","./marked.esm-dbrxtycE.js","./iframe-0-Di66Z3.js","./throttle-7EuXLZa7.js","./_baseIteratee-WTHxv43n.js","./flatten-qRvRBp6y.js","./number-overlay-editor-3ljU3NGx.js","./react-number-format.es-2Vaki8Uh.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}