var Al=Object.defineProperty;var Gl=(e,o,l)=>o in e?Al(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l;var un=(e,o,l)=>(Gl(e,typeof o!="symbol"?o+"":o,l),l);import{s as gn,a as to,j as q,F as Zn}from"./marked.esm-dbrxtycE.js";import{r as i,R as Me}from"./index-BMVQvedj.js";import{_ as Pl}from"./iframe-AiCMyApU.js";import{G as Q,b as Go,i as Ho,r as Jn,c as Po,C as X,g as sr,d as Ol,w as kt,e as Kl,f as Nl,m as dn,h as Qn,I as Do,p as Wl,j as Ul,t as Bl,k as Vl,l as At,o as er,n as tr,q as _l,s as Eo,v as Io,x as Xl,y as Yl,z as jl,A as ql,B as Zl,D as or,E as eo,F as Jl,H as Ql,J as nr,K as ei,u as fn,L as ti,M as oi,T as ni,N as rr,O as ri,P as li}from"./image-window-loader-nvLgsaxj.js";import{c as Rt,r as Gt,d as ii}from"./throttle-7EuXLZa7.js";import{u as ci,f as lr}from"./flatten-qRvRBp6y.js";import{G as si}from"./scrolling-data-grid-SWWsfOyf.js";const Z='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',ai=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}<rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},ui=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}<rect x="2" y="2" width="16" height="16" rx="4" fill="${l}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},di=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},fi=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},hi=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${l}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},ar=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},gi=e=>{const o=e.bgColor;return`${Z}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},vi=ar,mi=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},Ci=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},wi=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},pi=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${l}"/>
  </svg>`},bi=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},yi=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},xi=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},Mi=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},Ri=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${l}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${l}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},ki=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${l}"/>
</svg>`},Si=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},zi=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},Ti=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},Li=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},Hi=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},Di=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},Ei=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},Ii=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},$i=e=>{const o=e.fgColor,l=e.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},Fi=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},Ai=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},Gi={headerRowID:ai,headerNumber:di,headerCode:ui,headerString:fi,headerBoolean:hi,headerAudioUri:vi,headerVideoUri:mi,headerEmoji:Ci,headerImage:wi,headerUri:ar,headerPhone:pi,headerMarkdown:bi,headerDate:yi,headerTime:xi,headerEmail:Mi,headerReference:Ri,headerIfThenElse:ki,headerSingleValue:Si,headerLookup:zi,headerTextTemplate:Ti,headerMath:Li,headerRollup:Hi,headerJoinStrings:Di,headerSplitString:Ei,headerGeoDistance:Ii,headerArray:$i,rowOwnerOverlay:Fi,protectedColumnOverlay:Ai,renameIcon:gi},Pi=gn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),Oi=q("svg",{className:"button-icon",viewBox:"0 0 512 512",children:q("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})}),Ki=q("svg",{className:"button-icon",viewBox:"0 0 512 512",children:q("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})}),Ni=q("svg",{className:"button-icon",viewBox:"0 0 512 512",children:q("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})}),Wi=10,Ui=e=>{const{canvasRef:o,cellYOffset:l,rows:u,columns:C,searchInputRef:M,searchValue:b,searchResults:T,onSearchValueChange:k,getCellsForSelection:w,onSearchResultsChanged:p,showSearch:S=!1,onSearchClose:z}=e,[N]=i.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[O,le]=i.useState(""),ce=b??O,V=i.useCallback($=>{le($),k==null||k($)},[k]),[I,W]=i.useState(),Ce=i.useRef(I);Ce.current=I,i.useEffect(()=>{T!==void 0&&(T.length>0?W($=>({rowsSearched:u,results:T.length,selectedIndex:($==null?void 0:$.selectedIndex)??-1})):W(void 0))},[u,T]);const se=i.useRef();se.current===void 0&&(se.current=new AbortController);const de=i.useRef(),[Y,ee]=i.useState([]),te=T??Y,_=i.useCallback(()=>{de.current!==void 0&&(window.cancelAnimationFrame(de.current),de.current=void 0,se.current.abort())},[]),qe=i.useRef(l);qe.current=l;const He=i.useCallback($=>{const ie=new RegExp($.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ae=qe.current,Ge=Math.min(10,u),Ze=0;W(void 0),ee([]);const ft=[],no=async()=>{var he;if(w===void 0)return;const Kt=performance.now(),Ko=u-Ze;let ht=w({x:0,y:ae,width:C.length,height:Math.min(Ge,Ko,u-ae)},se.current.signal);typeof ht=="function"&&(ht=await ht());let Nt=!1;for(const[Ee,No]of ht.entries())for(const[Wo,Qe]of No.entries()){let Pe;switch(Qe.kind){case Q.Text:case Q.Number:Pe=Qe.displayData;break;case Q.Uri:case Q.Markdown:Pe=Qe.data;break;case Q.Boolean:Pe=typeof Qe.data=="boolean"?Qe.data.toString():void 0;break;case Q.Image:case Q.Bubble:Pe=Qe.data.join("🐳");break;case Q.Custom:Pe=Qe.copyData;break}Pe!==void 0&&ie.test(Pe)&&(ft.push([Wo,Ee+ae]),Nt=!0)}const gt=performance.now();Nt&&ee([...ft]),Ze+=ht.length,Go(Ze<=u);const nt=((he=Ce.current)==null?void 0:he.selectedIndex)??-1;W({results:ft.length,rowsSearched:Ze,selectedIndex:nt}),p==null||p(ft,nt),ae+Ge>=u?ae=0:ae+=Ge;const vt=gt-Kt,mt=Math.max(vt,1),Je=Wi/mt;Ge=Math.ceil(Ge*Je),Ze<u&&ft.length<1e3&&(de.current=window.requestAnimationFrame(no))};_(),de.current=window.requestAnimationFrame(no)},[_,C.length,w,p,u]),Be=i.useCallback(()=>{var $;z==null||z(),W(void 0),ee([]),p==null||p([],-1),_(),($=o==null?void 0:o.current)==null||$.focus()},[_,o,z,p]),Pt=i.useCallback($=>{V($.target.value),T===void 0&&($.target.value===""?(W(void 0),ee([]),_()):He($.target.value))},[He,_,V,T]);i.useEffect(()=>{S&&M.current!==null&&(V(""),M.current.focus({preventScroll:!0}))},[S,M,V]);const De=i.useCallback($=>{var ae;if((ae=$==null?void 0:$.stopPropagation)==null||ae.call($),I===void 0)return;const ie=(I.selectedIndex+1)%I.results;W({...I,selectedIndex:ie}),p==null||p(te,ie)},[I,p,te]),Se=i.useCallback($=>{var ae;if((ae=$==null?void 0:$.stopPropagation)==null||ae.call($),I===void 0)return;let ie=(I.selectedIndex-1)%I.results;ie<0&&(ie+=I.results),W({...I,selectedIndex:ie}),p==null||p(te,ie)},[p,te,I]),Ot=i.useCallback($=>{($.ctrlKey||$.metaKey)&&$.nativeEvent.code==="KeyF"||$.key==="Escape"?(Be(),$.stopPropagation(),$.preventDefault()):$.key==="Enter"&&($.shiftKey?Se():De())},[Be,De,Se]);i.useEffect(()=>()=>{_()},[_]);const[Ae,oo]=i.useState(!1);i.useEffect(()=>{if(S)oo(!0);else{const $=setTimeout(()=>oo(!1),150);return()=>clearTimeout($)}},[S]);const Ve=i.useMemo(()=>{if(!S&&!Ae)return null;let $;I!==void 0&&($=I.results>=1e3?"over 1000":`${I.results} result${I.results!==1?"s":""}`,I.selectedIndex>=0&&($=`${I.selectedIndex+1} of ${$}`));const ie=Ze=>{Ze.stopPropagation()},Ge={width:`${Math.floor(((I==null?void 0:I.rowsSearched)??0)/u*100)}%`};return to(Pi,{className:S?"":"out",onMouseDown:ie,onMouseMove:ie,onMouseUp:ie,onClick:ie,children:[to("div",{className:"gdg-search-bar-inner",children:[q("input",{id:N,"aria-hidden":!S,"data-testid":"search-input",ref:M,onChange:Pt,value:ce,tabIndex:S?void 0:-1,onKeyDownCapture:Ot}),q("button",{"aria-label":"Previous Result","aria-hidden":!S,tabIndex:S?void 0:-1,onClick:Se,disabled:((I==null?void 0:I.results)??0)===0,children:Oi}),q("button",{"aria-label":"Next Result","aria-hidden":!S,tabIndex:S?void 0:-1,onClick:De,disabled:((I==null?void 0:I.results)??0)===0,children:Ki}),z!==void 0&&q("button",{"aria-label":"Close Search","aria-hidden":!S,"data-testid":"search-close-button",tabIndex:S?void 0:-1,onClick:Be,children:Ni})]}),I!==void 0?to(Zn,{children:[q("div",{className:"gdg-search-status",children:q("div",{"data-testid":"search-result-area",children:$})}),q("div",{className:"gdg-search-progress",style:Ge})]}):q("div",{className:"gdg-search-status",children:q("label",{htmlFor:N,children:"Type to search"})})]})},[S,Ae,I,u,N,M,Pt,ce,Ot,Se,De,z,Be]);return to(Zn,{children:[q(si,{prelightCells:te,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Ve]})},Bi=Ui;class Vi extends i.PureComponent{constructor(){super(...arguments);un(this,"wrapperRef",i.createRef());un(this,"clickOutside",l=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(l))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(l.target)){let u=l.target;for(;u!==null;){if(u.classList.contains("click-outside-ignore"))return;u=u.parentElement}this.props.onClickOutside()}})}componentDidMount(){document.addEventListener("touchend",this.clickOutside,!0),document.addEventListener("mousedown",this.clickOutside,!0),document.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){document.removeEventListener("touchend",this.clickOutside,!0),document.removeEventListener("mousedown",this.clickOutside,!0),document.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:l,isOutsideClick:u,...C}=this.props;return q("div",{...C,ref:this.wrapperRef,children:this.props.children})}}const _i=()=>e=>Math.max(16,e.targetHeight-10),Xi=gn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[_i(),"px"]}}),Yi=e=>{const{bounds:o,group:l,onClose:u,canvasBounds:C,onFinish:M}=e,[b,T]=Me.useState(l);return q(Vi,{style:{position:"absolute",left:o.x-C.left+1,top:o.y-C.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:u,children:q(Xi,{targetHeight:o.height,"data-testid":"group-rename-input",value:b,onBlur:u,onFocus:k=>k.target.setSelectionRange(0,b.length),onChange:k=>T(k.target.value),onKeyDown:k=>{k.key==="Enter"?M(b):k.key==="Escape"&&u()},autoFocus:!0})})},hn=150;function ji(e,o,l,u){var M;const C=u(o);return((M=C==null?void 0:C.measure)==null?void 0:M.call(C,e,o,l))??hn}function ur(e,o,l,u,C,M,b,T,k){let w=0;const p=C===void 0?[]:C.map(z=>{const N=ji(e,z[u],o,k);return w=Math.max(w,N),N});if(p.length>5&&T){w=0;let z=0;for(const O of p)z+=O;const N=z/p.length;for(let O=0;O<p.length;O++)p[O]>=N*2?p[O]=0:w=Math.max(w,p[O])}w=Math.max(w,e.measureText(l.title).width+o.cellHorizontalPadding*2+(l.icon===void 0?0:28));const S=Math.max(Math.ceil(M),Math.min(Math.floor(b),Math.ceil(w)));return{...l,width:S}}function qi(e,o,l,u,C,M,b,T,k){const w=i.useRef(o),p=i.useRef(l),S=i.useRef(b);w.current=o,p.current=l,S.current=b;const[z,N]=i.useMemo(()=>{if(typeof window>"u")return[null,null];const I=document.createElement("canvas");return I.style.display="none",I.style.opacity="0",I.style.position="fixed",[I,I.getContext("2d",{alpha:!1})]},[]);i.useLayoutEffect(()=>(z&&document.documentElement.append(z),()=>{z==null||z.remove()}),[z]);const O=i.useRef({}),le=i.useRef(),[ce,V]=i.useState();return i.useLayoutEffect(()=>{const I=p.current;if(I===void 0||e.every(Ho))return;let W=Math.max(1,10-Math.floor(e.length/1e4)),Ce=0;W<w.current&&W>1&&(W--,Ce=1);const se={x:0,y:0,width:e.length,height:Math.min(w.current,W)},de={x:0,y:w.current-1,width:e.length,height:1};(async()=>{const ee=I(se,k.signal),te=Ce>0?I(de,k.signal):void 0;let _;typeof ee=="object"?_=ee:_=await Jn(ee),te!==void 0&&(typeof te=="object"?_=[..._,...te]:_=[..._,...await Jn(te)]),le.current=e,V(_)})()},[k.signal,e]),i.useMemo(()=>{let W=e.every(Ho)?e:N===null?e.map(Y=>Ho(Y)?Y:{...Y,width:hn}):(N.font=S.current.baseFontFull,e.map((Y,ee)=>{if(Ho(Y))return Y;if(O.current[Y.id]!==void 0)return{...Y,width:O.current[Y.id]};if(ce===void 0||le.current!==e||Y.id===void 0)return{...Y,width:hn};const te=ur(N,b,Y,ee,ce,C,M,!0,T);return O.current[Y.id]=te.width,te})),Ce=0,se=0;const de=[];for(const[Y,ee]of W.entries())Ce+=ee.width,ee.grow!==void 0&&ee.grow>0&&(se+=ee.grow,de.push(Y));if(Ce<u&&de.length>0){const Y=[...W],ee=u-Ce;let te=ee;for(let _=0;_<de.length;_++){const qe=de[_],He=(W[qe].grow??0)/se,Be=_===de.length-1?te:Math.min(te,Math.floor(ee*He));Y[qe]={...W[qe],growOffset:Be,width:W[qe].width+Be},te-=Be}W=Y}return{sizedColumns:W,nonGrowWidth:Ce}},[u,e,N,ce,b,C,M,T])}function Zi(e,o){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===o.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===o.keyCode:e===o.key}function A(e,o,l){const u=dr(e,o);return u&&(l.didMatch=!0),u}function dr(e,o){if(e.length===0)return!1;if(e.includes("|")){const k=e.split("|");for(const w of k)if(dr(w,o))return!0;return!1}let l=!1,u=!1,C=!1,M=!1;const b=e.split("+"),T=b.pop();if(!Zi(T,o))return!1;if(b[0]==="any")return!0;for(const k of b)switch(k){case"ctrl":l=!0;break;case"shift":u=!0;break;case"alt":C=!0;break;case"meta":M=!0;break;case"primary":Po.value?M=!0:l=!0;break}return o.altKey===C&&o.ctrlKey===l&&o.shiftKey===u&&o.metaKey===M}function Ji(e,o,l,u,C,M){const b=Me.useCallback((w,p,S,z)=>{var I;(M==="cell"||M==="multi-cell")&&w!==void 0&&(w={...w,range:{x:w.cell[0],y:w.cell[1],width:1,height:1}});const N=l==="mixed"&&(S||z==="drag"),O=u==="mixed"&&N,le=C==="mixed"&&N;let ce={current:w===void 0?void 0:{...w,rangeStack:z==="drag"?((I=e.current)==null?void 0:I.rangeStack)??[]:[]},columns:O?e.columns:X.empty(),rows:le?e.rows:X.empty()};S&&(M==="multi-rect"||M==="multi-cell")&&ce.current!==void 0&&e.current!==void 0&&(ce={...ce,current:{...ce.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),o(ce,p)},[u,e,l,M,C,o]),T=Me.useCallback((w,p,S)=>{w=w??e.rows,p!==void 0&&(w=w.add(p));let z;if(C==="exclusive"&&w.length>0)z={current:void 0,columns:X.empty(),rows:w};else{const N=S&&l==="mixed",O=S&&u==="mixed";z={current:N?e.current:void 0,columns:O?e.columns:X.empty(),rows:w}}o(z,!1)},[u,e,l,C,o]),k=Me.useCallback((w,p,S)=>{w=w??e.columns,p!==void 0&&(w=w.add(p));let z;if(u==="exclusive"&&w.length>0)z={current:void 0,rows:X.empty(),columns:w};else{const N=S&&l==="mixed",O=S&&C==="mixed";z={current:N?e.current:void 0,rows:O?e.rows:X.empty(),columns:w}}o(z,!1)},[u,e,l,C,o]);return[b,T,k]}function Qi(e,o,l,u,C){const M=i.useCallback(w=>{if(e===!0){const p=[];for(let S=w.y;S<w.y+w.height;S++){const z=[];for(let N=w.x;N<w.x+w.width;N++)N<0||S>=C?z.push({kind:Q.Loading,allowOverlay:!1}):z.push(o([N,S]));p.push(z)}return p}return(e==null?void 0:e(w,u.signal))??[]},[u.signal,o,e,C]),b=e!==void 0?M:void 0,T=i.useCallback(w=>{if(b===void 0)return[];const p={...w,x:w.x-l};if(p.x<0){p.x=0,p.width--;const S=b(p,u.signal);return typeof S=="function"?async()=>(await S()).map(z=>[{kind:Q.Loading,allowOverlay:!1},...z]):S.map(z=>[{kind:Q.Loading,allowOverlay:!1},...z])}return b(p,u.signal)},[u.signal,b,l]);return[e!==void 0?T:void 0,b]}function ir(e){return typeof e=="string"?e:`${e}px`}const ec=()=>e=>e.innerWidth,tc=()=>e=>e.innerHeight,oc=gn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[ec()],"w2q57ts-1":[tc()]}}),nc=e=>{const{inWidth:o,inHeight:l,children:u,...C}=e;return q(oc,{innerHeight:ir(l),innerWidth:ir(o),...C,children:u})},rc=2,lc=1300;function ic(e,o,l){const u=Me.useRef(0),[C,M]=e??[0,0];Me.useEffect(()=>{if(C===0&&M===0){u.current=0;return}let b=!1,T=0;const k=w=>{var p;if(!b){if(T===0)T=w;else{const S=w-T;u.current=Math.min(1,u.current+S/lc);const z=u.current**1.618*S*rc;(p=o.current)==null||p.scrollBy(C*z,M*z),T=w,l==null||l()}window.requestAnimationFrame(k)}};return window.requestAnimationFrame(k),()=>{b=!0}},[o,C,M,l])}function cc({rowHeight:e,headerHeight:o,groupHeaderHeight:l,theme:u,overscrollX:C,overscrollY:M,scaleToRem:b,remSize:T}){const[k,w,p,S,z,N]=Me.useMemo(()=>{if(!b||T===16)return[e,o,l,u,C,M];const O=T/16,le=e,ce=sr();return[typeof le=="number"?le*O:V=>Math.ceil(le(V)*O),Math.ceil(o*O),Math.ceil(l*O),{...u,headerIconSize:((u==null?void 0:u.headerIconSize)??ce.headerIconSize)*O,cellHorizontalPadding:((u==null?void 0:u.cellHorizontalPadding)??ce.cellHorizontalPadding)*O,cellVerticalPadding:((u==null?void 0:u.cellVerticalPadding)??ce.cellVerticalPadding)*O},Math.ceil((C??0)*O),Math.ceil((M??0)*O)]},[l,o,C,M,T,e,b,u]);return{rowHeight:k,headerHeight:w,groupHeaderHeight:p,theme:S,overscrollX:z,overscrollY:N}}const dt={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function G(e,o){return e===!0?o:e===!1?"":e}function cr(e){const o=Po.value;return{activateCell:G(e.activateCell," |Enter|shift+Enter"),clear:G(e.clear,"any+Escape"),closeOverlay:G(e.closeOverlay,"any+Escape"),acceptOverlayDown:G(e.acceptOverlayDown,"Enter"),acceptOverlayUp:G(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:G(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:G(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:G(e.delete,o?"Backspace|Delete":"Delete"),downFill:G(e.downFill,"primary+_68"),scrollToSelectedCell:G(e.scrollToSelectedCell,"primary+Enter"),goDownCell:G(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:G(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:G(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:G(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:G(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:G(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:G(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:G(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:G(e.goToFirstCell,"primary+Home"),goToFirstColumn:G(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:G(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:G(e.goToLastCell,"primary+End"),goToLastColumn:G(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:G(e.goToLastRow,"primary+ArrowDown"),goToNextPage:G(e.goToNextPage,"PageDown"),goToPreviousPage:G(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:G(e.rightFill,"primary+_82"),search:G(e.search,"primary+f"),selectAll:G(e.selectAll,"primary+a"),selectColumn:G(e.selectColumn,"ctrl+ "),selectGrowDown:G(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:G(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:G(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:G(e.selectGrowUp,"shift+ArrowUp"),selectRow:G(e.selectRow,"shift+ "),selectToFirstCell:G(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:G(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:G(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:G(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:G(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:G(e.selectToLastRow,"primary+shift+ArrowDown")}}function sc(e){const o=Ol(e);return Me.useMemo(()=>{if(o===void 0)return cr(dt);const l={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??dt.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??dt.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??dt.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??dt.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??dt.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??dt.selectToLastCell};return cr({...dt,...l})},[o])}function ac(e){function o(u,C,M){if(typeof u=="number")return{headerIndex:u,isCollapsed:!1,depth:C,path:M};const b={headerIndex:u.headerIndex,isCollapsed:u.isCollapsed,depth:C,path:M};return u.subGroups!==void 0&&(b.subGroups=u.subGroups.map((T,k)=>o(T,C+1,[...M,k])).sort((T,k)=>T.headerIndex-k.headerIndex)),b}return e.map((u,C)=>o(u,0,[C])).sort((u,C)=>u.headerIndex-C.headerIndex)}function vn(e,o){const l=[];function u(b,T,k=!1){let w=T!==null?T-b.headerIndex:o-b.headerIndex;if(b.subGroups!==void 0&&(w=b.subGroups[0].headerIndex-b.headerIndex),w--,l.push({headerIndex:b.headerIndex,contentIndex:-1,skip:k,isCollapsed:b.isCollapsed,depth:b.depth,path:b.path,rows:w}),b.subGroups)for(let p=0;p<b.subGroups.length;p++){const S=p<b.subGroups.length-1?b.subGroups[p+1].headerIndex:T;u(b.subGroups[p],S,k||b.isCollapsed)}}const C=ac(e.groups);for(let b=0;b<C.length;b++){const T=b<C.length-1?C[b+1].headerIndex:null;u(C[b],T)}let M=0;for(const b of l)b.contentIndex=M,M+=b.rows;return l.filter(b=>b.skip===!1).map(b=>{const{skip:T,...k}=b;return k})}function Oo(e,o){if(o===void 0||vn.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let l=e;for(const u of o){if(l===0)return{path:[...u.path,-1],originalIndex:u.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:u.rows};if(l--,!u.isCollapsed){if(l<u.rows)return{path:[...u.path,l],originalIndex:u.headerIndex+l,isGroupHeader:!1,groupIndex:l,contentIndex:u.contentIndex+l,groupRows:u.rows};l-=u.rows}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function uc(e,o,l,u){const C=Me.useMemo(()=>e===void 0?void 0:vn(e,o),[e,o]),M=Me.useMemo(()=>C===void 0?o:C.reduce((w,p)=>w+(p.isCollapsed?1:p.rows+1),0),[C,o]),b=Me.useMemo(()=>e===void 0||typeof l=="number"&&e.height===l?l:w=>{const{isGroupHeader:p}=Oo(w,C);return p?e.height:typeof l=="number"?l:l(w)},[C,e,l]),T=Me.useCallback(w=>{if(C===void 0)return w;let p=w;for(const S of C){if(p===0)return;if(p--,!S.isCollapsed){if(p<S.rows)return S.contentIndex+p;p-=S.rows}}return w},[C]),k=kt(u??(e==null?void 0:e.themeOverride),Me.useCallback(w=>{if(e===void 0)return u==null?void 0:u(w,w,w);if(u===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:p,contentIndex:S,groupIndex:z}=Oo(w,C);return p?e.themeOverride:u==null?void 0:u(w,z,S)},[C,u,e]));return e===void 0?{rowHeight:b,rows:o,rowNumberMapper:T,getRowThemeOverride:k}:{rowHeight:b,rows:M,rowNumberMapper:T,getRowThemeOverride:k}}function dc(e,o){const l=Me.useMemo(()=>e===void 0?void 0:vn(e,o),[e,o]);return{getRowGroupingForPath:hr,updateRowGroupingByPath:fr,mapper:Me.useCallback(u=>{if(typeof u=="number")return Oo(u,l);const C=Oo(u[1],l);return{...C,originalIndex:[u[0],C.originalIndex]}},[l])}}function fr(e,o,l){const[u,...C]=o;return C[0]===-1?e.map((M,b)=>b===u?{...M,...l}:M):e.map((M,b)=>b===u?{...M,subGroups:fr(M.subGroups??[],C,l)}:M)}function hr(e,o){const[l,...u]=o;return u[0]===-1?e[l]:hr(e[l].subGroups??[],u)}function fc(e,o){const[l]=i.useState(()=>({value:e,callback:o,facade:{get current(){return l.value},set current(u){const C=l.value;C!==u&&(l.value=u,l.callback(u,C))}}}));return l.callback=o,l.facade}function hc(e,o,l,u,C){const[M,b]=i.useMemo(()=>[o!==void 0&&typeof l=="number"?Math.floor(o/l):0,o!==void 0&&typeof l=="number"?-(o%l):0],[o,l]),T=i.useMemo(()=>({x:u.current.x,y:M,width:u.current.width??1,height:u.current.height??1,ty:b}),[u,b,M]),[k,w,p]=Kl(T),S=i.useRef(C);S.current=C;const z=fc(null,le=>{le!==null&&o!==void 0?le.scrollTop=o:le!==null&&e!==void 0&&(le.scrollLeft=e)}),N=(k.height??1)>1;i.useLayoutEffect(()=>{if(o!==void 0&&z.current!==null&&N){if(z.current.scrollTop===o)return;z.current.scrollTop=o,z.current.scrollTop!==o&&p(),S.current()}},[o,N,p,z]);const O=(k.width??1)>1;return i.useLayoutEffect(()=>{if(e!==void 0&&z.current!==null&&O){if(z.current.scrollLeft===e)return;z.current.scrollLeft=e,z.current.scrollLeft!==e&&p(),S.current()}},[e,O,p,z]),{visibleRegion:k,setVisibleRegion:w,scrollRef:z}}const gc=i.lazy(async()=>await Pl(()=>import("./data-grid-overlay-editor-fA5c1p2o.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url));let vc=0;function mc(e){return ci(lr(lr(e).filter(o=>o.span!==void 0).map(o=>{var l,u;return Gt((((l=o.span)==null?void 0:l[0])??0)+1,(((u=o.span)==null?void 0:u[1])??0)+1)})))}function $o(e,o){return e===void 0||o===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+o,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+o},rangeStack:e.current.rangeStack.map(l=>({...l,x:l.x+o}))},rows:e.rows,columns:e.columns.offset(o)}}const Fo={kind:Q.Loading,allowOverlay:!1},Ao={columns:X.empty(),rows:X.empty(),current:void 0},Cc=(e,o)=>{var Yn,jn,qn;const[l,u]=i.useState(Ao),[C,M]=i.useState(),b=i.useRef(null),T=i.useRef(null),[k,w]=i.useState(),p=i.useRef(),S=typeof window>"u"?null:window,{imageEditorOverride:z,getRowThemeOverride:N,markdownDivCreateNode:O,width:le,height:ce,columns:V,rows:I,getCellContent:W,onCellClicked:Ce,onCellActivated:se,onFillPattern:de,onFinishedEditing:Y,coercePasteValue:ee,drawHeader:te,drawCell:_,editorBloom:qe,onHeaderClicked:He,onColumnProposeMove:Be,spanRangeBehavior:Pt="default",onGroupHeaderClicked:De,onCellContextMenu:Se,className:Ot,onHeaderContextMenu:Ae,getCellsForSelection:oo,onGroupHeaderContextMenu:Ve,onGroupHeaderRenamed:$,onCellEdited:ie,onCellsEdited:ae,onSearchResultsChanged:Ge,searchResults:Ze,onSearchValueChange:ft,searchValue:no,onKeyDown:Kt,onKeyUp:Ko,keybindings:ht,editOnType:Nt=!0,onRowAppended:gt,onColumnMoved:nt,validateCell:vt,highlightRegions:mt,rangeSelect:Je="rect",columnSelect:he="multi",rowSelect:Ee="multi",rangeSelectionBlending:No="exclusive",columnSelectionBlending:Wo="exclusive",rowSelectionBlending:Qe="exclusive",onDelete:Pe,onDragStart:ro,onMouseMove:lo,onPaste:Ct,copyHeaders:mn=!1,freezeColumns:et=0,cellActivationBehavior:Uo="second-click",rowSelectionMode:Bo="auto",onHeaderMenuClick:io,onHeaderIndicatorClick:co,getGroupDetails:so,rowGrouping:rt,onSearchClose:Vo,onItemHovered:ao,onSelectionCleared:lt,showSearch:gr,onVisibleRegionChanged:uo,gridSelection:wt,onGridSelectionChange:_o,minColumnWidth:vr=50,maxColumnWidth:mr=500,maxColumnAutoWidth:Cr,provideEditor:wr,trailingRowOptions:U,freezeTrailingRows:tt=0,allowedFillDirections:Cn="orthogonal",scrollOffsetX:pr,scrollOffsetY:br,verticalBorder:St,onDragOverCell:yr,onDrop:xr,onColumnResize:Wt,onColumnResizeEnd:Ut,onColumnResizeStart:Bt,customRenderers:fo,fillHandle:Mr,drawFocusRing:wn=!0,experimental:ge,fixedShadowX:Rr,fixedShadowY:kr,headerIcons:Sr,imageWindowLoader:zr,initialSize:Tr,isDraggable:Lr,onDragLeave:Hr,onRowMoved:Vt,overscrollX:Dr,overscrollY:Er,preventDiagonalScrolling:Ir,rightElement:$r,rightElementProps:Fr,trapFocus:pn=!1,smoothScrollX:Ar,smoothScrollY:Gr,scaleToRem:Pr=!1,rowHeight:Or=34,headerHeight:bn=36,groupHeaderHeight:Kr=bn,theme:Nr,isOutsideClick:Wr,renderers:Xo,resizeIndicator:Ur,scrollToActiveCell:yn=!0}=e,we=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Oe=(we==null?void 0:we.kind)??e.rowMarkers??"none",Br=(we==null?void 0:we.width)??e.rowMarkerWidth,xn=(we==null?void 0:we.startIndex)??e.rowMarkerStartIndex??1,Mn=(we==null?void 0:we.theme)??e.rowMarkerTheme,ho=(we==null?void 0:we.checkboxStyle)??"square",zt=Math.max(vr,20),go=Math.max(mr,zt),Vr=Math.max(Cr??go,zt),Rn=i.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:F,rowNumberMapper:kn,rowHeight:_r,getRowThemeOverride:ot}=uc(rt,I,Or,N),Xr=i.useMemo(()=>Number.parseFloat(Rn.fontSize),[Rn]),{rowHeight:it,headerHeight:Yo,groupHeaderHeight:Sn,theme:zn,overscrollX:Yr,overscrollY:jr}=cc({groupHeaderHeight:Kr,headerHeight:bn,overscrollX:Dr,overscrollY:Er,remSize:Xr,rowHeight:_r,scaleToRem:Pr,theme:Nr}),ct=sc(ht),Tt=Br??(I>1e4?48:I>1e3?44:I>100?36:32),_e=Oe!=="none",d=_e?1:0,oe=gt!==void 0,_t=(U==null?void 0:U.sticky)===!0,[qr,Tn]=i.useState(!1),Zr=gr??qr,Jr=i.useCallback(()=>{Vo!==void 0?Vo():Tn(!1)},[Vo]),h=i.useMemo(()=>wt===void 0?void 0:$o(wt,d),[wt,d])??l,Re=i.useRef();Re.current===void 0&&(Re.current=new AbortController),i.useEffect(()=>()=>Re==null?void 0:Re.current.abort(),[]);const[fe,Qr]=Qi(oo,W,d,Re.current,F),el=i.useCallback((t,r,n)=>{if(vt===void 0)return!0;const s=[t[0]-d,t[1]];return vt==null?void 0:vt(s,r,n)},[d,vt]),vo=i.useRef(wt),Ie=i.useCallback((t,r)=>{r&&(t=Nl(t,fe,d,Pt,Re.current)),_o!==void 0?(vo.current=$o(t,-d),_o(vo.current)):u(t)},[_o,fe,d,Pt]),Lt=kt(Wt,i.useCallback((t,r,n,s)=>{Wt==null||Wt(V[n-d],r,n-d,s)},[Wt,d,V])),tl=kt(Ut,i.useCallback((t,r,n,s)=>{Ut==null||Ut(V[n-d],r,n-d,s)},[Ut,d,V])),ol=kt(Bt,i.useCallback((t,r,n,s)=>{Bt==null||Bt(V[n-d],r,n-d,s)},[Bt,d,V])),nl=kt(te,i.useCallback((t,r)=>(te==null?void 0:te({...t,columnIndex:t.columnIndex-d},r))??!1,[te,d])),rl=kt(_,i.useCallback((t,r)=>(_==null?void 0:_({...t,col:t.col-d},r))??!1,[_,d])),st=i.useCallback(t=>{if(Pe!==void 0){const r=Pe($o(t,-d));return typeof r=="boolean"?r:$o(r,d)}return!0},[Pe,d]),[pe,be,ue]=Ji(h,Ie,No,Wo,Qe,Je),ve=i.useMemo(()=>dn(sr(),zn),[zn]),[jo,ll]=i.useState([0,0,0]),Ln=i.useMemo(()=>{if(Xo===void 0)return{};const t={};for(const r of Xo)t[r.kind]=r;return t},[Xo]),ye=i.useCallback(t=>t.kind!==Q.Custom?Ln[t.kind]:fo==null?void 0:fo.find(r=>r.isMatch(t)),[fo,Ln]);let{sizedColumns:ze,nonGrowWidth:Hn}=qi(V,F,Qr,jo[0]-(d===0?0:Tt)-jo[2],zt,Vr,ve,ye,Re.current);Oe!=="none"&&(Hn+=Tt);const qo=i.useMemo(()=>ze.some(t=>t.group!==void 0),[ze]),Xt=qo?Yo+Sn:Yo,Dn=h.rows.length,En=Oe==="none"?void 0:Dn===0?!1:Dn===F?!0:void 0,B=i.useMemo(()=>Oe==="none"?ze:[{title:"",width:Tt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Mn,rowMarker:ho,rowMarkerChecked:En},...ze],[Oe,ze,Tt,Mn,ho,En]),Te=i.useRef({height:1,width:1,x:0,y:0}),mo=i.useRef(!1),{setVisibleRegion:In,visibleRegion:pt,scrollRef:j}=hc(pr,br,it,Te,()=>mo.current=!0);Te.current=pt;const il=pt.x+d,Co=pt.y,ke=i.useRef(null),xe=i.useCallback(t=>{var r;t===!0?(r=ke.current)==null||r.focus():window.requestAnimationFrame(()=>{var n;(n=ke.current)==null||n.focus()})},[]),me=oe?F+1:F,$e=i.useCallback(t=>{const r=d===0?t:t.map(s=>({...s,location:[s.location[0]-d,s.location[1]]})),n=ae==null?void 0:ae(r);if(n!==!0)for(const s of r)ie==null||ie(s.location,s.value);return n},[ie,ae,d]),[bt,Zo]=i.useState(),wo=h.current!==void 0&&h.current.range.width*h.current.range.height>1?h.current.range:void 0,Ht=wn?(Yn=h.current)==null?void 0:Yn.cell:void 0,po=Ht==null?void 0:Ht[0],bo=Ht==null?void 0:Ht[1],cl=i.useMemo(()=>{if((mt===void 0||mt.length===0)&&(wo??po??bo??bt)===void 0)return;const t=[];if(mt!==void 0)for(const r of mt){const n=B.length-r.range.x-d;n>0&&t.push({color:r.color,range:{...r.range,x:r.range.x+d,width:Math.min(n,r.range.width)},style:r.style})}return bt!==void 0&&t.push({color:Qn(ve.accentColor,0),range:bt,style:"dashed"}),wo!==void 0&&t.push({color:Qn(ve.accentColor,.5),range:wo,style:"solid-outline"}),po!==void 0&&bo!==void 0&&t.push({color:ve.accentColor,range:{x:po,y:bo,width:1,height:1},style:"solid-outline"}),t.length>0?t:void 0},[bt,wo,po,bo,mt,B.length,ve.accentColor,d]),$n=i.useRef(B);$n.current=B;const Le=i.useCallback(([t,r],n=!1)=>{var g,a,f,v,m,y,L;const s=oe&&r===me-1;if(t===0&&_e){if(s)return Fo;const x=kn(r);return x===void 0?Fo:{kind:Do.Marker,allowOverlay:!1,checkboxStyle:ho,checked:(h==null?void 0:h.rows.hasIndex(r))===!0,markerKind:Oe==="clickable-number"?"number":Oe,row:xn+x,drawHandle:Vt!==void 0,cursor:Oe==="clickable-number"?"pointer":void 0}}else if(s){const D=t===d?(U==null?void 0:U.hint)??"":"",R=$n.current[t];if(((g=R==null?void 0:R.trailingRowOptions)==null?void 0:g.disabled)===!0)return Fo;{const P=((a=R==null?void 0:R.trailingRowOptions)==null?void 0:a.hint)??D,E=((f=R==null?void 0:R.trailingRowOptions)==null?void 0:f.addIcon)??(U==null?void 0:U.addIcon);return{kind:Do.NewRow,hint:P,allowOverlay:!1,icon:E}}}else{const x=t-d;if(n||(ge==null?void 0:ge.strict)===!0){const R=Te.current,P=R.x>x||x>R.x+R.width||R.y>r||r>R.y+R.height||r>=Qo.current,E=x===((m=(v=R.extras)==null?void 0:v.selected)==null?void 0:m[0])&&r===((y=R.extras)==null?void 0:y.selected[1]);let H=!1;if(((L=R.extras)==null?void 0:L.freezeRegions)!==void 0){for(const K of R.extras.freezeRegions)if(Wl(K,x,r)){H=!0;break}}if(P&&!E&&!H)return Fo}let D=W([x,r]);return d!==0&&D.span!==void 0&&(D={...D,span:[D.span[0]+d,D.span[1]+d]}),D}},[oe,me,_e,kn,ho,h==null?void 0:h.rows,Oe,xn,Vt,d,U==null?void 0:U.hint,U==null?void 0:U.addIcon,ge==null?void 0:ge.strict,W]),Jo=i.useCallback(t=>{let r=(so==null?void 0:so(t))??{name:t};return $!==void 0&&t!==""&&(r={icon:r.icon,name:r.name,overrideTheme:r.overrideTheme,actions:[...r.actions??[],{title:"Rename",icon:"renameIcon",onClick:n=>tn({group:r.name,bounds:n.bounds})}]}),r},[so,$]),yo=i.useCallback(t=>{var f;const[r,n]=t.cell,s=B[r],c=(s==null?void 0:s.group)!==void 0?(f=Jo(s.group))==null?void 0:f.overrideTheme:void 0,g=s==null?void 0:s.themeOverride,a=ot==null?void 0:ot(n);M({...t,theme:dn(ve,c,g,a,t.content.themeOverride)})},[ot,B,Jo,ve]),Dt=i.useCallback((t,r,n)=>{var a;if(h.current===void 0)return;const[s,c]=h.current.cell,g=Le([s,c]);if(g.kind!==Q.Boolean&&g.allowOverlay){let f=g;if(n!==void 0)switch(f.kind){case Q.Number:{const v=Ul(()=>n==="-"?-0:Number.parseFloat(n),0);f={...f,data:Number.isNaN(v)?0:v};break}case Q.Text:case Q.Markdown:case Q.Uri:f={...f,data:n};break}yo({target:t,content:f,initialValue:n,cell:[s,c],highlight:n===void 0,forceEditMode:n!==void 0})}else g.kind===Q.Boolean&&r&&g.readonly!==!0&&($e([{location:h.current.cell,value:{...g,data:Bl(g.data)}}]),(a=ke.current)==null||a.damage([{cell:h.current.cell}]))},[Le,h,$e,yo]),Fn=i.useCallback((t,r)=>{var c;const n=(c=ke.current)==null?void 0:c.getBounds(t,r);if(n===void 0||j.current===null)return;const s=Le([t,r]);s.allowOverlay&&yo({target:n,content:s,initialValue:void 0,highlight:!0,cell:[t,r],forceEditMode:!0})},[Le,j,yo]),ne=i.useCallback((t,r,n="both",s=0,c=0,g=void 0)=>{if(j.current!==null){const a=ke.current,f=T.current,v=typeof t!="number"?t.unit==="cell"?t.amount:void 0:t,m=typeof r!="number"?r.unit==="cell"?r.amount:void 0:r,y=typeof t!="number"&&t.unit==="px"?t.amount:void 0,L=typeof r!="number"&&r.unit==="px"?r.amount:void 0;if(a!==null&&f!==null){let x={x:0,y:0,width:0,height:0},D=0,R=0;if((v!==void 0||m!==void 0)&&(x=a.getBounds((v??0)+d,m??0)??x,x.width===0||x.height===0))return;const P=f.getBoundingClientRect(),E=P.width/f.offsetWidth;if(y!==void 0&&(x={...x,x:y-P.left-j.current.scrollLeft,width:1}),L!==void 0&&(x={...x,y:L+P.top-j.current.scrollTop,height:1}),x!==void 0){const H={x:x.x-s,y:x.y-c,width:x.width+2*s,height:x.height+2*c};let K=0;for(let an=0;an<et;an++)K+=ze[an].width;let J=0;const re=tt+(_t?1:0);re>0&&(J=Vl(me,re,it));let We=K*E+P.left+d*Tt*E,Ye=P.right,Ue=P.top+Xt*E,je=P.bottom-J*E;const To=x.width+s*2;switch(g==null?void 0:g.hAlign){case"start":Ye=We+To;break;case"end":We=Ye-To;break;case"center":We=Math.floor((We+Ye)/2)-To/2,Ye=We+To;break}const Lo=x.height+c*2;switch(g==null?void 0:g.vAlign){case"start":je=Ue+Lo;break;case"end":Ue=je-Lo;break;case"center":Ue=Math.floor((Ue+je)/2)-Lo/2,je=Ue+Lo;break}We>H.x?D=H.x-We:Ye<H.x+H.width&&(D=H.x+H.width-Ye),Ue>H.y?R=H.y-Ue:je<H.y+H.height&&(R=H.y+H.height-je),n==="vertical"||typeof t=="number"&&t<et?D=0:(n==="horizontal"||typeof r=="number"&&r>=me-re)&&(R=0),(D!==0||R!==0)&&(E!==1&&(D/=E,R/=E),j.current.scrollTo(D+j.current.scrollLeft,R+j.current.scrollTop))}}}},[d,tt,Tt,j,Xt,et,ze,me,_t,it]),An=i.useRef(Fn),Gn=i.useRef(W),Qo=i.useRef(F);An.current=Fn,Gn.current=W,Qo.current=F;const Et=i.useCallback(async(t,r=!0)=>{var v;const n=B[t];if(((v=n==null?void 0:n.trailingRowOptions)==null?void 0:v.disabled)===!0)return;const s=gt==null?void 0:gt();let c,g=!0;s!==void 0&&(c=await s,c==="top"&&(g=!1),typeof c=="number"&&(g=!1));let a=0;const f=()=>{if(Qo.current<=F){a<500&&window.setTimeout(f,a),a=50+a*2;return}const m=typeof c=="number"?c:g?F:0;zo.current(t-d,m),pe({cell:[t,m],range:{x:t,y:m,width:1,height:1}},!1,!1,"edit");const y=Gn.current([t-d,m]);y.allowOverlay&&Io(y)&&y.readonly!==!0&&r&&window.setTimeout(()=>{An.current(t,m)},0)};f()},[B,gt,d,F,pe]),xo=i.useCallback(t=>{var n,s;const r=((s=(n=ze[t])==null?void 0:n.trailingRowOptions)==null?void 0:s.targetColumn)??(U==null?void 0:U.targetColumn);if(typeof r=="number")return r+(_e?1:0);if(typeof r=="object"){const c=V.indexOf(r);if(c>=0)return c+(_e?1:0)}},[ze,V,_e,U==null?void 0:U.targetColumn]),at=i.useRef(),It=i.useRef(),Yt=i.useCallback((t,r)=>{var c;const[n,s]=r;return dn(ve,(c=B[n])==null?void 0:c.themeOverride,ot==null?void 0:ot(s),t.themeOverride)},[ot,B,ve]),{mapper:yt}=dc(rt,I),Ke=rt==null?void 0:rt.navigationBehavior,jt=i.useCallback(t=>{var y,L,x;const r=Po.value?t.metaKey:t.ctrlKey,n=r&&Ee==="multi",s=r&&he==="multi",[c,g]=t.location,a=h.columns,f=h.rows,[v,m]=((y=h.current)==null?void 0:y.cell)??[];if(t.kind==="cell"){if(It.current=void 0,xt.current=[c,g],c===0&&_e){if(oe===!0&&g===F||Oe==="number"||Ee==="none")return;const D=Le(t.location);if(D.kind!==Do.Marker)return;if(Vt!==void 0){const E=ye(D);Go((E==null?void 0:E.kind)===Do.Marker);const H=(L=E==null?void 0:E.onClick)==null?void 0:L.call(E,{...t,cell:D,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,theme:Yt(D,t.location),preventDefault:()=>{}});if(H===void 0||H.checked===D.checked)return}M(void 0),xe();const R=f.hasIndex(g),P=at.current;if(Ee==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&P!==void 0&&f.hasIndex(P)){const E=[Math.min(P,g),Math.max(P,g)+1];n||Bo==="multi"?be(void 0,E,!0):be(X.fromSingleSelection(E),void 0,n)}else n||t.isTouch||Bo==="multi"?R?be(f.remove(g),void 0,!0):(be(void 0,g,!0),at.current=g):R&&f.length===1?be(X.empty(),void 0,r):(be(X.fromSingleSelection(g),void 0,r),at.current=g)}else if(c>=d&&oe&&g===F){const D=xo(c);Et(D??c)}else if(v!==c||m!==g){const D=Le(t.location),R=ye(D);if((R==null?void 0:R.onSelect)!==void 0){let H=!1;if(R.onSelect({...t,cell:D,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,preventDefault:()=>H=!0,theme:Yt(D,t.location)}),H)return}if(Ke==="block"&&yt(g).isGroupHeader)return;const P=_t&&g===F,E=_t&&h!==void 0&&((x=h.current)==null?void 0:x.cell[1])===F;if((t.shiftKey||t.isLongTouch===!0)&&v!==void 0&&m!==void 0&&h.current!==void 0&&!E){if(P)return;const H=Math.min(c,v),K=Math.max(c,v),J=Math.min(g,m),re=Math.max(g,m);pe({...h.current,range:{x:H,y:J,width:K-H+1,height:re-J+1}},!0,r,"click"),at.current=void 0,xe()}else pe({cell:[c,g],range:{x:c,y:g,width:1,height:1}},!0,r,"click"),at.current=void 0,M(void 0),xe()}}else if(t.kind==="header")if(xt.current=[c,g],M(void 0),_e&&c===0)at.current=void 0,It.current=void 0,Ee==="multi"&&(f.length!==F?be(X.fromSingleSelection([0,F]),void 0,r):be(X.empty(),void 0,r),xe());else{const D=It.current;if(he==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&D!==void 0&&a.hasIndex(D)){const R=[Math.min(D,c),Math.max(D,c)+1];s?ue(void 0,R,r):ue(X.fromSingleSelection(R),void 0,r)}else s?(a.hasIndex(c)?ue(a.remove(c),void 0,r):ue(void 0,c,r),It.current=c):he!=="none"&&(ue(X.fromSingleSelection(c),void 0,r),It.current=c);at.current=void 0,xe()}else t.kind===At?xt.current=[c,g]:t.kind===er&&!t.isMaybeScrollbar&&(Ie(Ao,!1),M(void 0),xe(),lt==null||lt(),at.current=void 0,It.current=void 0)},[Ee,he,h,_e,d,oe,F,Oe,Le,Vt,xe,Bo,ye,Yt,be,xo,Et,Ke,yt,_t,pe,ue,Ie,lt]),qt=i.useRef(!1),xt=i.useRef(),Pn=i.useRef(pt),Fe=i.useRef(),sl=i.useCallback(t=>{if($t.current=!1,Pn.current=Te.current,t.button!==0&&t.button!==1){Fe.current=void 0;return}const r=performance.now();Fe.current={button:t.button,time:r,location:t.location},(t==null?void 0:t.kind)==="header"&&(qt.current=!0);const n=t.kind==="cell"&&t.isFillHandle;!n&&t.kind!=="cell"&&t.isEdge||(w({previousSelection:h,fillHandle:n}),xt.current=void 0,!t.isTouch&&t.button===0&&!n?jt(t):!t.isTouch&&t.button===1&&(xt.current=t.location))},[h,jt]),[en,tn]=i.useState(),On=i.useCallback(t=>{if(t.kind!==At||he!=="multi")return;const r=Po.value?t.metaKey:t.ctrlKey,[n]=t.location,s=h.columns;if(n<d)return;const c=B[n];let g=n,a=n;for(let f=n-1;f>=d&&tr(c.group,B[f].group);f--)g--;for(let f=n+1;f<B.length&&tr(c.group,B[f].group);f++)a++;if(xe(),r)if(s.hasAll([g,a+1])){let f=s;for(let v=g;v<=a;v++)f=f.remove(v);ue(f,void 0,r)}else ue(void 0,[g,a+1],r);else ue(X.fromSingleSelection([g,a+1]),void 0,r)},[he,xe,h.columns,B,d,ue]),$t=i.useRef(!1),Mo=i.useCallback(async t=>{if(fe!==void 0&&Lt!==void 0){const r=Te.current.y,n=Te.current.height;let s=fe({x:t,y:r,width:1,height:Math.min(n,F-r)},Re.current.signal);typeof s!="object"&&(s=await s());const c=ze[t-d],a=document.createElement("canvas").getContext("2d",{alpha:!1});if(a!==null){a.font=ve.baseFontFull;const f=ur(a,ve,c,0,s,zt,go,!1,ye);Lt==null||Lt(c,f.width,t,f.width)}}},[ze,fe,go,ve,zt,Lt,d,F,ye]),[al,on]=i.useState(),Ft=i.useCallback(async(t,r)=>{var f,v;const n=(f=t.current)==null?void 0:f.range;if(n===void 0||fe===void 0||r.current===void 0)return;const s=r.current.range;if(de!==void 0){let m=!1;if(de({fillDestination:{...s,x:s.x-d},patternSource:{...n,x:n.x-d},preventDefault:()=>m=!0}),m)return}let c=fe(n,Re.current.signal);typeof c!="object"&&(c=await c());const g=c,a=[];for(let m=0;m<s.width;m++)for(let y=0;y<s.height;y++){const L=[s.x+m,s.y+y];if(_l(L,n))continue;const x=g[y%n.height][m%n.width];Eo(x)||!Io(x)||a.push({location:L,value:{...x}})}$e(a),(v=ke.current)==null||v.damage(a.map(m=>({cell:m.location})))},[fe,$e,de,d]),Kn=i.useCallback(()=>{if(h.current===void 0||h.current.range.width<=1)return;const t={...h,current:{...h.current,range:{...h.current.range,width:1}}};Ft(t,h)},[Ft,h]),Nn=i.useCallback(()=>{if(h.current===void 0||h.current.range.height<=1)return;const t={...h,current:{...h.current,range:{...h.current.range,height:1}}};Ft(t,h)},[Ft,h]),ul=i.useCallback((t,r)=>{var y,L;const n=k;if(w(void 0),Zo(void 0),on(void 0),qt.current=!1,r)return;if((n==null?void 0:n.fillHandle)===!0&&h.current!==void 0&&((y=n.previousSelection)==null?void 0:y.current)!==void 0){if(bt===void 0)return;const x={...h,current:{...h.current,range:Xl(n.previousSelection.current.range,bt)}};Ft(n.previousSelection,x),Ie(x,!0);return}const[s,c]=t.location,[g,a]=xt.current??[],f=()=>{$t.current=!0},v=x=>{var R,P,E;const D=x.isTouch||g===s&&a===c;if(D&&(Ce==null||Ce([s-d,c],{...x,preventDefault:f})),x.button===1)return!$t.current;if(!$t.current){const H=Le(t.location),K=ye(H);if(K!==void 0&&K.onClick!==void 0&&D){const re=K.onClick({...x,cell:H,posX:x.localEventX,posY:x.localEventY,bounds:x.bounds,theme:Yt(H,t.location),preventDefault:f});re!==void 0&&!Eo(re)&&eo(re)&&($e([{location:x.location,value:re}]),(R=ke.current)==null||R.damage([{cell:x.location}]))}if($t.current||h.current===void 0)return!1;let J=!1;switch(H.activationBehaviorOverride??Uo){case"double-click":case"second-click":{if(((E=(P=n==null?void 0:n.previousSelection)==null?void 0:P.current)==null?void 0:E.cell)===void 0)break;const[re,We]=h.current.cell,[Ye,Ue]=n.previousSelection.current.cell;J=s===re&&s===Ye&&c===We&&c===Ue&&(x.isDoubleClick===!0||Uo==="second-click");break}case"single-click":{J=!0;break}}if(J)return se==null||se([s-d,c]),Dt(x.bounds,!1),!0}return!1},m=t.location[0]-d;if(t.isTouch){const x=Te.current,D=Pn.current;if(x.x!==D.x||x.y!==D.y)return;if(t.isLongTouch===!0){if(t.kind==="cell"&&Yl((L=h.current)==null?void 0:L.cell,t.location)){Se==null||Se([m,t.location[1]],{...t,preventDefault:f});return}else if(t.kind==="header"&&h.columns.hasIndex(s)){Ae==null||Ae(m,{...t,preventDefault:f});return}else if(t.kind===At){if(m<0)return;Ve==null||Ve(m,{...t,preventDefault:f});return}}t.kind==="cell"?v(t)||jt(t):t.kind===At?De==null||De(m,{...t,preventDefault:f}):(t.kind===jl&&(He==null||He(m,{...t,preventDefault:f})),jt(t));return}if(t.kind==="header"){if(m<0)return;t.isEdge?t.isDoubleClick===!0&&Mo(s):t.button===0&&s===g&&c===a&&(He==null||He(m,{...t,preventDefault:f}))}if(t.kind===At){if(m<0)return;t.button===0&&s===g&&c===a&&(De==null||De(m,{...t,preventDefault:f}),$t.current||On(t))}t.kind==="cell"&&(t.button===0||t.button===1)&&v(t),xt.current=void 0},[k,h,d,bt,Ft,Ie,Ce,Le,ye,Uo,Yt,$e,se,Dt,Se,Ae,Ve,jt,De,He,Mo,On]),dl=i.useCallback(t=>{const r={...t,location:[t.location[0]-d,t.location[1]]};lo==null||lo(r),k!==void 0&&t.buttons===0&&(w(void 0),Zo(void 0),on(void 0),qt.current=!1),on(n=>{var s;return qt.current?[t.scrollEdge[0],0]:t.scrollEdge[0]===(n==null?void 0:n[0])&&t.scrollEdge[1]===n[1]?n:k===void 0||(((s=Fe.current)==null?void 0:s.location[0])??0)<d?void 0:t.scrollEdge})},[k,lo,d]),fl=i.useCallback((t,r)=>{io==null||io(t-d,r)},[io,d]),hl=i.useCallback((t,r)=>{co==null||co(t-d,r)},[co,d]),Xe=(jn=h==null?void 0:h.current)==null?void 0:jn.cell,gl=i.useCallback((t,r,n,s,c,g)=>{mo.current=!1;let a=Xe;a!==void 0&&(a=[a[0]-d,a[1]]);const f=et===0?void 0:{x:0,y:t.y,width:et,height:t.height},v=[];f!==void 0&&v.push(f),tt>0&&(v.push({x:t.x-d,y:F-tt,width:t.width,height:tt}),et>0&&v.push({x:0,y:F-tt,width:et,height:tt}));const m={x:t.x-d,y:t.y,width:t.width,height:oe&&t.y+t.height>=F?t.height-1:t.height,tx:c,ty:g,extras:{selected:a,freezeRegion:f,freezeRegions:v}};Te.current=m,In(m),ll([r,n,s]),uo==null||uo(m,m.tx,m.ty,m.extras)},[Xe,d,oe,F,et,tt,In,uo]),vl=kt(nt,i.useCallback((t,r)=>{nt==null||nt(t-d,r-d),he!=="none"&&ue(X.fromSingleSelection(r),void 0,!0)},[he,nt,d,ue])),nn=i.useRef(!1),ml=i.useCallback(t=>{if(t.location[0]===0&&d>0){t.preventDefault();return}ro==null||ro({...t,location:[t.location[0]-d,t.location[1]]}),t.defaultPrevented()||(nn.current=!0),w(void 0)},[ro,d]),Cl=i.useCallback(()=>{nn.current=!1},[]),Wn=rt==null?void 0:rt.selectionBehavior,Ro=i.useCallback(t=>{if(Wn!=="block-spanning")return;const{isGroupHeader:r,path:n,groupRows:s}=yt(t);if(r)return[t,t];const c=n[n.length-1],g=t-c,a=t+s-c-1;return[g,a]},[yt,Wn]),rn=i.useRef(),ln=i.useCallback(t=>{var r,n,s;if(!ql(t,rn.current)&&(rn.current=t,!(((r=Fe==null?void 0:Fe.current)==null?void 0:r.button)!==void 0&&Fe.current.button>=1))){if(t.buttons!==0&&k!==void 0&&((n=Fe.current)==null?void 0:n.location[0])===0&&t.location[0]===0&&d===1&&Ee==="multi"&&k.previousSelection&&!k.previousSelection.rows.hasIndex(Fe.current.location[1])&&h.rows.hasIndex(Fe.current.location[1])){const c=Math.min(Fe.current.location[1],t.location[1]),g=Math.max(Fe.current.location[1],t.location[1])+1;be(X.fromSingleSelection([c,g]),void 0,!1)}if(t.buttons!==0&&k!==void 0&&h.current!==void 0&&!nn.current&&!qt.current&&(Je==="rect"||Je==="multi-rect")){const[c,g]=h.current.cell;let[a,f]=t.location;if(f<0&&(f=Te.current.y),k.fillHandle===!0&&((s=k.previousSelection)==null?void 0:s.current)!==void 0){const v=k.previousSelection.current.range;f=Math.min(f,oe?F-1:F);const m=Zl(v,a,f,Cn);Zo(m)}else{if(oe&&g===F)return;if(oe&&f===F)if(t.kind===er)f--;else return;a=Math.max(a,d);const y=Ro(g);f=y===void 0?f:Rt(f,y[0],y[1]);const L=a-c,x=f-g,D={x:L>=0?c:a,y:x>=0?g:f,width:Math.abs(L)+1,height:Math.abs(x)+1};pe({...h.current,range:D},!0,!1,"drag")}}ao==null||ao({...t,location:[t.location[0]-d,t.location[1]]})}},[k,d,Ee,h,Je,ao,be,oe,F,Cn,Ro,pe]),wl=i.useCallback(()=>{var a,f;const t=rn.current;if(t===void 0)return;const[r,n]=t.scrollEdge;let[s,c]=t.location;const g=Te.current;r===-1?s=((f=(a=g.extras)==null?void 0:a.freezeRegion)==null?void 0:f.x)??g.x:r===1&&(s=g.x+g.width),n===-1?c=Math.max(0,g.y):n===1&&(c=Math.min(F-1,g.y+g.height)),s=Rt(s,0,B.length-1),c=Rt(c,0,F-1),ln({...t,location:[s,c]})},[B.length,ln,F]);ic(al,j,wl);const Ne=i.useCallback(t=>{if(h.current===void 0)return;const[r,n]=t,[s,c]=h.current.cell,g=h.current.range;let a=g.x,f=g.x+g.width,v=g.y,m=g.y+g.height;const[y,L]=Ro(c)??[0,F-1],x=L+1;if(n!==0)switch(n){case 2:{m=x,v=c,ne(0,m,"vertical");break}case-2:{v=y,m=c+1,ne(0,v,"vertical");break}case 1:{v<c?(v++,ne(0,v,"vertical")):(m=Math.min(x,m+1),ne(0,m,"vertical"));break}case-1:{m>c+1?(m--,ne(0,m,"vertical")):(v=Math.max(y,v-1),ne(0,v,"vertical"));break}default:or()}if(r!==0)if(r===2)f=B.length,a=s,ne(f-1-d,0,"horizontal");else if(r===-2)a=d,f=s+1,ne(a-d,0,"horizontal");else{let D=[];if(fe!==void 0){const R=fe({x:a,y:v,width:f-a-d,height:m-v},Re.current.signal);typeof R=="object"&&(D=mc(R))}if(r===1){let R=!1;if(a<s){if(D.length>0){const P=Gt(a+1,s+1).find(E=>!D.includes(E-d));P!==void 0&&(a=P,R=!0)}else a++,R=!0;R&&ne(a,0,"horizontal")}R||(f=Math.min(B.length,f+1),ne(f-1-d,0,"horizontal"))}else if(r===-1){let R=!1;if(f>s+1){if(D.length>0){const P=Gt(f-1,s,-1).find(E=>!D.includes(E-d));P!==void 0&&(f=P,R=!0)}else f--,R=!0;R&&ne(f-d,0,"horizontal")}R||(a=Math.max(d,a-1),ne(a-d,0,"horizontal"))}else or()}pe({cell:h.current.cell,range:{x:a,y:v,width:f-a,height:m-v}},!0,!1,"keyboard-select")},[fe,Ro,h,B.length,d,F,ne,pe]),cn=i.useRef(yn);cn.current=yn;const ut=i.useCallback((t,r,n,s)=>{const c=me-(n?0:1);t=Rt(t,d,ze.length-1+d),r=Rt(r,0,c);const g=Xe==null?void 0:Xe[0],a=Xe==null?void 0:Xe[1];if(t===g&&r===a)return!1;if(s&&h.current!==void 0){const f=[...h.current.rangeStack];(h.current.range.width>1||h.current.range.height>1)&&f.push(h.current.range),Ie({...h,current:{cell:[t,r],range:{x:t,y:r,width:1,height:1},rangeStack:f}},!0)}else pe({cell:[t,r],range:{x:t,y:r,width:1,height:1}},!0,!1,"keyboard-nav");return p.current!==void 0&&p.current[0]===t&&p.current[1]===r&&(p.current=void 0),cn.current&&ne(t-d,r),!0},[me,d,ze.length,Xe,h,ne,Ie,pe]),pl=i.useCallback((t,r)=>{(C==null?void 0:C.cell)!==void 0&&t!==void 0&&eo(t)&&($e([{location:C.cell,value:t}]),window.requestAnimationFrame(()=>{var c;(c=ke.current)==null||c.damage([{cell:C.cell}])})),xe(!0),M(void 0);const[n,s]=r;if(h.current!==void 0&&(n!==0||s!==0)){const c=h.current.cell[1]===me-1&&t!==void 0;ut(Rt(h.current.cell[0]+n,0,B.length-1),Rt(h.current.cell[1]+s,0,me-1),c,!1)}Y==null||Y(t,r)},[C==null?void 0:C.cell,xe,h,Y,$e,me,ut,B.length]),bl=i.useMemo(()=>`gdg-overlay-${vc++}`,[]),Mt=i.useCallback(t=>{var n,s,c,g;xe();const r=[];for(let a=t.x;a<t.x+t.width;a++)for(let f=t.y;f<t.y+t.height;f++){const v=W([a-d,f]);if(!v.allowOverlay&&v.kind!==Q.Boolean)continue;let m;if(v.kind===Q.Custom){const y=ye(v),L=(n=y==null?void 0:y.provideEditor)==null?void 0:n.call(y,v);(y==null?void 0:y.onDelete)!==void 0?m=y.onDelete(v):Jl(L)&&(m=(s=L==null?void 0:L.deletedValue)==null?void 0:s.call(L,v))}else if(eo(v)&&v.allowOverlay||v.kind===Q.Boolean){const y=ye(v);m=(c=y==null?void 0:y.onDelete)==null?void 0:c.call(y,v)}m!==void 0&&!Eo(m)&&eo(m)&&r.push({location:[a,f],value:m})}$e(r),(g=ke.current)==null||g.damage(r.map(a=>({cell:a.location})))},[xe,W,ye,$e,d]),Zt=C!==void 0,Un=i.useCallback(t=>{var P,E;const r=()=>{t.stopPropagation(),t.preventDefault()},n={didMatch:!1},{bounds:s}=t,c=h.columns,g=h.rows,a=ct;if(!Zt&&A(a.clear,t,n))Ie(Ao,!1),lt==null||lt();else if(!Zt&&A(a.selectAll,t,n))Ie({columns:X.empty(),rows:X.empty(),current:{cell:((P=h.current)==null?void 0:P.cell)??[d,0],range:{x:d,y:0,width:V.length,height:F},rangeStack:[]}},!1);else if(A(a.search,t,n))(E=b==null?void 0:b.current)==null||E.focus({preventScroll:!0}),Tn(!0);else if(A(a.delete,t,n)){const H=(st==null?void 0:st(h))??!0;if(H!==!1){const K=H===!0?h:H;if(K.current!==void 0){Mt(K.current.range);for(const J of K.current.rangeStack)Mt(J)}for(const J of K.rows)Mt({x:d,y:J,width:V.length,height:1});for(const J of K.columns)Mt({x:J,y:0,width:1,height:F})}}if(n.didMatch)return r(),!0;if(h.current===void 0)return!1;let[f,v]=h.current.cell;const[,m]=h.current.cell;let y=!1,L=!1;if(A(a.scrollToSelectedCell,t,n)?zo.current(f-d,v):he!=="none"&&A(a.selectColumn,t,n)?c.hasIndex(f)?ue(c.remove(f),void 0,!0):he==="single"?ue(X.fromSingleSelection(f),void 0,!0):ue(void 0,f,!0):Ee!=="none"&&A(a.selectRow,t,n)?g.hasIndex(v)?be(g.remove(v),void 0,!0):Ee==="single"?be(X.fromSingleSelection(v),void 0,!0):be(void 0,v,!0):!Zt&&s!==void 0&&A(a.activateCell,t,n)?v===F&&oe?window.setTimeout(()=>{const H=xo(f);Et(H??f)},0):(se==null||se([f-d,v]),Dt(s,!0)):h.current.range.height>1&&A(a.downFill,t,n)?Nn():h.current.range.width>1&&A(a.rightFill,t,n)?Kn():A(a.goToNextPage,t,n)?v+=Math.max(1,Te.current.height-4):A(a.goToPreviousPage,t,n)?v-=Math.max(1,Te.current.height-4):A(a.goToFirstCell,t,n)?(M(void 0),v=0,f=0):A(a.goToLastCell,t,n)?(M(void 0),v=Number.MAX_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER):A(a.selectToFirstCell,t,n)?(M(void 0),Ne([-2,-2])):A(a.selectToLastCell,t,n)?(M(void 0),Ne([2,2])):Zt?(A(a.closeOverlay,t,n)&&M(void 0),A(a.acceptOverlayDown,t,n)&&(M(void 0),v++),A(a.acceptOverlayUp,t,n)&&(M(void 0),v--),A(a.acceptOverlayLeft,t,n)&&(M(void 0),f--),A(a.acceptOverlayRight,t,n)&&(M(void 0),f++)):(A(a.goDownCell,t,n)?v+=1:A(a.goUpCell,t,n)?v-=1:A(a.goRightCell,t,n)?f+=1:A(a.goLeftCell,t,n)?f-=1:A(a.goDownCellRetainSelection,t,n)?(v+=1,y=!0):A(a.goUpCellRetainSelection,t,n)?(v-=1,y=!0):A(a.goRightCellRetainSelection,t,n)?(f+=1,y=!0):A(a.goLeftCellRetainSelection,t,n)?(f-=1,y=!0):A(a.goToLastRow,t,n)?v=F-1:A(a.goToFirstRow,t,n)?v=Number.MIN_SAFE_INTEGER:A(a.goToLastColumn,t,n)?f=Number.MAX_SAFE_INTEGER:A(a.goToFirstColumn,t,n)?f=Number.MIN_SAFE_INTEGER:(Je==="rect"||Je==="multi-rect")&&(A(a.selectGrowDown,t,n)?Ne([0,1]):A(a.selectGrowUp,t,n)?Ne([0,-1]):A(a.selectGrowRight,t,n)?Ne([1,0]):A(a.selectGrowLeft,t,n)?Ne([-1,0]):A(a.selectToLastRow,t,n)?Ne([0,2]):A(a.selectToFirstRow,t,n)?Ne([0,-2]):A(a.selectToLastColumn,t,n)?Ne([2,0]):A(a.selectToFirstColumn,t,n)&&Ne([-2,0])),L=n.didMatch),Ke!==void 0&&Ke!=="normal"&&v!==m){const H=Ke==="skip-up"||Ke==="skip"||Ke==="block",K=Ke==="skip-down"||Ke==="skip"||Ke==="block",J=v<m;if(J&&H){for(;v>=0&&yt(v).isGroupHeader;)v--;v<0&&(v=m)}else if(!J&&K){for(;v<F&&yt(v).isGroupHeader;)v++;v>=F&&(v=m)}}const D=ut(f,v,!1,y),R=n.didMatch;return R&&(D||!L||pn)&&r(),R},[Ke,Zt,h,ct,he,Ee,Je,d,yt,F,ut,Ie,lt,V.length,st,pn,Mt,ue,be,oe,xo,Et,se,Dt,Nn,Kn,Ne]),Jt=i.useCallback(t=>{let r=!1;if(Kt!==void 0&&Kt({...t,cancel:()=>{r=!0}}),r||Un(t)||h.current===void 0)return;const[n,s]=h.current.cell,c=Te.current;if(Nt&&!t.metaKey&&!t.ctrlKey&&h.current!==void 0&&t.key.length===1&&/[ -~]/g.test(t.key)&&t.bounds!==void 0&&Io(W([n-d,Math.max(0,Math.min(s,F-1))]))){if((!oe||s!==F)&&(c.y>s||s>c.y+c.height||c.x>n||n>c.x+c.width))return;Dt(t.bounds,!0,t.key),t.stopPropagation(),t.preventDefault()}},[Nt,Kt,Un,h,W,d,F,oe,Dt]),yl=i.useCallback((t,r)=>{const n=t.location[0]-d;if(t.kind==="header"&&(Ae==null||Ae(n,{...t,preventDefault:r})),t.kind===At){if(n<0)return;Ve==null||Ve(n,{...t,preventDefault:r})}if(t.kind==="cell"){const[s,c]=t.location;Se==null||Se([n,c],{...t,preventDefault:r}),Ql(h,t.location)||ut(s,c,!1,!1)}},[h,Se,Ve,Ae,d,ut]),sn=i.useCallback(async t=>{var a,f,v;if(!ct.paste)return;function r(m,y,L,x){var R,P;const D=typeof L=="object"?(L==null?void 0:L.join(`
`))??"":(L==null?void 0:L.toString())??"";if(!Eo(m)&&Io(m)&&m.readonly!==!0){const E=ee==null?void 0:ee(D,m);if(E!==void 0&&eo(E))return{location:y,value:E};const H=ye(m);if(H===void 0)return;if(H.kind===Q.Custom){Go(m.kind===Q.Custom);const K=(R=H.onPaste)==null?void 0:R.call(H,D,m.data);return K===void 0?void 0:{location:y,value:{...m,data:K}}}else{const K=(P=H.onPaste)==null?void 0:P.call(H,D,m,{formatted:x,formattedString:typeof x=="string"?x:x==null?void 0:x.join(`
`),rawValue:L});return K===void 0?void 0:(Go(K.kind===m.kind),{location:y,value:K})}}}const n=h.columns,s=h.rows,c=((a=j.current)==null?void 0:a.contains(document.activeElement))===!0||((f=T.current)==null?void 0:f.contains(document.activeElement))===!0;let g;if(h.current!==void 0?g=[h.current.range.x,h.current.range.y]:n.length===1?g=[n.first()??0,0]:s.length===1&&(g=[d,s.first()??0]),c&&g!==void 0){let m,y;const L="text/plain",x="text/html";if(navigator.clipboard.read!==void 0){const E=await navigator.clipboard.read();for(const H of E){if(H.types.includes(x)){const J=await(await H.getType(x)).text(),re=nr(J);if(re!==void 0){m=re;break}}H.types.includes(L)&&(y=await(await H.getType(L)).text())}}else if(navigator.clipboard.readText!==void 0)y=await navigator.clipboard.readText();else if(t!==void 0&&(t==null?void 0:t.clipboardData)!==null){if(t.clipboardData.types.includes(x)){const E=t.clipboardData.getData(x);m=nr(E)}m===void 0&&t.clipboardData.types.includes(L)&&(y=t.clipboardData.getData(L))}else return;const[D,R]=g,P=[];do{if(Ct===void 0){const E=Le(g),H=y??(m==null?void 0:m.map(J=>J.map(re=>re.rawValue).join("	")).join("	"))??"",K=r(E,g,H,void 0);K!==void 0&&P.push(K);break}if(m===void 0){if(y===void 0)return;m=ei(y)}if(Ct===!1||typeof Ct=="function"&&(Ct==null?void 0:Ct([g[0]-d,g[1]],m.map(E=>E.map(H=>{var K;return((K=H.rawValue)==null?void 0:K.toString())??""}))))!==!0)return;for(const[E,H]of m.entries()){if(E+R>=F)break;for(const[K,J]of H.entries()){const re=[K+D,E+R],[We,Ye]=re;if(We>=B.length||Ye>=me)continue;const Ue=Le(re),je=r(Ue,re,J.rawValue,J.formatted);je!==void 0&&P.push(je)}}}while(!1);$e(P),(v=ke.current)==null||v.damage(P.map(E=>({cell:E.location})))}},[ee,ye,Le,h,ct.paste,j,B.length,$e,me,Ct,d,F]);fn("paste",sn,S,!1,!0);const Qt=i.useCallback(async(t,r)=>{var a,f;if(!ct.copy)return;const n=r===!0||((a=j.current)==null?void 0:a.contains(document.activeElement))===!0||((f=T.current)==null?void 0:f.contains(document.activeElement))===!0,s=h.columns,c=h.rows,g=(v,m)=>{if(!mn)rr(v,m,t);else{const y=m.map(L=>({kind:Q.Text,data:V[L].title,displayData:V[L].title,allowOverlay:!1}));rr([y,...v],m,t)}};if(n&&fe!==void 0){if(h.current!==void 0){let v=fe(h.current.range,Re.current.signal);typeof v!="object"&&(v=await v()),g(v,Gt(h.current.range.x-d,h.current.range.x+h.current.range.width-d))}else if(c!==void 0&&c.length>0){const m=[...c].map(y=>{const L=fe({x:d,y,width:V.length,height:1},Re.current.signal);return typeof L=="object"?L[0]:L().then(x=>x[0])});if(m.some(y=>y instanceof Promise)){const y=await Promise.all(m);g(y,Gt(V.length))}else g(m,Gt(V.length))}else if(s.length>0){const v=[],m=[];for(const y of s){let L=fe({x:y,y:0,width:1,height:F},Re.current.signal);typeof L!="object"&&(L=await L()),v.push(L),m.push(y-d)}if(v.length===1)g(v[0],m);else{const y=v.reduce((L,x)=>L.map((D,R)=>[...D,...x[R]]));g(y,m)}}}},[V,fe,h,ct.copy,d,j,F,mn]);fn("copy",Qt,S,!1,!1);const xl=i.useCallback(async t=>{var n,s;if(!(!ct.cut||!(((n=j.current)==null?void 0:n.contains(document.activeElement))===!0||((s=T.current)==null?void 0:s.contains(document.activeElement))===!0))&&(await Qt(t),h.current!==void 0)){let c={current:{cell:h.current.cell,range:h.current.range,rangeStack:[]},rows:X.empty(),columns:X.empty()};const g=st==null?void 0:st(c);if(g===!1||(c=g===!0?c:g,c.current===void 0))return;Mt(c.current.range)}},[Mt,h,ct.cut,Qt,j,st]);fn("cut",xl,S,!1,!1);const Ml=i.useCallback((t,r)=>{if(Ge!==void 0){d!==0&&(t=t.map(c=>[c[0]-d,c[1]])),Ge(t,r);return}if(t.length===0||r===-1)return;const[n,s]=t[r];p.current!==void 0&&p.current[0]===n&&p.current[1]===s||(p.current=[n,s],ut(n,s,!1,!1))},[Ge,d,ut]),[ko,So]=((qn=wt==null?void 0:wt.current)==null?void 0:qn.cell)??[],zo=i.useRef(ne);zo.current=ne,i.useLayoutEffect(()=>{var t,r,n,s;cn.current&&!mo.current&&ko!==void 0&&So!==void 0&&(ko!==((r=(t=vo.current)==null?void 0:t.current)==null?void 0:r.cell[0])||So!==((s=(n=vo.current)==null?void 0:n.current)==null?void 0:s.cell[1]))&&zo.current(ko,So),mo.current=!1},[ko,So]);const Bn=h.current!==void 0&&(h.current.cell[0]>=B.length||h.current.cell[1]>=me);i.useLayoutEffect(()=>{Bn&&Ie(Ao,!1)},[Bn,Ie]);const Rl=i.useMemo(()=>oe===!0&&(U==null?void 0:U.tint)===!0?X.fromSingleSelection(me-1):X.empty(),[me,oe,U==null?void 0:U.tint]),kl=i.useCallback(t=>typeof St=="boolean"?St:(St==null?void 0:St(t-d))??!0,[d,St]),Sl=i.useMemo(()=>{if(en===void 0||T.current===null)return null;const{bounds:t,group:r}=en,n=T.current.getBoundingClientRect();return q(Yi,{bounds:t,group:r,canvasBounds:n,onClose:()=>tn(void 0),onFinish:s=>{tn(void 0),$==null||$(r,s)}})},[$,en]),zl=Math.min(B.length,et+(_e?1:0));i.useImperativeHandle(o,()=>({appendRow:(t,r)=>Et(t+d,r),updateCells:t=>{var r;return d!==0&&(t=t.map(n=>({cell:[n.cell[0]+d,n.cell[1]]}))),(r=ke.current)==null?void 0:r.damage(t)},getBounds:(t,r)=>{var n;if(!((T==null?void 0:T.current)===null||(j==null?void 0:j.current)===null)){if(t===void 0&&r===void 0){const s=T.current.getBoundingClientRect(),c=s.width/j.current.clientWidth;return{x:s.x-j.current.scrollLeft*c,y:s.y-j.current.scrollTop*c,width:j.current.scrollWidth*c,height:j.current.scrollHeight*c}}return(n=ke.current)==null?void 0:n.getBounds((t??0)+d,r)}},focus:()=>{var t;return(t=ke.current)==null?void 0:t.focus()},emit:async t=>{switch(t){case"delete":Jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Qt(void 0,!0);break;case"paste":await sn();break}},scrollTo:ne,remeasureColumns:t=>{for(const r of t)Mo(r+d)}}),[Et,Mo,j,Qt,Jt,sn,d,ne]);const[Vn,_n]=Xe??[],Tl=i.useCallback(t=>{const[r,n]=t;if(n===-1){he!=="none"&&(ue(X.fromSingleSelection(r),void 0,!1),xe());return}Vn===r&&_n===n||(pe({cell:t,range:{x:r,y:n,width:1,height:1}},!0,!1,"keyboard-nav"),ne(r,n))},[he,xe,ne,Vn,_n,pe,ue]),[Ll,Hl]=i.useState(!1),Xn=i.useRef(ii(t=>{Hl(t)},5)),Dl=i.useCallback(()=>{Xn.current(!0),h.current===void 0&&h.columns.length===0&&h.rows.length===0&&k===void 0&&pe({cell:[d,Co],range:{x:d,y:Co,width:1,height:1}},!0,!1,"keyboard-select")},[Co,h,k,d,pe]),El=i.useCallback(()=>{Xn.current(!1)},[]),[Il,$l]=i.useMemo(()=>{let t;const r=(ge==null?void 0:ge.scrollbarWidthOverride)??ti(),n=F+(oe?1:0);if(typeof it=="number")t=Xt+n*it;else{let c=0;const g=Math.min(n,10);for(let a=0;a<g;a++)c+=it(a);c=Math.floor(c/g),t=Xt+n*c}t+=r;const s=B.reduce((c,g)=>g.width+c,0)+r;return[`${Math.min(1e5,s)}px`,`${Math.min(1e5,t)}px`]},[B,ge==null?void 0:ge.scrollbarWidthOverride,it,F,oe,Xt]),Fl=i.useMemo(()=>oi(ve),[ve]);return q(ni.Provider,{value:ve,children:to(nc,{style:Fl,className:Ot,inWidth:le??Il,inHeight:ce??$l,children:[q(Bi,{fillHandle:Mr,drawFocusRing:wn,experimental:ge,fixedShadowX:Rr,fixedShadowY:kr,getRowThemeOverride:ot,headerIcons:Sr,imageWindowLoader:zr,initialSize:Tr,isDraggable:Lr,onDragLeave:Hr,onRowMoved:Vt,overscrollX:Yr,overscrollY:jr,preventDiagonalScrolling:Ir,rightElement:$r,rightElementProps:Fr,smoothScrollX:Ar,smoothScrollY:Gr,className:Ot,enableGroups:qo,onCanvasFocused:Dl,onCanvasBlur:El,canvasRef:T,onContextMenu:yl,theme:ve,cellXOffset:il,cellYOffset:Co,accessibilityHeight:pt.height,onDragEnd:Cl,columns:B,nonGrowWidth:Hn,drawHeader:nl,onColumnProposeMove:Be,drawCell:rl,disabledRows:Rl,freezeColumns:zl,lockColumns:d,firstColAccessible:d===0,getCellContent:Le,minColumnWidth:zt,maxColumnWidth:go,searchInputRef:b,showSearch:Zr,onSearchClose:Jr,highlightRegions:cl,getCellsForSelection:fe,getGroupDetails:Jo,headerHeight:Yo,isFocused:Ll,groupHeaderHeight:qo?Sn:0,freezeTrailingRows:tt+(oe&&(U==null?void 0:U.sticky)===!0?1:0),hasAppendRow:oe,onColumnResize:Lt,onColumnResizeEnd:tl,onColumnResizeStart:ol,onCellFocused:Tl,onColumnMoved:vl,onDragStart:ml,onHeaderMenuClick:fl,onHeaderIndicatorClick:hl,onItemHovered:ln,isFilling:(k==null?void 0:k.fillHandle)===!0,onMouseMove:dl,onKeyDown:Jt,onKeyUp:Ko,onMouseDown:sl,onMouseUp:ul,onDragOverCell:yr,onDrop:xr,onSearchResultsChanged:Ml,onVisibleRegionChanged:gl,clientSize:jo,rowHeight:it,searchResults:Ze,searchValue:no,onSearchValueChange:ft,rows:me,scrollRef:j,selection:h,translateX:pt.tx,translateY:pt.ty,verticalBorder:kl,gridRef:ke,getCellRenderer:ye,resizeIndicator:Ur}),Sl,C!==void 0&&q(i.Suspense,{fallback:null,children:q(gc,{...C,validateCell:el,bloom:qe,id:bl,getCellRenderer:ye,className:(ge==null?void 0:ge.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:wr,imageEditorOverride:z,onFinishEditing:pl,markdownDivCreateNode:O,isOutsideClick:Wr})})]})})},wc=i.forwardRef(Cc),pc=(e,o)=>{const l=i.useMemo(()=>({...Gi,...e.headerIcons}),[e.headerIcons]),u=i.useMemo(()=>e.imageWindowLoader??new ri,[e.imageWindowLoader]);return q(wc,{...e,renderers:li,headerIcons:l,ref:o,imageWindowLoader:u})},Lc=i.forwardRef(pc);export{Vi as C,Lc as D,dt as k,dc as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./data-grid-overlay-editor-fA5c1p2o.js","./marked.esm-dbrxtycE.js","./index-BMVQvedj.js","./index-wocATsGp.js","./image-window-loader-nvLgsaxj.js","./throttle-7EuXLZa7.js","./_baseIteratee-WTHxv43n.js","./iframe-AiCMyApU.js","./image-window-loader-1jHxuE_X.css","./flatten-qRvRBp6y.js","./scrolling-data-grid-SWWsfOyf.js","./scrolling-data-grid-dE2iz8sf.css","./data-grid-overlay-editor-EbzU9_4i.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}